<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 2.0  (Win32)">
	<META NAME="AUTHOR" CONTENT="Станислав Дёгтев">
	<META NAME="CREATED" CONTENT="20041020;16022722">
	<META NAME="CHANGED" CONTENT="$Date$">
</HEAD>
<BODY LANG="ru-RU" DIR="LTR">
<P ALIGN=CENTER STYLE="margin-top: 0.42cm; page-break-after: avoid"><FONT FACE="Arial, sans-serif"><FONT SIZE=6 STYLE="font-size: 26pt"><B>Руководство
пользователя binkd</B></FONT></FONT></P>
<H1>0. Введение.</H1>
<H2>0.0. Об этом руководстве.</H2>
<P>Документ, который Вы читаете, предлагается как руководство по
использованию программы <FONT FACE="Courier New, monospace">binkd</FONT>.
Предполагается, что читатель хотя бы поверхностно знаком с понятиями
&laquo;FIDOnet&raquo;, &laquo;FIDOnet Technology Network&raquo;
(&laquo;FTN&raquo;), с системой адресации и структурой сети FIDOnet,
с почтовыми очередями, используемыми в FIDOnet, с понятиями &laquo;mailer&raquo;
(&laquo;мейлер&raquo;), &laquo;tosser&raquo; (&laquo;тоссер&raquo;),
&laquo;netmail tracker&raquo; (&laquo;трекер&raquo;), &laquo;File
Request&raquo; (&laquo;FREQ&raquo;), &laquo;FREQ processor&raquo;
(&laquo;FREQ-процессор&raquo;), &laquo;netmail&raquo;, &laquo;echomail&raquo;,
&laquo;outbound&raquo;, &laquo;domain&raquo;, &laquo;flavour&raquo;,
&laquo;DNS&raquo;, &laquo;Internet&raquo;, &laquo;protocol&raquo;
(&laquo;протокол&raquo;), &laquo;IP&raquo;, &laquo;TCP&raquo;,
&laquo;proxy&raquo; (&laquo;прокси&raquo;). Не помешает также
знакомство с семиуровневой моделью OSI. Наличие представлений о
перечисленном не является обязательным, но поможет в понимании
текста и, в итоге, поможет в поиске ошибок в настройке <FONT FACE="Courier New, monospace">binkd</FONT>.</P>
<P>При составлении этого документа использовались: страница <FONT FACE="Courier New, monospace">man
binkd</FONT>, комментарии к файлу конфигурации из дистрибутива <FONT FACE="Courier New, monospace">binkd</FONT>,
исходные тексты <FONT FACE="Courier New, monospace">binkd</FONT> и
руководство пользователя по <FONT FACE="Courier New, monospace">binkd</FONT>
версии 0.9.2, написанное Nick Soveiko (адрес email
<A HREF="mailto:nsoveiko@doe.carleton.ca">nsoveiko@doe.carleton.ca)</A>,
и опубликованное в Internet на странице
<A HREF="http://www.doe.carleton.ca/~nsoveiko/fido/binkd/man/">http://www.doe.carleton.ca/~nsoveiko/fido/binkd/man/</A>.
Использовалась также информация, полученная от других разработчиков
<FONT FACE="Courier New, monospace">binkd</FONT>.</P>
<P>Автор этого руководства: Стас Дёгтев (Stas Degteff
2:5080/102@FIDOnet, <A HREF="mailto:g@grumbler.org">g@grumbler.org</A>,
<A HREF="mailto:stas.grumbler@gmail.com">stas.grumbler@gmail.com</A>)
и другие участники сообщества разработки <FONT FACE="Courier New, monospace">binkd</FONT>.</P>
<P>Этот документ распространяется на условиях свободной лицензии GNU
для документации (<A HREF="http://www.gnu.org/licenses/licenses.html#FDL">Free
Documentation License, FDL)</A>.</P>
<H2>0.1. Что такое binkd.</H2>
<P>Бинкд (<FONT FACE="Courier New, monospace">binkd</FONT>) &ndash;
программа, разработанная для передачи почты и файлов (мейлер) по
технологии FTN в международной любительской сети FIDOnet. В отличие
от классических FTN-мейлеров, <FONT FACE="Courier New, monospace">binkd</FONT>
работает по специально разработанному для него протоколу <FONT FACE="Courier New, monospace">binkp</FONT>,
используя в качестве транспорта TCP/IP. Таким образом, <FONT FACE="Courier New, monospace">binkd</FONT>
позволяет передавать почту FIDOnet через Internet и по локальным
сетям.</P>
<P>В представленном документе описан <FONT FACE="Courier New, monospace">binkd</FONT> версии 1.0.0.</P>
<H2>0.2. Основные возможности binkd.</H2>
<UL>
	<LI><P>Binkd &ndash; открытое ПО: freeware, распространяется под
	лицензией GNU. Исходные тексты и оригинальная документация
	распространяются свободно наравне с готовыми исполяемыми файлами.</P>
	<LI><P>Binkd &ndash; переносимое ПО. Существуют версии для Windows
	(32-биных и 16-битных), для клонов UNIX, для OS/2, для DOS, для
	AmigaDOS. Разработчики приветствуют адаптацию binkd для разных
	операционных систем и аппаратных платформ.</P>
	<LI><P>Binkd использует очереди на отправку Binkley Style Outbound
	(BSO) либо Amiga Style Outbound (ASO). (И для
	настройки binkd желательно знание принципов организации этих видов
	почтовых очередей.)</P>
</UL>
<UL>
	<LI><P>Binkd по максимуму использует пропускную способность
	отведённого ему канала связи благодаря небольшому количеству
	служебных данных в протоколе binkp, чем выгодно отличается от
	мейлеров, использующих модемные протоколы для связи по IP.</P>
	<LI><P>Binkd предназначен для работы демоном в юниксоподобных
	операционных системах и сервисом в 32-х битных ОС семейства Windows.
	Поддерживается также однократная работа, например, с целью
	принять-передать почту на босса.</P>
	<LI><P>Binkd использует DNS для определения адреса IP удалённого
	узла, при этом может транслировать адрес FTN в доменное имя DNS.</P>
	<LI><P>Имеется возможность проверки соответствия адреса IP
	удалённого узла предъявленному им адресу FTN.</P>
	<LI><P>Соединения защищены паролем. Имеется возможность безопасной
	передачи пароля по открытым каналам связи с использованием хэшей MD5
	при условии поддержки этой возможности на удалённой стороне
	(включено по умолчанию).</P>
	<LI><P>Возможно шифрование всего трафика при условии поддержки этой
	возможности на удалённой стороне.</P>
	<LI><P>Возможна трансляция путей к файлам почтовой очереди. Эта
	возможность используется при совместной работе разных программ узла
	FTN на разных компьютерах с разными ОС, когда почтовая очередь
	размещается на сетевом диске.</P>
	<LI><P>Возможно использование файл-боксов стилей T-Mail и The
	Brake!.</P>
	<LI><P>Возможно использование персональных файл-боксов на отправку и
	приём почты и файлов для конкретного линка.</P>
	<LI><P>Binkd поддерживает файлы паролей стиля T-Mail, quico и ifmail
	(ifcico)</P>
	<LI><P>Binkd поддерживает запросы файлов (FREQ) стиля WAZOO. При
	этом вызывается внешняя программа для обработки запроса. Возможно
	использование программ, работающих по стандарту SRIF (например,
	Allfix, ViReq, tmafreq).</P>
	<LI><P>Binkd может соединяться с удалёнными узлами через прокси,
	работающие по стандартам HTTPS и Socks. При этом может
	использоваться парольная аутентификация на сервере прокси.</P>
	<LI><P>Возможен отказ от приёма файлов по маске имени файла.</P>
	<LI><P>Возможно создание файлов-флагов и запуска внешних программ по
	событию получения файла (по маске имени файла). Запуск программы
	осуществляется либо немедленно, либо по окончанию сеанса связи.</P>
</UL>
<H2>0.3. Источники получения binkd.</H2>
<P>Binkd разрабатывается под свободной лицензией GNU и
распространяется бесплатно, поэтому его дистрибутивы и исходные
тексты можно бесплатно скачать с официальных сайтов и каталогов FTP,
скачать c BBS, получить по файл-эхе FIDOnet либо взять из других
источников.</P>
<H3>0.3.1. Официальные источники по распространению binkd.</H3>
<P>В сети FIDOnet:</P>
<UL>
	<LI><P>Файл-эха &laquo;AFTNBINKD&raquo;</P>
</UL>
<P>В сети Internet:</P>
<UL>
	<LI><P><A HREF="ftp://cvs.happy.kiev.ua/pub/fidosoft/mailer/binkd/">ftp://cvs.happy.kiev.ua/pub/fidosoft/mailer/binkd/</A><BR>Основной
	FTP. Содержит релизы, снапшоты, исходные тексты, анализаторы логов и
	пр. Администрируется руководителем команды разработчиков Павлом
	Гульчуком (Pavel Gulchouck 2:<A HREF="mailto:463/68@FIDONET">463/68@FIDONET</A>,
	<A HREF="mailto:gul@gul.kiev.ua">gul@gul.kiev.ua</A>).</P>
	<LI><P><A HREF="ftp://fido.thunderdome.ws/pub/mirror/binkd/">ftp://fido.thunderdome.ws/pub/mirror/binkd/</A><BR>Зеркало
	основного FTP. Администрируется Matt Bedynek <A HREF="mailto:106/1@FIDONET">1:106/1@FIDONET</A></P>
	<LI><P><A HREF="ftp://fido.thunderdome.ws/pub/mirror/binkd/">ftp://ftp.alexblues.ru/pub/binkd/</A><BR>Зеркало
	основного FTP. Администрируется Александром Гладченко
	<A HREF="mailto:106/1@FIDONET">2:</A><A HREF="mailto:5080/111@FIDONET">5080/111@FIDONET</A></P>
	<LI><P><A HREF="ftp://fido.thunderdome.ws/pub/mirror/binkd/">ftp://cube.sut.ru/pub/mirror/binkd/</A><BR>Зеркало
	основного FTP. Администрируется Дмитрием Ермаковым
	<A HREF="mailto:106/1@FIDONET">2:</A><A HREF="mailto:5030/1115@FIDONET">5030/1115@FIDONET</A></P>
	<LI><P><A HREF="ftp://fido.thunderdome.ws/pub/mirror/binkd/">http://binkd.spb.ru</A><BR>Зеркало
	основного FTP. Администрируется Андреем Остановским
	<A HREF="mailto:106/1@FIDONET">2:5030/1957@FIDONET</A></P>
	<LI><P>Публичный CVS :pserver:binkd@cvs.happy.kiev.ua:/cvs , модуль
	binkd, пароль пустой, тэг binkd-0_9_5-stable.<BR>Исходные тексты и
	документация всех версий binkd. Администрируется Павлом Гульчуком.</P>
	<LI><P><A HREF="http://binkd.grumbler.org/">http://binkd.grumbler.org/</A><BR>Исполняемые
	файлы для Windows, страницы man, FAQ, документация по binkd и
	протоколу binkp. Администрируется одним из разработчиков Стасом
	Дёгтевым (Stas Degteff 2:5080/102 g@grumbler.org)</P>
</UL>
<H2>0.4. История создания binkd.</H2>
<P>С распространением Internet в России у фидошного сообщества
сформировалась идея использовать новый транспорт для передачи
трафика. Поначалу использовалось обычное ПО, разработанное для
модемных соединений, но это было крайне неэффективно и в некоторых
ситуациях сеанс связи FTN не устанавливался несмотря на нормальную
работу протоколов Internet. Binkd создавался Дмитрием Маловым в 1996
году как приложение для Internet с тем, чтобы максимально
использовать преимущества транспорта TCP/IP. В дальнейшем к
разработке подключились другие люди, а Малов в последние годы отошёл
от работы над binkd. Первые версии binkd разрабатывались для ОС
класса UNIX, в дальнейшем binkd был адаптирован для OS/2, затем для
Windows, MSDOS (PCDOS) и AmigaOS.</P>
<P>Название &laquo;binkd&raquo; было составлено из слов &laquo;Bink
Daemon&raquo;, или &laquo;Bink-style Daemon&raquo;. (Иногда его даже
пишут с первой и последней заглавными буквами, полностью копируя
части исходных слов: &laquo;BinkD&raquo;.) Таким образом, название в
некоторой мере описывает назначение программы: демон для работы с
bink style outbound. И именно поэтому binkd называют в мужском роде.</P>
<H1>1. Философия binkd.</H1>
<H2>1.1. Протокол.</H2>
<P>Дмитрий Малов разработал для binkd собственный протокол, исходя из
принципов скорости, простоты в реализации и расширяемости. Протокол
был назван его автором &laquo;binkp&raquo;: сокращение от слов
&laquo;binkd's protocol&raquo;.</P>
<P>Протокол binkp разработан в расчёте на использование поверх
протокола транспортного уровня, обеспечивающего целостность
передаваемых данных, такого как TCP. Базовый протокол binkp
использует минимальное количество служебной информации при передаче и
приеме данных (файлов), передача файлов производится без пауз
последовательно друг за другом, передача и приём на каждой стороне
производятся одновременно. Этим обеспечивается эффективное
использование полосы пропускания канала связи.</P>
<P>Расширения базового протокола устраняют ошибки, возникающие при
частых обрывах в канале связи (за счёт снижения эффективности),
обеспечивают безопасный обмен паролями по открытым линиям связи,
шифрование передаваемых данных, сжатие данных, запросы файлов,
выборочный приём файлов и другие возможности.</P>
<P>Протокол binkp версии 1.0 описан в документе FSP-1018, в других
документах FTSC описаны расширения и новые версии протокола.
(Подробнее см. на сайте <A HREF="http://www.ftsc.org/">FTSC</A> и на
сайте <A HREF="http://binkd.grumbler.org/">binkd</A>.) Общее описание
binkp включено в состав дистрибутива binkd.</P>
<H2>1.2. Разделение функциональности.</H2>
<P>В мире UNIX принят подход к проектированию приложений, при котором
для выполнения некоторой задачи создаётся и используется программа с
максимально узкой специализацией. Binkd создавался с учётом такого
подхода: это программа-демон, которая работает без непосредственного
вмешательства человека и выполняет узкую задачу по приёму и передаче
файлов между узлами сетей, построенных по технологии FTN (в
частности, FIDOnet). В отличие от случаев использования почтовых
программ, ориентированных на работу через модемы, в случае
использования binkd подготовка почты к отправке (фактически
превращение писем из почтовой базы в файлы &ndash; упаковка почты)
осуществляется отдельными программами: тоссерами (tosser) в случае
эхомейла и трекерами (netmail tracker) в случае нетмейла. подготовка
файлов к пересылке по файл-эхам осуществляется тоже
специализированными программами &ndash; файлэхопроцссорами. Более
того, обработка файловых запросов в binkd реализована только при
использовании специализированной программы FREQ-менеджера.</P>
<H2>1.3. Клиент и сервер.</H2>
<P>Binkd является приложением, предназначенным для работы в Internet
(точнее, для работы в сетях, построенных по технологии TCP/IP).
Каждое приложение Internet работает либо как сервер, принимающий
соединения, либо как клиент, осуществляющий соединение с серверным
приложением. В binkd эти две части соединены в одном приложении,
поскольку алгоритмы работы в этих вариантах различаются несколькими
деталями и основная часть кода при работе по протоколу binkp у
клиента и у сервера совпадает. Однако пользователь может настроить
binkd на работу только сервером либо только клиентом. Возможен также
однократный запуск binkd с включенной только одной функцией (сервера
либо клиента), при этом указываются специальные опции командной
строки. В терминологии binkd серверная часть функционала реализуется
сервер-менеджером (server manager), а клиентская &ndash;
клиент-менеджером (client manager).</P>
<P>Поскольку в сетях TCP/IP нет монопольных ресурсов, например, таких
как единственная телефонная линия в случае модемных коммутируемых
соединений, сервер может принимать, а клиент - осуществлять
одновременно множество соединений, независимых друг от друга. При
этом для каждого соединения binkd создаёт отдельный процесс (или
поток &ndash; в многопоточных операционных системах), и параллельная
работа binkd с разными удалёнными узлами обеспечивается средствами
операционной системы. Такой подход позволил не создавать собственный
менеджер процессов, что значительно упростило програмирование.
(Примечание. В однозадачных ОС, например, в MSDOS, binkd может
работать либо клиентом, либо сервером, причем параллельная работа с
разными линками исключается.)</P>
<P>Сервер-менеджер binkd принимает запрос на установление
TCP-соединения и запускает очередной экземпляр серверного процесса
(потока) либо закрывает соединение в случае, если число работающих
серверных процессов (потоков) уже достигло максимально разрешенного в
конфигурации binkd числа. В последнем случае сервер-менеджер
отправляет удалённому клиенту сообщение о своей занятости
(перегруженности).</P>
<P>Клиент-менеджер периодически просматривает почтовую очередь
(outbound) и при обнаружении файлов, предназначенных к отправке на
известный ему узел, на который разрешена отправка, запускает
очередной экземпляр клиентского процесса (потока). При этом, если
число работающих клиентских процессов (потоков) уже достигло
максимально разрешенного в конфигурации числа, сканирование очереди и
запуск новых клиентских процессов (потоков) не производится.</P>
<H2>1.4. Версии binkd.</H2>
<P>Первые версии <FONT FACE="Courier New, monospace">binkd</FONT>
нумеровались, начиная с нуля: 0.1, 0.2, ...0.9. Кроме того, после
небольших доработок (исправление ошибок, небольшие улучшения)
добавлялась и увеличивалась третья цифра: 0.9.1, 0.9.2, .... К
промежуточным выпускам, распространяемым для отладки, добавлялась
буква.</P>
<P>Начиная с версии 0.9.5 сделаны две ветки: стабильная, в которой
только исправлялись ошибки, и ветка активной разработки. Стабильная
ветка названа 0.9.5-stable и к ней относятся версии 0.9.6, 0.9.7,
0.9.8, 0.9.9, 0.9.10, 0.9.11, являющиеся исправленными релизами после 0.9.5.
Следующая ветка обозначена как 1.0. Долгое время она находилась в разработке, 
было добавлено много новых возможностей, таких, как поддержка IPv6, 
перечитывание конфига "на лету" (без перезапуска), поддержка перловых 
хуков и многое другое. Когда она стала стабильной, была создана ветка
binkd-1_0-stable, был выпущен релиз binkd 1.0.0, а в разработке находится
ветка 1.1.</P>
<P>Стабильная ветка отличается от ветки в разработке тем, что в стабильной 
не добавляются новые возможности, а лишь исправляются замеченные ошибки.
В случае обнаружения и исправления ошибок в стабильной ветке 1.0 будут 
выпущены исправленные версии 1.0.1, 1.0.2 и далее.</P>
<P>Для ветки, находящейся в разработке, версии нумеруются несколько иначе: 
1.1a-номер_исправления, например, binkd 1.1a-295. Когда ветка 1.1 станет 
стабильной, появится ветка binkd-1_1-stable и релиз binkd 1.1.0, а в разработке 
станет версия 1.2.</P>
<H2>1.5. Особенности binkd в разных ОС.</H2>
<P><FONT FACE="Courier New, monospace">Binkd</FONT> изначально
разрабатывался для операционных систем семйства UNIX, но в настоящее
время из одних и тех же исходных текстов компилируются версии также
для OS/2, Amiga, DOS, Windows 3.x, Windows 9x, Windows
NT/2000/XP/2003. При этом получается отдна и та же версия, но на
разных платформах, отличия между которыми минимальны и определяются
особенностями платформы и, иногда, компилятора.</P>
<P>Для OS/2 существует четыре варианта <FONT FACE="Courier New, monospace">binkd</FONT>:
скомпилированный компилятором Watcom C, два варианта,
скомпилированные EMX (GNU C) и вариант, скомпилированный ICC (IBM C
Compiler) В первом и четвёртом вариантах получается полный
исполняемый файл, во втором и третьем для работы <FONT FACE="Courier New, monospace">binkd</FONT>
требуется установленный в системе EMX run-time. Соответственно
скомпилированный Watcom исполняемый файл <FONT FACE="Courier New, monospace">binkd</FONT>
имеет больший размер и потребляет больше ресурсов. Кроме того, из-за
ошибок компиляторов в каждом варианте есть свои недостатки.
Исполняемый файл, собранный посредством Watcom C, имеет имя
<FONT FACE="Courier New, monospace">binkd2.exe</FONT>, собранный
посредством ICC &ndash; <FONT FACE="Courier New, monospace">binkd.exe</FONT>,
а собранный EMX &ndash; <FONT FACE="Courier New, monospace">binkd2eo.exe</FONT>
либо <FONT FACE="Courier New, monospace">binkd2e.exe</FONT> в
зависимости от того, собран он с в режиме OMF или нет.</P>
<P>В DOS <FONT FACE="Courier New, monospace">binkd</FONT> может
работать только в среде IBM TCP/IP for PC-DOS, поэтому требуется
разыскать и установить этот пакет поддержки сети. Источники IBM
TCP/IP for PC-DOS указаны в Binkd FAQ.</P>
<P>Для 32-битных версий Windows существует несколько вариантов
компиляции исполняемого файла binkd: варианты, работающие сервисами
только в линейке Windows NT (это NT, 2000, XP, 2003) и варианты,
работающие сервисами только в линейке Windows 95 (это 95, 98, Me).
Другое деление &ndash; варианты, собранные в полный исполняемый файл
(со всеми библиотеками, &laquo;статическая&raquo; сборка) и в
исполняемый файл, который использует DLL (в первую очередь,
<FONT FACE="Courier New, monospace">msvcrt.dll</FONT>). Кроме того,
собрать <FONT FACE="Courier New, monospace">binkd</FONT> для Windows
можно двумя компиляторами: Microsoft Visual C из пакета Visual Studio
и GNU C из пакета MinGW32 или Cygwin. Для работы <FONT FACE="Courier New, monospace">binkd</FONT>,
скомпилированного MinGW32, всегда необходима библиотека msvcrt.dll
(MS Visual C run-time DLL), а для статически собранного с помощью
Microsoft Visual C она не требуется. (Хотя особого смысла собирать
статическую win32-версию <FONT FACE="Courier New, monospace">binkd</FONT>
нет, поскольку очень многие программы используют библиотеку
msvcrt.dll.)</P>
<P>Варинат <FONT FACE="Courier New, monospace">binkd</FONT>,
работающий сервисом в Windows 95 (98, Me) отличается от других тем,
что не имеет текстовой консоли и ничего не выводит на экран во время
работы. Остановить его вручную можно только завершив процесс из
менеджера задач Windows. Он называется bink/w9x и исполняемый файл
имеет имя <FONT FACE="Courier New, monospace">binkdw9x.exe</FONT>.
Обычный консольный <FONT FACE="Courier New, monospace">binkd/w32</FONT>
не способен работать сервисом в Windows 95 из-за особенностей
реализации консоли win32 в этой ОС.</P>
<P>Для 16-битных версий Windows (Windows 3.1, Windows 3.11) <FONT FACE="Courier New, monospace">binkd</FONT>
может работать только клиентом либо только сервером. Поэтому, чтобы и
осуществлять вызовы, и принимать соединения, необходимо запускать две
копии <FONT FACE="Courier New, monospace">binkd/w16</FONT> с разными
параметрами.</P>
<H1>2. Установка binkd.</H1>
<H2>2.1. Установка скомпилированного пакета из дистрибутива.</H2>
<P>Если вы являетесь обычным пользователем (особенно это актуально в
операционных системах с закрытым исходным кодом), Вам проще взять
готовый (скомпилированный) пакет, развернуть его в своей системе и
выполнить настройку.</P>
<H3>2.1.1. Комплектация дистрибутивного пакета.</H3>
<P>Дистрибутивные пакеты <FONT FACE="Courier New, monospace">binkd</FONT>,
подготовленные разработчиками, содержат (в скобках указано имя
файла/ов):</P>
<UL>
	<LI><P>исполняемый файл (binkd, binkd.exe, binkd2.exe или другой);</P>
	<LI><P>пример файла конфигурации со всеми возможными директивами
	конфигурации (binkd.cfg);</P>
	<LI><P>краткая инструкция по установке binkd со ссылками на
	документацию (!README);</P>
	<LI><P>Binkd FAQ &ndash; ответы на часто задаваемые вопросы о binkd
	(русский binkdfaq.txt.ru и перевод на английский binkdfaq.txt.en);</P>
	<LI><P>страница man binkd (binkd.8 &ndash; только для ОС семейства
	UNIX и binkd.txt &ndash; для остальных ОС);</P>
	<LI><P>описание варианта binkd для работы сервисом в ОС Windows 9x
	(binkd9x.txt);</P>
	<LI><P>описание работы binkd в &laquo;режиме без дупов&raquo; (No
	Dupes Mode, ND mode), другими словами &ndash; описание расширения ND
	mode протокола binkp применительно к binkd (readme.ND);</P>
	<LI><P>описание механизма файловых запросов SRIF - Standard Request
	Information File (!SRIF.TXT);</P>
	<LI><P>список изменений между версиями (!README.FIX);</P>
	<LI><P>список изменений в файлах исходных текстов (HISTORY);</P>
	<LI><P>список планируемых изменений (todo.lst);</P>
	<LI><P>лицензия (COPYING);</P>
	<LI><P>в диcтрибутивах для Windows, OS/2, DOS: файл с кратким
	описанием содержимого архива (File-Id.Diz).</P>
</UL>
<P>В последующем состав пакетов может быть изменён.</P>
<H3>2.1.2. Последовательность действий для ОС семейства UNIX.</H3>
<OL>
	<LI><P>Возьмите архив дистрибутива с последней версией binkd ветки
	binkd-1_0-stable из одного из официальных источников (либо из источника,
	которому Вы доверяете). Для разных ОС и дистрибутивов ОС он будет
	отличаться, например, для Red Hat Linux это пакет RPM, для Debian
	Linux &ndash; пакет DEB.</P>
	<LI><P>Выполните установку (распаковку) пакета в соответствии с
	документацией на ОС.</P>
	<LI><P>Найдите пример файла конфигурации: binkd.conf-dist. (Обычно
	он помещается в каталог /usr/local/etc.)</P>
	<LI><P>Скопируйте binkd.conf-dist в binkd.conf, отредактируйте
	binkd.conf в соответствии с параметрами Вашей FTN-станции и желаемой
	функциональностью binkd. Подробно настройка binkd описана в главе 3.</P>
	<LI><P>Проверьте правильность конфигурации, для чего укажите в файле
	конфигурации первой строкой слово debugcfg и запустите binkd, указав
	в командной строке параметр &ndash; имя файла конфигурации:<BR><FONT FACE="Courier New, monospace">binkd
	binkd.conf<BR></FONT><FONT FACE="Times New Roman, serif">либо
	запустите binkd, указав в командной строке опцию -vvv и параметр &ndash;
	имя файла конфигурации:<BR></FONT><FONT FACE="Courier New, monospace">binkd
	-vvv binkd.conf<BR></FONT><FONT FACE="Times New Roman, serif">(В
	последующих версиях binkd дамп конфигурации сделан иначе.)</FONT></P>
	<LI><P>Если конфигурация неверна, binkd выведет диагностическое
	сообщение об ошибке и завершит работу. В этом случае придётся
	исправить ошибки. В случае правильной конфигурации binkd будет
	пытаться осуществить вызов, либо будет ждать соединения, либо
	завершится по прошествии времени, указанного в директиве
	rescan-delay файла конфигурации. Принудительно завершить работу
	binkd можно нажатием сочетания клавиш Ctrl-C.</P>
	<LI><P>Если Вы хотите, чтобы binkd работал демоном и запускался при
	старте ОС, вставьте следующую строку вызова binkd в стартовый скрипт
	ОС согласно документации на вашу ОС:<BR><FONT FACE="Courier New, monospace">binkd
	-Dq binkd.conf</FONT></P>
</OL>
<H3>2.1.3. Последовательность действий для других ОС (Windows разных
версий, OS/2, DOS и пр.).</H3>
<OL>
	<LI><P>Возьмите выбранный Вами архив дистрибутива с последней
	версией binkd ветки binkd-1_0-stable для вашей ОС из одного из
	официальных источников (либо из источника, которому Вы
	доверяете).<BR>Для Windows существует две версии binkd:
	универсальная консольная версия (binkd/w32) и специализированная для
	работы сервисом в ОС Windows 95/98/Me (binkd/w9x). Отличие последней
	в том, что работает она без всякого вывода информации на экран и
	прервать её работу можно, только завершив процесс binkdw9x.
	Консольная же версия создаёт текстовое окно консоли win32 и в это
	окно выводятся сообщения протокола работы (если при запуске binkd не
	указана опция -q). <BR>Для OS/2 существует два варианта исполняемых
	файлов binkd: собранный компилятором Watcom C и собранный
	компилятором EMX (GNU C). Вариант, собранный Watcom C, не требует
	дополнительных программ (название архива и исполняемого файла
	начинается с &laquo;binkd2&raquo;). Вариант, собранный EMX, для
	работы требует установленного пакета EMX run-time версии не ниже
	0.9c. Его можно скачать с сервера Hobbes
	(<A HREF="ftp://hobbes.nmsu.edu/pub/os2/unix/emx09c/">ftp://hobbes.nmsu.edu/pub/os2/unix/emx09c/</A>),
	с CDROM.COM ( <A HREF="ftp://ftp.cdrom.com/pub/hobbes/emx09c/">ftp://ftp.cdrom.com/pub/hobbes/emx09c/)</A>
	и из других источников.</P>
	<LI><P>Создайте каталог, в котором будет располагаться binkd,
	например, C:\ftn\binkd</P>
	<LI><P>Распакуйте архив в приготовленный каталог.</P>
	<LI><P>Отредактируйте конфигурационный файл binkd.cfg в соответствии
	с параметрами Вашей FTN-станции и желаемой функциональностью binkd.</P>
	<LI><P>Проверьте правильность конфигурации, для чего укажите в файле
	конфигурации первой строкой слово debugcfg и запустите binkd, указав
	в командной строке параметр &ndash; имя файла конфигурации:<BR><FONT FACE="Courier New, monospace">binkd
	binkd.cfg<BR></FONT><FONT FACE="Times New Roman, serif">либо
	запустите binkd, указав в командной строке опцию -vvv и параметр &ndash;
	имя файла конфигурации:<BR></FONT><FONT FACE="Courier New, monospace">binkd
	-vvv binkd.cfg<FONT FACE="Courier New, monospace"><BR></FONT></FONT><FONT FACE="Times New Roman, serif">(В
	последующих версиях binkd дамп конфигурации сделан иначе.)</FONT></P>
	<LI><P>Если конфигурация неверна, binkd выведет диагностическое
	сообщение об ошибке и завершит работу. В этом случае придётся
	исправить ошибки. В случае правильной конфигурации binkd будет
	пытаться осуществить вызов, либо будет ждать соединения, либо
	завершится по прошествии времени, указанного в директиве
	rescan-delay файла конфигурации. Принудительно завершить работу
	binkd можно нажатием сочетания клавиш Ctrl-C.</P>
	<LI><P>(Только для 32-битных версий Windows) В случае, если Вы
	хотите, чтобы binkd работал сервисом, выполните установку сервиса
	одной из команд:<BR><FONT FACE="Courier New, monospace">binkd -i
	binkd.cfg<BR><FONT FACE="Courier New, monospace">binkd -i -S
	binkd-service binkd.cfg</FONT><BR></FONT><FONT FACE="Times New Roman, serif">где
	binkd-service &ndash; имя сервиса, которое Вы можете указать (по
	умолчанию используется &laquo;binkd-service&raquo;).<BR>В случае
	Windows NT (Windows 2000, Windows XP, Windows Server 2003) нужно
	использовать вариант binkd/w32, а в случае Windows 95 (Windows 98,
	Windows Me) &ndash; binkd/w9x. Если Вы попробуете установить
	сервисом неподходящий вариант binkd, результат достигнут не будет. В
	случае успешной установки сервисом binkd он будет сразу запущен (при
	условии достаточных прав пользователя у Вашей учетной записи в ОС).</FONT></P>
</OL>
<H2>2.2. Компиляция и установка binkd из исходных текстов.</H2>
<P>Для компиляции исходных текстов Вам понадобится комплект
компилятора и линковщика (часто поставляется в едином пакете). В
операционных системах семейства UNIX (основанных на UNIX, совместимых
с UNIX, подобных UNIX), вам понадобится компилятор GNU C версии 2.94
либо 3.2. В 32-битных операционных системах Windows понадобится либо
Microsoft Visual C (Visual Studio), либо MinGW32 (GNU C для Win32,
отдельным пакетом либо в комплекте с cygwin). Для OS/2 понадобится
либо Watcom C версии 10.0 или 11.0, либо пакет EMX 0.9c (GNU C для
OS/2), либо IBM C Compiler (ICC). Для MSDOS (PCDOS) понадобится
Microsoft C 6.0 и пакет IBM TCP/IP for DOS. Для платформы Amiga
понадобится Amiga Development Environment.</P>
<P>В большинстве платформ можно собрать разные варианты <FONT FACE="Courier New, monospace">binkd</FONT>:
с минимумом возможностей (это вариант по умолчанию), с расширенным
(отладочным) выводом, с поддержкой сервисов Windows 9x (в версии для
Windows). Вариант компиляции задают параметры командной строки
команды make (nmake, wmake, ...), они перечислены в начале файла с
програмой сборки (файл с именем Makefile). Расшифровка:</P>
<UL>
	<LI><P>DEBUG &ndash; дополнительный отладочный вывод;</P>
	<LI><P>DEBUGCHILD &ndash; собрать отладочный вариант, который
	работает в одном процессе;</P>
	<LI><P>STATIC &ndash; сборка с библиотеками, включенными в
	исполняемый файл (при работе не нужны динамически подгружаемые
	библиотеки), имеет смысл только для ОС семейства UNIX и для OS/2;</P>
	<LI><P>BINKD9X &ndash; версия для работы сервисом в Windows
	95/98/Me;</P>
	<LI><P>BW_LIM &ndash; поддержка ограничения скорости обмена;</P>
	<LI><P>PERL &ndash; версия со встроенным perl;</P>
	<LI><P>PERLDL &ndash; версия со встроенным perl, требующая
	DLL интерпретатора Perl (perl*.dll);</P>
	<LI><P>PERL_BASE=путь &ndash; путь к файлам интерпретатора Perl,
	например, PERL_BASE=/usr/local/lib/perl</P>
	<LI><P>ZLIB &ndash; версия с поддержкой сжатия потока данных
	методом gzip (с помощью библиотеки zlib)</P>
	<LI><P>ZLIBDL &ndash; версия с поддержкой сжатия потока данных
	методом gzip, требующая динамическую библиотеку zlib.dll</P>
	<LI><P>BZLIB2 &ndash; версия с поддержкой сжатия потока данных
	методом bzip2 (с помощью библиотеки bz2lib)</P>
	<LI><P>BZLIB2DL &ndash; версия с поддержкой сжатия потока данных
	методом bzip2, требующая динамическую библиотеку bz2lib.dll</P>
</UL>
<P>Настройка <FONT FACE="Courier New, monospace">binkd</FONT> при
установке самостоятельно скомпилированного <FONT FACE="Courier New, monospace">binkd</FONT>
проводится так же, как и при установке из готового дистрибутива.</P>
<H3>2.2.1. Компиляция и установка binkd в ОС семейства UNIX.</H3>
<P>Распакуйте архив, содержащий исходные тексты binkd в некоторый
каталог по Вашему выбору. Распаковывать нужно с сохранением всего
дерева подкаталогов. Затем выполните следующую последовательность
команд ($ - приглашение командного процессора ОС, за ним через пробел
указана команда, которую нужно ввести, в скобках описаны действия
скрипта и сделаны поясления):</P>
<P>$ cp mkfls/unix/* ./<BR>$ sh configure --help<BR>(Скрипт configure
выведет информацию о доступных опциях сборки, выберите нужные Вам и
используйте как параметры в следующей команде. Например, поддержка
прокси, поддержка NTLM аутентификации на прокси и поддержка ASO по
умолчанию выключены)<BR>$ sh configure &ndash;witn-aso &ndash;with-https
--with-ntlm<BR>(скрипт configure будет выводить информацию о
множестве проверок)<BR>$ make depend<BR>(Будет проведено отслеживание
зависимостей.)<BR>$ make<BR>(Будет проведена компиляция.)<BR>$ make
install<BR>(Будет выполнена установка программы, файла конфигурации и
страницы man.)<BR>$ make clean<BR>(Будет выполнено удаление
промежуточных файлов.)</P>
<P>Если распакованные исходные тексты Вам более не нужны, Вы можете
удалить каталог с ними.</P>
<H3>2.2.2. Компиляция и установка binkd в 32-битных версиях Windows.</H3>
<P>В Windows 95/98/Me либо в Windows NT/2000/XP/2003 лучшие
результаты даёт компилятор Microsoft Visual C, желательно последней
версии. Разработчики использовали для сборки binkd компиляторы MS
Visual C версий 6 и 7 (из состава пакетов Visual Studio 6.0 и Visual
Studio .NET). Сборка binkd выполняется командой <FONT FACE="Courier New, monospace">nmake</FONT>.
В строке запуска можно использовать несколько параметров, они описаны
в начале файла <FONT FACE="Courier New, monospace">Makefile</FONT>
(располагается в подкаталоге <FONT FACE="Courier New, monospace">mkfls\nt95-msvc</FONT>
в дереве каталогов с исходными текстами).</P>
<P>Другой вариант &ndash; использовать пакет MinGW32, представляющий
собой компилятор GNU C, портированый для платформы Win32. Он может
быть отдельным пакетом либо в составе пакета Cygwin. В случае
использования MinGW32 сборка binkd осуществляется командой <FONT FACE="Courier New, monospace">make</FONT>
и использует файл <FONT FACE="Courier New, monospace">Makefile</FONT>,
расположенный в подкаталоге <FONT FACE="Courier New, monospace">mkfls\nt95-mingw</FONT>.
В строке запуска <FONT FACE="Courier New, monospace">make</FONT>
можно использовать несколько параметров, они описаны в начале файла
<FONT FACE="Courier New, monospace">Makefile</FONT>. Также в среде
Cygwin можно использовать ту же последовательность действий, что и
для ОС семейства UNIX, но полученный таким образом исполняемый файл
будет работать медленнее и ему потребуется динамически подгружаемая
библиотека cygwin1.dll.</P>
<P>В случае компиляции DLL-варианта со встроенным Perl, учтите, какая
версия и какой вариант perl используется компилятором и какой
установлен в системе. То же самое относится и к библиотекам
компрессии.</P>
<P>Распакуйте архив, содержащий исходные тексты binkd в некоторый
каталог по Вашему выбору. Распаковывать нужно с сохранением всего
дерева подкаталогов. Затем скопируйте <SPAN STYLE="text-decoration: none">в
этот каталог все файлы из</SPAN> подкаталога, соответствующего
выбранному Вами компилятору: <FONT FACE="Courier New, monospace">mkfls\nt95-msvc</FONT>
в случае MS Visual C и <FONT FACE="Courier New, monospace">mkfls\nt95-mingw</FONT>
в случае MinGW32. Затем запустите команду компиляции: <FONT FACE="Courier New, monospace">nmake</FONT>
в случае MS Visual C и <FONT FACE="Courier New, monospace">make</FONT>
в случае MinGW32.</P>
<P>Примеры компиляции с использованием MS Visual C:</P>
<P><FONT FACE="Courier New, monospace">nmake<BR>nmake DLLRTL=1<BR>nmake
BINKD9X=1<BR>nmake DLLRTL=1 BINKD9X=1</FONT></P>
<P>Примеры компиляции с использованием MinGW32:</P>
<P><FONT FACE="Courier New, monospace">make<BR>make DEBUG=1<BR>make
BINKD9X=1</FONT></P>
<P>После успешной сборки с помощью Ms Visual C в зависимости от
использованных опций компиляции Вы получите каталог Release,
Release-w9x, Release-dll либо Release-w9x-dll с помещённым в него
исполняемым файлом (binkd.exe, binkd9x.exe, binkd-dll.exe либо
binkd9x-dll.exe).
</P>
<P>После успешной сборки с помощью MinGW32 исполняемый файл будет
располагаться в каталоге с исходными текстами.</P>
<P>Скопируйте в каталог, предназначенный для рабочей копии binkd,
получившийся исполняемый файл и следующие файлы из базового каталога
с исходными текстами binkd: файл конфигурации binkd.cfg и файлы
документации binkd-faq.txt.ru (или binkd-faq.txt.en) и все остальные
файлы, имена которых подходят под маски *.txt и *.htm. Для работы
binkd необходимы только исполняемый файл и файл конфигурации, но
документацию иметь под рукой не повредит.</P>
<H3>2.2.3. Компиляция и установка binkd в OS/2.</H3>
<P>В OS/2 лучшие результаты даёт компилятор ICC (IBM C Compiler),
хотя он появился не так давно и результат его работы тестировался
мало. Как и ICC, Watcom C даёт единый исполняемый файл, и
скомпилированный им binkd тщательно оттестирован. Binkd, собранный
EMX, наиболее близок к версии для UNIX (EMX-версия является
многопроцессной, тогда как остальные - многопоточными), но он и
потребляет больше ресурсов.</P>
<P>При компиляции учтите, какая версия драйвера стека TCP/IP
установлена в системе и какая будет использована при компиляции (DLL
могут отличаться). Также, в случае компиляции со встроенным Perl и с
компрессией данных, учтите, какая версия и какой вариант perl
используется. И, в случае компиляции с помощью EMX, убедитесь в
совместимости библиотек компилятора и установленных в системе. Лучше
всего использовать одни и те же библиотеки при сборке и во время
работы binkd.</P>
<P>Распакуйте архив, содержащий исходные тексты binkd, в некоторый
каталог по Вашему выбору. Распаковывать нужно с сохранением всего
дерева подкаталогов. Затем скопируйте <SPAN STYLE="text-decoration: none">в
этот каталог все файлы из</SPAN> подкаталога, соответствующего
выбранному Вами компилятору: mkfls\os2-wc в случае использования
Watcom C, mkfls\os2-emx в случае использования EMX, mkfls\os2-icc в
случае использования ICC. Затем запустите команду компиляции: wmake в
случае Watcom C, make или make -f Makefile.emo в случае EMX. В начале
используемого Makefile перечислены возможные параметры запуска,
задающие разные варианты компиляции.</P>
<P>После успешной сборки в зависимости от использованного компилятора
и Makefile Вы получите файл binkd.exe, binkd2.exe, binkd2e.exe либо
binkd2eo.exe.</P>
<P>Скопируйте в каталог, предназначенный для рабочей копии binkd,
получившийся исполняемый файл и следующие файлы из базового каталога
с исходными текстами binkd: файл конфигурации binkd.cfg и файлы
документации binkd-faq.txt.ru (или binkd-faq.txt.en) и все остальные
файлы, имена которых подходят под маски *.txt и *.htm. Для работы
binkd необходимы только исполняемый файл и файл конфигурации, но
документацию иметь под рукой не повредит.</P>
<H3>2.2.4. Компиляция и установка binkd в DOS.</H3>
<P>Сборка binkd в DOS возможна (во всяком случае пока) только
компилятором Microsoft C 6.0 при наличии пакета IBM TCP/IP for DOS.</P>
<P>Распакуйте архив, содержащий исходные тексты binkd, в некоторый
каталог по Вашему выбору. Распаковывать нужно с сохранением всего
дерева подкаталогов. Затем скопируйте <SPAN STYLE="text-decoration: none">в
этот каталог все файлы из</SPAN> подкаталога mkfls\dos-msc6 и
запустите make.</P>
<P>После успешной сборки Вы получите файл binkd.exe.</P>
<P>Скопируйте в каталог, предназначенный для рабочей копии binkd,
получившийся исполняемый файл и следующие файлы из базового каталога
с исходными текстами binkd: файл конфигурации binkd.cfg и файлы
документации binkd-faq.txt.ru (или binkd-faq.txt.en) и все остальные
файлы, имена которых подходят под маски *.txt и *.htm. Для работы
binkd необходимы только исполняемый файл и файл конфигурации, но
документацию иметь под рукой не повредит.</P>
<H3>2.2.5. Компиляция и установка binkd для Amiga.</H3>
<P>Сборка binkd на платформе Amiga возможна с использованием ADE
(Amiga Development Environment) при наличии библиотеки ixemul версии
не ниже 0.47 (см. файл README в подкаталоге mkfls\amiga в каталоге с
исходными текстами binkd).</P>
<P>Распакуйте архив, содержащий исходные тексты binkd, в некоторый
каталог по Вашему выбору. Распаковывать нужно с сохранением всего
дерева подкаталогов. Затем скопируйте <SPAN STYLE="text-decoration: none">в
этот каталог все файлы из</SPAN> подкаталога mkfls\amiga и запустите
make.</P>
<P>После успешной сборки Вы получите файл binkd.</P>
<P>Скопируйте в каталог, предназначенный для рабочей копии binkd,
получившийся исполняемый файл и следующие файлы из базового каталога
с исходными текстами binkd: файл конфигурации binkd.cfg и файлы
документации binkd-faq.txt.ru (или binkd-faq.txt.en) и все остальные
файлы, имена которых подходят под маски *.txt и *.htm. Для работы
binkd необходимы только исполняемый файл и файл конфигурации, но
документацию иметь под рукой не повредит.</P>
<H1>3. Первичная настройка binkd.</H1>
<P>В этой главе описана простейшая настройка binkd. Другими словами:
выполнив описанные в этой главе действия, вы получите работоспособный
мейлер, но без полной адаптации к Вашим условиям. Чтобы выполнить
тонкую настройку, надо изучить главу о файле конфигурации и главы о
работе binkd.</P>
<P>Для настройки binkd вам понадобится любой текстовый редактор,
предназначенный для редактирования простых текстовых файлов (т.е. без
оформления шрифтами, цветом и пр.). В Windows удобен встроенный
редактор файлового менеджера FAR, хотя можно использовать и
поставляющийся с ОС редактор Блокнот (Notepad). В OS/2 можно
использовать E или EE, в MS-DOS &ndash; Edit, edlin или встроенный
редактор Norton Commander, в юниксоподобных ОС &ndash; vi, ed, ee.
Кроме перечисленных, подойдёт любой текстовый редактор, не
вставляющий коды форматирования в текст.</P>
<P>Процесс настройки binkd заключается в редактировании файла
конфигурации (binkd.cfg либо названного по Вашему выбору) и в
создании описанных в файле конфигурации каталогов. Во время
редактирования файла конфигурации смотрите на приведённые в нём
примеры и комментарии (текст, помещённый справа от знака решётки
&laquo;#&raquo;).</P>
<P>Все знаки &laquo;\&raquo; в файле конфигурации должны
дублироваться, поскольку этот символ является символом искейпинга
(подстановки спецсимволов).</P>
<P>Сделайте резервную копию файла конфигурации перед внесением
изменений, чтобы не потерять исходный файл. Затем откройте файл
конфигурации в выбранном Вами редакторе.</P>
<H2>3.1. Обязательные параметры настройки.</H2>
<P>В этом разделе описана настройка минимально необходимых директив
файла конфигурации binkd, без которых он не будет работать.</P>
<H3>3.1.1. Адреса и общая информация.</H3>
<P>Отредактируйте строку address - укажите свой адрес в сети FIDOnet
или в другой FTN-сети. Адрес нужно указывать в формате 5D, т.е. в
виде зона:сеть/узел.пойнт@домен. Если адресов несколько &ndash;
укажите их все, разделяя соседние пробелом.</P>
<P>Также замените информацию в строке &laquo;sysop&raquo; на Ваши
личные данные, как они представлены в сети, укажите в строке
&laquo;location&raquo; информацию о расположении и в строке &laquo;sysname&raquo;
название FTN-системы (FTN-станции). В строке &laquo;nodeinfo&raquo;
укажите скорость канала, либо полосу пропускания, отведённую binkd и,
после запятой, флаги, описывающие параметры станции, разделяя их
запятыми.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">address 2:5047/999@fidonet
2:5020/999.1@fidonet<BR>sysop &quot;Ivan Ivanov&quot;<BR>sysname
&quot;Ivan's BBS&quot;<BR>location &quot;Magadan, Russia&quot;<BR>nodeinfo
115200,TCP,BINKP</FONT></P>
<H3>3.1.2. Каталоги и файлы.</H3>
<P>Укажите в строке &laquo;domain&raquo; использующийся в Вашей сети
домен FTN (для сети FIDOnet укажите слово fidonet), через пробел
укажите путь к каталогу почтовой очереди для зоны Вашего адреса и
затем через пробел &ndash; номер этой зоны. Используемые в качестве
разделителей каталогов обратные слэши &laquo;\&raquo; необходимо
дублировать. (В ОС семейства unix разделители каталогов - прямые слэши
и их дублировать не нужно.)</P>
<P>Укажите в строке &laquo;inbound&raquo; путь к каталогу, в который
будут помещаться файлы, принятые во время сеансов связи, защищенных
паролем. Этот каталог должен совпадать с каталогом, используемым
программами распаковки почты и файлов (tosser, netmail tracker,
fileechoprocessor, FREQ manager и др.)</P>
<P>Укажите в строке &laquo;inbound-nonsecure&raquo; путь к каталогу,
в который будут помещаться файлы, принятые во время сеансов связи, не
защищенных паролем. Он также должен совпадать с аналогичным для
других программ.</P>
<P>Укажите в строке &laquo;log&raquo; путь к файлу, в который будет
записываться протокол работы binkd.
</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">domain fidonet
c:\\bbs\\outbound 2<BR>log c:\\bbs\\log\\binkd.log<BR>inbound
c:\\bbs\\inbound<BR>inbound-nonsecure c:\\bbs\\inbound\\unknown</FONT></P>
<H3>3.1.3. Линки.</H3>
<P>В строках &laquo;node&raquo; опишите FTN-системы, с которыми будет
соединяться Ваш binkd (то есть линки Вашей FTN-системы). В простейшем
случае нужно указать три параметра: адрес удалённой системы, её адрес
IP либо доменное имя, пароль. Если же адрес удалённой системы описан
в DNS в домене fidonet.net, вместо адреса IP можно указать знак
&laquo;звёздочка&raquo; (&laquo;*&raquo;). Вы также можете описать
FTN-системы, связь с которыми будет осуществляться по их инициативе.
Для этого вместо адреса удалённой системы укажите знак &laquo;минус&raquo;
(&laquo;-&raquo;), и binkd не будет пытаться соединиться с таким
линком.</P>
<P>Примеры:</P>
<P><FONT FACE="Courier New, monospace">node 2:5047/996@fidonet
123.45.67.89 password996<BR>node 2:5047/997@fidonet hostname997
password997<BR>node 2:5047/998@fidonet * password998<BR>node
2:5047/999.2@fidonet &ndash; password999.2</FONT></P>
<H2>3.2. Необязательные параметры настройки.</H2>
<P>Ниже перечислены директивы файла конфигурации, заданные
разработчиками (в том виде, в котором они присутствуют в примере
файла конфигурации из дистрибутива), но которые можно просто
закомментировать (т.е. вставить в первую позицию знак &laquo;решётка&raquo;
- &laquo;#&raquo;):</P>
<P><FONT FACE="Courier New, monospace">temp-inbound
c:\\bbs\\inbound\\incomplete<BR>filebox
d:\\fido\\tmail\\boxes<BR>brakebox d:\\fido\\brake\\boxes</FONT></P>
<P>Все остальные директивы файла конфигурации можно оставить без
изменений.</P>
<H2>3.3. Проверка конфигурации.</H2>
<P>Чтобы проверить, правильно ли указаны пути и все ли необходимые
параметры заданы, запустите <FONT FACE="Courier New, monospace">binkd</FONT>
с указанием имени файла конфигурации в качестве параметра в строке
запуска:</P>
<P><FONT FACE="Courier New, monospace">binkd binkd.cfg</FONT></P>
<P>Если <FONT FACE="Courier New, monospace">binkd</FONT> будет
работать (а не завершится с диагностическим сообщением) &ndash; всё
необходимые параметры заданы.</P>
<P>Второй этап проверки заключается в анализе дампа конфигурации,
который выводит <FONT FACE="Courier New, monospace">binkd</FONT> при
указании в командной строке опции &laquo;<FONT FACE="Courier New, monospace">-vvv</FONT>&raquo;:</P>
<P><FONT FACE="Courier New, monospace">binkd -vvv binkd.cfg</FONT></P>
<P>либо при добавлении в начало файла конфигурации директивы
&laquo;<FONT FACE="Courier New, monospace">debugcfg</FONT>&raquo; и
обычным запуском <FONT FACE="Courier New, monospace">binkd</FONT>.</P>
<P>(Описаны способы получения дампа конфигурации для версий 0.9.5 и
более поздних 0.9.x. В последующих версиях binkd 1.x дамп
конфигурации выводится другим способом.)</P>
<P>Завершить работу <FONT FACE="Courier New, monospace">binkd</FONT>
можно нажатием на клавиатуре сочетания клавиш Ctrl-C.</P>
<H1>4. Директивы файла конфигурации.</H1>
<P>Файл конфигурации состоит из директив, комментариев и пустых
строк. Пустые строки используются для форматирования текста и
игнорируются <FONT FACE="Courier New, monospace">binkd</FONT>.
Комментарии предназначены для поясняющих (памятных) записей и также
игнорируются.</P>
<P>Комментарий начинается со знака &laquo;решётка&raquo; (&laquo;#&raquo;),
который может располагаться в любой позиции строки. Всё, что
расположено справа от знака &laquo;решётка&raquo;, игнорируется
<FONT FACE="Courier New, monospace">binkd</FONT>.</P>
<P>Каждая директива файла конфигурации начинается с ключевого слова,
которое может располагаться в любой позиции строки, но перед ключевым
словом допускаются только пробелы или знаки табуляции (символы с
кодами 32 и 9). Директива может состоять только из ключевого слова,
либо за ключевым словом могут следовать один или несколько
параметров, разделенные пробелами или знаками табуляции. Если
параметр (например, пароль) содержит пробел, знак комментария
(&laquo;решётку&raquo;) или знак табуляции, он должен быть заключён в
кавычки либо указанный знак должен предваряться знаком &laquo;обратная
косая черта&raquo; (&laquo;\&raquo;). Если параметр содержит знак
&laquo;обратная косая черта&raquo; (&laquo;\&raquo;), этот знак
должен дублироваться, а в некоторых случаях и учетверяться (такие
случаи специально оговорены).</P>
<P>Порядок следования в файле конфигурации для некоторых директив
имеет значение, поскольку binkd просматривает файл конфигурации
сверху вниз. В тексте главы директивы приведены в алфавитном порядке
для облегчения поиска.</P>
<P>В файле конфигурации можно использовать ссылки на переменные
окружения (environment variables). Название переменной окружения с
обеих сторон заключается в знаки процента (&laquo;%&raquo;).</P>
<P>В дальнейшем для простоты под словом &laquo;пробел&raquo;
подразумевается знак пробела либо знак табуляции.</P>
<P>&laquo;Нашей&raquo; FTN-системой названа система, которую мы
конфигурируем. &laquo;Удалённой&raquo; FTN-системой названа система,
с которой возможно соединение нашей FTN-системы по протоколу <FONT FACE="Courier New, monospace">binkp</FONT>.</P>
<H2>4.01. address</H2>
<P>Перечисление адресов нашей FTN-системы, разделённых пробелами.
Адреса указываются в формате 5D, хотя возможно и указание их в
сокращенной форме (3D или 4D). В случае сокращенной записи адреса,
подставляется тот домен, который указан в первой строке &laquo;<FONT FACE="Courier New, monospace">domain</FONT>&raquo;
файла конфигурации (в версиях 1.x такое поведение будет изменено).
Нулевой номер пойнта у адреса узла указывать не рекомендуется.</P>
<P>Эта директива является обязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">address 2:5047/999@fidonet
2:5020/999.1@fidonet</FONT></P>
<H2>4.02. aso</H2>
<P>Если директива <FONT FACE="Courier New, monospace">aso</FONT>
указана в файле конфигурации, <FONT FACE="Courier New, monospace">binkd</FONT>
будет <FONT FACE="Times New Roman, serif">работать с почтовой
очередью стандарта Amiga Style Outbound (ASO) вместо Binkley Style
Outbound (BSO), используемого по умолчанию.</FONT></P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">aso</FONT></P>
<H2>4.03. backresolv</H2>
<P>Если директива <FONT FACE="Courier New, monospace">backresolv</FONT>
указана в файле конфигурации, <FONT FACE="Courier New, monospace">binkd</FONT>
будет проводить поиск доменного имени по адресу удалённой
FTN-системы, которая обратилась к <FONT FACE="Courier New, monospace">binkd</FONT>
нашей FTN-системы. Такая операция требует некоторого времени
(особенно в случае отсутствия адреса удалённой системы в DNS), на
которое произойдёт задержка в процессе установлении сеанса связи.
</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">backresolv</FONT></P>
<H2>4.04. bindaddr</H2>
<P>Директива <FONT FACE="Courier New, monospace">bindaddr</FONT>
<FONT FACE="Times New Roman, serif">задаёт адрес IP, который будет
&laquo;слушать&raquo; серверная часть <FONT FACE="Courier New, monospace">binkd</FONT>.
Эта директива обычно используется при необходимости использовать
несколько копий <FONT FACE="Courier New, monospace">binkd</FONT> с
разными конфигурациями на разных адресах либо ограничить
использование <FONT FACE="Courier New, monospace">binkd</FONT> одним
адресом IP.</FONT></P>
<P>Параметр &ndash; адрес IP в октетной записи. Значение по умолчанию
&ndash; 0.0.0.0 (все адреса, имеющиеся на хосте).</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">bindaddr 192.168.0.3</FONT></P>
<H2>4.05. binlog</H2>
<P>Директива <FONT FACE="Courier New, monospace">binlog</FONT> <FONT FACE="Times New Roman, serif">задаёт
файл, в который <FONT FACE="Courier New, monospace">binkd</FONT>
будет записывать статистику каждого соединения. Этот файл совместим с
используемым в <FONT FACE="Times New Roman, serif">мейлере</FONT>
<FONT FACE="Courier New, monospace">T-Mail</FONT> и может быть
обработан любой программой, работающей с двоичным логфайлом <FONT FACE="Courier New, monospace">T-Mail</FONT>,
например, программой <FONT FACE="Courier New, monospace">T-Hist</FONT>.
</FONT>Параметр &ndash; строка, содержащая имя файла, обычно с путём.
Значение по умолчанию не установлено (нет файла, протокол в двоичном
виде не ведется).</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">binlog c:\\bbs\\log\\binkd.sts</FONT></P>
<H2>4.06. brakebox</H2>
<P>Директива <FONT FACE="Courier New, monospace">brakebox</FONT>
задаёт путь к каталогу файл-боксов в стиле мейлера &laquo;<FONT FACE="Courier New, monospace">The
Brake!</FONT>&raquo;. Путь указывается параметром этой директивы.
Значение по умолчанию не установлено (файлбоксы не используются).</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">brakebox C:\\fido\\brakebox</FONT></P>
<H2>4.07. call-delay</H2>
<P>Директива <FONT FACE="Courier New, monospace">call-delay</FONT>
<FONT FACE="Times New Roman, serif">задаёт задержку перед запуском
новых клиентских процессов (потоков) при достижении максимально
разрешённого числа запущенных клиентских процессов (потоков),
указанного в директиве <FONT FACE="Courier New, monospace">maxclients</FONT>.
Побочное действие: на время этой задерки не проводится сканирование
почтовой очереди. </FONT>Параметр &ndash; целое неотрицательное
число. Значение по умолчанию &ndash; 60 (секунд).</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">call-delay 60</FONT></P>
<H2>4.08. conlog</H2>
<P>Директива <FONT FACE="Courier New, monospace">conlog</FONT> задаёт
уровень протоколирования, который будет использоваться при выводе
диагностических сообщений на консоль <FONT FACE="Courier New, monospace">binkd</FONT>.
Параметр директивы &ndash; число (положительное или отрицательное в
пределах -32768..32767 либо -2147483648..2147483647 в зависимости от
компилятора, реальный смысл имеют значения от -1 до 10). Чтобы
полностью запретить вывод на экран, достаточно указать значение,
меньшее -1. Значение по умолчанию &ndash; 0.</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">conlog 4</FONT></P>
<H2>4.09. connect-timeout</H2>
<P>Директива <FONT FACE="Courier New, monospace">connect-timeout</FONT>
<FONT FACE="Times New Roman, serif">задаёт время ожидания при
установлении <FONT FACE="Times New Roman, serif">соединения </FONT>TCP.
</FONT>Параметр &ndash; целое неотрицательное число. <FONT FACE="Times New Roman, serif">Единицы
измерения &ndash; секунды.</FONT> Значение по умолчанию &ndash; 0
(используется таймаут, заложенный в ОС). Эта директива имеет смысл,
если указанное значение меньше таймаута TCP сетевого драйвера
операционной системы.</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">connect-timeout 300</FONT></P>
<H2>4.10. debugcfg</H2>
<P>Если директива <FONT FACE="Courier New, monospace">debugcfg</FONT>
<FONT FACE="Times New Roman, serif">указана в файле конфигурации,
<FONT FACE="Courier New, monospace">binkd</FONT> перед началом работы
выведет обработанную им конфигурацию, прочитанную из файла.
Используется для проверки конфигурации. Эквивалентна указанию опции
&laquo;<FONT FACE="Courier New, monospace">-vvv</FONT>&raquo; в
строке запуска <FONT FACE="Courier New, monospace">binkd</FONT>. Э<FONT FACE="Times New Roman, serif">та
директива устарела и в</FONT> версиях binkd 1.x будет убрана.</FONT></P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">debugcfg</FONT></P>
<H2>4.11. defnode</H2>
<P>Директива <FONT FACE="Courier New, monospace">defnode</FONT>
описывает умолчания для узлов, не описанных явно в файле конфигурации
(в строках <FONT FACE="Courier New, monospace">node</FONT>). Значение
по умолчанию не установлено (нет умолчаний). Параметры те же, что и
директивы <FONT FACE="Courier New, monospace">node</FONT>.</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">defnode -nd *</FONT></P>
<H2>4.12. deletebox</H2>
<P>Если директива <FONT FACE="Courier New, monospace">deletebox</FONT>
<FONT FACE="Times New Roman, serif">указана в файле конфигурации,
<FONT FACE="Courier New, monospace">binkd</FONT> при сканировании
будет удалять пустые файлбоксы. Эту директиву нужно использовать с
осторожностью, поскольку в случае работы в многозадачной ОС возможно
завершение работы тоссера с ошибкой, например, в ситуации, когда
тоссер пытается записать файл в файлбокс, непосредственно перед этим
удалённый в <FONT FACE="Courier New, monospace">binkd</FONT> (тоссер
не сможет создать файл).</FONT></P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">deletebox</FONT></P>
<H2>4.13. deletedirs</H2>
<P>Если директива <FONT FACE="Courier New, monospace">deletedirs</FONT>
у<FONT FACE="Times New Roman, serif">казана в файле конфигурации,
<FONT FACE="Courier New, monospace">binkd</FONT> при завершении
сеанса связи с линком будет удалять относящиеся к нему пустые
каталоги в почтовой очереди. Действие этой директивы распространяется
на пойнтовые адреса линка (т.е. адреса с ненулевым номером пойнта).
Использование этой директивы совершенно безопасно в отличие от
директивы </FONT><FONT FACE="Courier New, monospace">deletebox</FONT><FONT FACE="Times New Roman, serif">.</FONT></P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">deletedirs</FONT></P>
<H2>4.14. domain</H2>
<P>Директива <FONT FACE="Courier New, monospace">domain</FONT> может
указываться в двух форматах. Основной формат описывает FTN-домены с
указанием основного каталога почтовой очереди (аутбаунда, outbound) и
основной номер зоны для каждого домена. &laquo;Основной номер зоны&raquo;
- это номер зоны, который не добавляется к пути к каталогу аутбаунда.
Подробности см. в описании Binkley Style Outbound (BSO).
Дополнительный формат указывает псевдоним (дополнительное имя, алиас)
для ранее заданного домена.</P>
<P>Первый формат:</P>
<P><FONT FACE="Courier New, monospace">domain &lt;домен&gt; &lt;путь&gt;
&lt;номер зоны&gt; [&lt;root-domain&gt;]</FONT></P>
<P>Второй формат:</P>
<P><FONT FACE="Courier New, monospace">domain &lt;псевдоним&gt;
alias-for &lt;домен&gt;</FONT></P>
<P>Эта директива является обязательной.</P>
<P>Примеры:</P>
<P><FONT FACE="Courier New, monospace">domain fidonet
c:\\bbs\\outbound\\fidonet 2<BR>domain musicnet
c:\\bbs\\outbound\\musicnet 333 musicnet.ru<BR>domain fido alias-for
fidonet<BR>domain fidonet.org alias-for fidonet</FONT></P>
<P>В приведённых примерах для зоны 2 FTN-домена <FONT FACE="Courier New, monospace">fidonet</FONT>
используется каталог <FONT FACE="Courier New, monospace">c:\bbs\outbound\fidonet</FONT>,
для остальных зон FTN-домена <FONT FACE="Courier New, monospace">fidonet</FONT>
используются каталоги <FONT FACE="Courier New, monospace">c:\bbs\outbound\fidonet.&lt;номер_зоны&gt;</FONT>
(так, для зоны 1 &ndash; <FONT FACE="Courier New, monospace">c:\bbs\outbound\fidonet.1</FONT>).
Для зоны 333 FTN-домена <FONT FACE="Courier New, monospace">musicnet</FONT>
используется каталог <FONT FACE="Courier New, monospace">c:\bbs\outbound\musicnet</FONT>,
для остальных зон FTN-домена <FONT FACE="Courier New, monospace">musicnet</FONT>
&ndash; каталоги <FONT FACE="Courier New, monospace">c:\bbs\outbound\musicnet.&lt;номер_зоны&gt;</FONT>.
При соединениях с линками, предъявившими адреса из доменов <FONT FACE="Courier New, monospace">fido</FONT>
и <FONT FACE="Courier New, monospace">fidonet.org</FONT>,
используется домен <FONT FACE="Courier New, monospace">fidonet</FONT>.
(Такая возможность реализована для устранения последствий ошибочных
конфигураций на удалённых узлах.)</P>
<P>Дополнительный необязательный параметр <FONT FACE="Courier New, monospace">&lt;root-domain&gt;</FONT>
указывается для описания, какой интернетовский домен использовать для
получения адреса узла, если в конфиге он прописан как &laquo;*&raquo;.
Если этот параметр не указан, используется глобальный параметр
<FONT FACE="Courier New, monospace">root-domain</FONT> (по умолчанию
- <FONT FACE="Courier New, monospace">fidonet.net</FONT>).</P>
<H2>4.15. exec</H2>
<P>Директива <FONT FACE="Courier New, monospace">exec</FONT>
<FONT FACE="Times New Roman, serif">описывает <FONT FACE="Times New Roman, serif">условие
и </FONT>команду ОС, которая будет запущена при выполнении условия.
Условием служит событие <FONT FACE="Times New Roman, serif">приёма
файла, имя которого подходит под заданную маску.</FONT> Команда, как
правило, заключается в кавычки.</FONT></P>
<P><FONT FACE="Times New Roman, serif">Если команда предваряется
восклицательным знаком, она будет выполнена сразу по приёму файла.
Иначе &ndash; по окончании сеанса.</FONT></P>
<P><FONT FACE="Times New Roman, serif">В <FONT FACE="Courier New, monospace">binkd</FONT>
для 32-хбитных версий Windows, кроме &laquo;!&raquo;, можно
использовать модификаторы &laquo;@&raquo; и &laquo;@@&raquo;. &laquo;@&raquo;
означает запуск програмы в отдельном окне консоли, &laquo;@@&raquo; -
в скрытом окне.</FONT></P>
<P><FONT FACE="Times New Roman, serif">В строке команды можно
использовать макросы, начинающиеся с символа звездочки &laquo;*&raquo;,
поэтому знак звёздочки (не макрос) в команде должен предваряться
символом искейпинга (обратной косой чертой &laquo;\&raquo;), а чтобы
указать в команде этот символ, его нужно указывать дважды. В маске
имени файла каждый символ искейпинга нужно дополнительно дублировать,
поэтому пути в ОС Windows нужно указывать четыре знака &laquo;\&raquo;
подряд (например: &laquo;c:\\\\binkd&raquo;).</FONT></P>
<P><FONT FACE="Times New Roman, serif">Все файлы в строке команды
лучше указывать с абсолютным путём, это позволит избежать ошибок при
изменении переменных окружения и при запуске binkd из другого
каталога. В маске можно указывать путь к конкретному каталогу приёма
файлов или не указывать его, тогда маска должна начинаться с символа
звёздочки &laquo;*&raquo;.</FONT></P>
<P>Формат (последние два варианта могут быть использованы только в
<FONT FACE="Courier New, monospace">binkd/w32</FONT> и <FONT FACE="Courier New, monospace">binkd/w9x</FONT>):</P>
<P><FONT FACE="Courier New, monospace">exec &quot;команда параметры
и/или макросы&quot; &lt;маска имени&gt;<BR>exec &quot;!команда
параметры и/или макросы&quot; &lt;маска имени&gt;</FONT><BR><FONT FACE="Courier New, monospace">exec
&quot;@команда параметры и/или макросы&quot; &lt;маска имени&gt;<BR>exec
&quot;@@команда параметры и/или макросы&quot; &lt;маска имени&gt;</FONT></P>
<P>где:</P>
<P STYLE="margin-left: 2cm"><FONT FACE="Times New Roman, serif">команда
параметры и/или макросы &ndash; командная строка для запуска програмы
с макросами или без них;</FONT></P>
<P STYLE="margin-left: 2cm"><FONT FACE="Times New Roman, serif">&lt;маска
имени&gt; - маска имени файла, проверяемая по приёму каждого файла.</FONT></P>
<P>Возможные макросы:</P>
<P STYLE="margin-left: 2cm">*F &ndash; полное имя принятого файла (с
путём);</P>
<P STYLE="margin-left: 2cm">*A0..*A9 &ndash; первые 10 адресов
удалённой системы (*A0 &ndash; первый адрес, *A9 &ndash; десятый
адрес);</P>
<P STYLE="margin-left: 2cm">*A*, *A@ - список всех адресов удалённой
системы, разделенных пробелами;</P>
<P STYLE="margin-left: 2cm">*P &ndash; признак парольности сеанса,
принимает значения 0 (непарольный) или 1 (парольный);</P>
<P STYLE="margin-left: 2cm">*L - признак известности удалённой
системы (т.е. Описана ли эта система в строке node), принимает
значения 0 (неизвестна) или 1 (известна);</P>
<P STYLE="margin-left: 2cm">*H &ndash; имя хоста или адрес IP
удалённой системы;</P>
<P STYLE="margin-left: 2cm">*N &ndash; короткое имя приянтого файла
(используется только в версии для 32х-битных ОС Windows);</P>
<P STYLE="margin-left: 2cm">*S &ndash; имя файла с информацией SRIF
(см. !SRIF.TXT из дистрибутива или комплекта исходных текстов <FONT FACE="Courier New, monospace">binkd</FONT>,
также см. документ FTSC &laquo;FSC-0086.001&raquo;).</P>
<P>Эта директива является необязательной.</P>
<P>Примеры:</P>
<P><FONT FACE="Courier New, monospace">exec &quot;!my-freq-processor.exe
/options *S&quot; *.req<BR>exec &quot;d:\\path\\my-pkt-unpacker.exe
/options *A*&quot; c:\\\\bbs\\\\inbound\\\\*.pkt <BR>exec
&quot;d:\\path\\my-tosser.exe /options&quot; *.su? *.mo? *.tu? *.we?
*.th? *.fr? *.sa?<BR>Exec &quot;!d:\\path\\my-pkt-filter.exe *F
/options&quot; c:\\\\bbs\\\\inbound\\\\unsecure\\\\*.pkt<BR>exec
&quot;d:\\path\\my-special-unpacker.bat /options&quot;
c:\\\\bbs\\\\inbound-of-my-friend\\\\*</FONT></P>
<P><FONT FACE="Times New Roman, serif">В первом примере <FONT FACE="Courier New, monospace">binkd</FONT>
сформирует файл по стандарту SRIF и запустит программу
<FONT FACE="Courier New, monospace">my-freq-processor.exe <FONT FACE="Times New Roman, serif">с
указанными параметрами сразу по приёму файла, заканчивающегося на
</FONT>&laquo;.req&raquo;,</FONT> независимо от того, с каким линком
проходит сеанс связи (защищен паролем или нет, и даже если для линка
используется отдельный каталог для приёма файлов). Программа должна
располагаться в текущем каталоге или в каталоге, который указан в
переменной окружения <FONT FACE="Courier New, monospace">PATH</FONT>.
Во втором примере по окончании сеанса связи будет выполнена команда
<FONT FACE="Courier New, monospace">d:\path\my-pkt-unpacker.exe</FONT>
с указанными опциями, в конец будет подстановлено имя файла, если
сеанс связи был защищён паролем и в парольный инбаунд был принят файл
с пакетом нетмейла. В третьем примере программа будет выполнена по
окончании сеанса связи с любым линком, если был принят пакет
эхомейла. В четвёртом примере программа будет выполнена во время
сеанса связи, не защищенного паролем, в котором был принят файл с
пакетом нетмэйла, в начале списка параметров команды будет вставлено
имя принятого файла с путём. В пятом примере скрипт будет выполнен по
окончании сеанса связи с узлом, в строке <FONT FACE="Courier New, monospace">node</FONT>
для которого указан входящий инбаунд в случае, если от этого линка
был принят любой файл.</FONT></P>
<H2>4.16. fdinhist</H2>
<P>Директива <FONT FACE="Courier New, monospace">fdinhist</FONT>
<FONT FACE="Times New Roman, serif">задаёт имя файла, в который в
двоичном виде будет записываться статистика входящих сеансов связи.
Формат файла совместим с мейлером &laquo;FrontDoor&raquo;, что
позволяет использовать анализаторы статистики, разработанные для
этого мейлера.</FONT></P>
<P>Параметр &ndash; путь и имя файла. Значение по умолчанию не
установлено.</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">fdinhist c:\\bbs\\log\\in.his</FONT></P>
<H2>4.17. fdouthist</H2>
<P>Директива <FONT FACE="Courier New, monospace">fdouthist</FONT>
<FONT FACE="Times New Roman, serif">задаёт имя файла, в который в
двоичном виде будет записываться статистика исходящих сеансов связи.
Формат файла совместим с мейлером &laquo;<FONT FACE="Courier New, monospace">FrontDoor</FONT>&raquo;,
что позволяет использовать анализаторы статистики, разработанные для
этого мейлера.</FONT></P>
<P>Параметр &ndash; путь и имя файла. Значение по умолчанию не
установлено.</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">fdouthist
c:\\bbs\\log\\out.his</FONT></P>
<H2>4.18. filebox</H2>
<P>Директива <FONT FACE="Courier New, monospace">filebox</FONT>
задаёт путь к каталогу файл-боксов в стиле мейлера &laquo;<FONT FACE="Courier New, monospace">T-Mail</FONT>&raquo;.
Путь указывается параметром этой директивы. <FONT FACE="Courier New, monospace">Binkd</FONT>
умеет работать с файлбоксами в &laquo;коротком&raquo; и в &laquo;длинном&raquo;
формате <FONT FACE="Courier New, monospace">T-mail</FONT>. Подробнее
о формате файлбоксов см. в п. 7.1.3 и в документации на мейлер
&laquo;<FONT FACE="Courier New, monospace">T-Mail</FONT>&raquo;.
Значение по умолчанию не установлено (файлбоксы не используются).</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">filebox c:\\bbs\\filebox</FONT></P>
<P>Примечание.</P>
<P>Файлбоксы стиля T-mail используют 4D-адресацию FTN, поэтому их не рекомендуется использовать в случае работы с несколькими доменами FTN.</P>
<H2>4.19. flag</H2>
<P>Директива <FONT FACE="Courier New, monospace">flag</FONT> <FONT FACE="Times New Roman, serif">задаёт
условие и имя файла, который будет создан при выполнении условия.
Файл создатся пустым (длиной 0 байт). Если файл существует, он не
будет перезаписан, но будет обновлено время его модификации. Условием
служит событие приёма файла, имя которого подходит под заданную
маску.</FONT></P>
<P><FONT FACE="Times New Roman, serif">Имеет смысл указывать полный
путь к файлу флага. В пути к файлу флага каждый символ &laquo;\&raquo;
нужно указывать дважды. В маске имени файла его нужно дополнительно
дублировать, поэтому пути файлам в ОС Windows нужно указывать четыре
знака &laquo;\&raquo; подряд (например: &laquo;c:\\\\binkd&raquo;).</FONT></P>
<P>Эта директива является необязательной.</P>
<P>См. также описание директивы <FONT FACE="Courier New, monospace">exec</FONT>.</P>
<P>Примеры:</P>
<P><FONT FACE="Courier New, monospace">flag c:\\bbs\\flags\\toss.now
*.su? *.mo? *.tu? *.we? *.th? *.fr? *.sa?<BR>flag
c:\\bbs\\flags\\netmail.in c:\\\\bbs\\\\inbound\\\\*.pkt</FONT></P>
<H2>4.20. ftrans</H2>
<P>Директива <FONT FACE="Courier New, monospace">ftrans</FONT> <FONT FACE="Times New Roman, serif">задаёт
правила подстановки строк в путях, перечисленных в файлах-списках
(*.?lo) почтовой очереди. Используется в случае использования <FONT FACE="Courier New, monospace">binkd</FONT>
и других программ на разных компьютерах, возможно с разными ОС
(например, <FONT FACE="Courier New, monospace">binkd</FONT> на
сервере под FreeBSD, а тоссер и редактор на компьютере пользователя
под Windows 2000). При этом каталог почтовой очереди располагается на
сетевом диске и пути к нему отличаются на разных компьютерах.
Параметры &ndash; две строки: заменяемая и заменяющая, как правило
заключаются в кавычки.</FONT></P>
<P><FONT FACE="Times New Roman, serif">В случае использования
смешанного окружения (ОС семейства UNIX и Windows, OS/2, DOS), когда
символ разделителя элементов пути различается, необходимо
использовать два правила (задавать две директивы <FONT FACE="Courier New, monospace">ftrans</FONT>):
для подстановки пути и для подстановки разделителя. В строках поиска
и подстановки каждый символ &laquo;\&raquo; нужно указывать дважды.</FONT></P>
<P>Формат:</P>
<P><FONT FACE="Courier New, monospace">ftrans &quot;заменяемая
подстрока&quot; &quot;заменяющая подстрока&quot;</FONT></P>
<P>Эта директива является необязательной.</P>
<P>Примеры:</P>
<P><FONT FACE="Courier New, monospace">ftrans &quot;D:\\fido\\outbound&quot;
&quot;/var/spool/fido/outb&quot;<BR>ftrans &quot;\\&quot; &quot;/&quot;<BR>ftrans
&quot;D:\\fido\\outbound&quot; &quot;М:\\outbound&quot;</FONT></P>
<H2>4.21. hold</H2>
<P>Директива <FONT FACE="Courier New, monospace">hold</FONT> задаёт
паузу между сериями попыток вызова линка в случае его недоступности.
Пауза устанавливается после заданного директивой <FONT FACE="Courier New, monospace">try</FONT>
числа попыток соединения. Параметр &ndash; положительное число. Пауза
задаётся в секундах. Значение по умолчанию: 0 (нет паузы).</P>
<P>Технически пауза реализуется путём записи в файл NNNNMMMM.hld
строки с числом - временем окончания паузы в формате unixtime, левая
часть имени файла совпадает с левой частью имени файлов *.?ut и *.?lo
для этого линка. (См. п. 7.3.2.)</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">hold 600</FONT></P>
<H2>4.22. hold-skipped</H2>
<P>Директива <FONT FACE="Courier New, monospace">hold-skipped</FONT>
<FONT FACE="Times New Roman, serif">задаёт </FONT>
</P>
<P>Параметр &ndash; целое неотрицательное число. Значение по
умолчанию &ndash; 0 (нет предела).</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">hold-skipped</FONT></P>
<H2>4.23. inbound</H2>
<P>Директива <FONT FACE="Courier New, monospace">inbound</FONT>
указывает путь к каталогу, в который <FONT FACE="Courier New, monospace">binkd</FONT>
помещает файлы, принятые во время сеансов связи, защищённых паролем
(во время парольных сессий). Этот каталог должен быть одинаковым в
настройках всех программ, составляющих нашу FTN-систему. <FONT FACE="Times New Roman, serif">В
пути к файлу каждый символ &laquo;\&raquo; нужно указывать дважды.</FONT></P>
<P>Эта директива является обязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">inbound c:\\bbs\\inbound</FONT></P>
<H2>4.24. inbound-nonsecure</H2>
<P>Директива <FONT FACE="Courier New, monospace">inbound-nonsecure</FONT>
указывает путь к каталогу, в который binkd помещает файлы, принятые
во время сеансов связи, не защищённых паролем (во время непарольных
сессий). Этот каталог должен быть одинаковым в настройках всех
программ, составляющих нашу FTN-систему, если он указан в этих
программах. <FONT FACE="Times New Roman, serif">В пути к файлу каждый
символ &laquo;\&raquo; нужно указывать дважды.</FONT></P>
<P>Эта директива является необязательной. В случае её отсутствия все
принятые файлы помещаются в каталог, указанный в директиве <FONT FACE="Courier New, monospace">inbound</FONT>.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">inbound-nonsecure
c:\\bbs\\inbound\\unsecure</FONT></P>
<H2>4.25. inboundcase</H2>
<P>Директива <FONT FACE="Courier New, monospace">inboundcase</FONT>
<FONT FACE="Times New Roman, serif">задаёт режим преобразования
регистра букв в имёнах принятях <FONT FACE="Courier New, monospace">binkd</FONT>
файлов. Возможные значения режима:</FONT></P>
<UL>
	<LI><P><FONT FACE="Times New Roman, serif"><FONT FACE="Courier New, monospace">save</FONT>
	&ndash; записывать файл с именем в том же написании, какое было
	передано с удалённой стороны;</FONT></P>
	<LI><P><FONT FACE="Times New Roman, serif"><FONT FACE="Courier New, monospace">upper</FONT>
	&ndash; преобразовывать буквы в имени файла в верхний регистр;</FONT></P>
	<LI><P><FONT FACE="Times New Roman, serif"><FONT FACE="Courier New, monospace">lower</FONT>
	&ndash; преобразовывать буквы в имени файла в нижний регистр;</FONT></P>
	<LI><P><FONT FACE="Times New Roman, serif"><FONT FACE="Courier New, monospace">mixed</FONT>
	&ndash; преобразовывать первую после разделителя букву в имени файла
	в верхний регистр, все остальные &ndash; в нижний (разделителем
	считается любой символ, не являющийся буквой или цифрой), например
	имя файла &laquo;file-id.diz&raquo; будет преобразовано в
	&laquo;File-Id.Diz&raquo;.</FONT></P>
</UL>
<P>Параметр &ndash; строка, принимающая одно из четырёх значений:
&laquo;<FONT FACE="Courier New, monospace">save</FONT>&raquo;,
&laquo;<FONT FACE="Courier New, monospace">upper</FONT>&raquo;,
&laquo;<FONT FACE="Courier New, monospace">lower</FONT>&raquo;,
&laquo;<FONT FACE="Courier New, monospace">mixed</FONT>&raquo;.
Значение по умолчанию &ndash; &laquo;<FONT FACE="Courier New, monospace">save</FONT>&raquo;
(оставлять имена файлов без изменения).</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">inboundcase save</FONT></P>
<H2>4.26. include</H2>
<P>Директива <FONT FACE="Courier New, monospace">include</FONT>
используется для включения части конфигурации из другого файла.
Параметр директивы &ndash; строка, путь к включаемому файлу. Может
использоваться, к примеру, для запуска нескольких копий <FONT FACE="Courier New, monospace">binkd</FONT>
с файлами конфигурации, различающимися в части параметров и большой
общей (включаемой) частью конфигурации. <FONT FACE="Times New Roman, serif">В
пути к файлу каждый символ &laquo;\&raquo; нужно указывать дважды.</FONT></P>
<P>Пример:</P>
<P STYLE="text-decoration: none"><FONT FACE="Courier New, monospace">include
c:\\bbs\\binkd\\nodes.cfg</FONT></P>
<H2>4.27. iport</H2>
<P>Директива <FONT FACE="Courier New, monospace">iport</FONT> <FONT FACE="Times New Roman, serif">задаёт
TCP порт, который будет открыт binkd для приёма входящих соединений.
Эта директива может использоваться для установки нестандартного порта
для работы <FONT FACE="Courier New, monospace">binkd</FONT>, в
частности для обхода запрещающих правил сетевого шлюза-брандмауэра.</FONT></P>
<P>Параметр &ndash; целое положительное число либо строка (название
номера порта из файла <FONT FACE="Courier New, monospace">/etc/services</FONT>
в <FONT FACE="Courier New, monospace">unix</FONT> и
<FONT FACE="Courier New, monospace">c:\winnt\system32\drivers\etc\services</FONT>
в Windows NT и 2000, в <FONT FACE="Courier New, monospace">c:\windows\system32\drivers\etc\services</FONT>
вWindows XP и 2003). Значение по умолчанию &ndash; 24554.</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">iport 443</FONT></P>
<H2>4.28. kill-dup-partial-files</H2>
<P>Если директива <FONT FACE="Courier New, monospace">kill-dup-partial-files</FONT>
указана в файле конфигурации, <FONT FACE="Courier New, monospace">binkd</FONT>
при приёме нового файла будет удалять не полностью принятый файл с
тем же именем, но отличающийся временем изменения и размером. Если
эта директива не указана, в каталоге приёма файлов (в каталоге,
указанном директивой <FONT FACE="Courier New, monospace">temp-inblund</FONT>
либо, если временный каталог инбаунда не задан, в каталогах <FONT FACE="Courier New, monospace">inbound</FONT>
и <FONT FACE="Courier New, monospace">inbound-nonsecure</FONT>) будут
накапливаться файлы с именами <FONT FACE="Courier New, monospace">*.dt</FONT>
и <FONT FACE="Courier New, monospace">*.hr</FONT>.</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P STYLE="text-decoration: none"><FONT FACE="Courier New, monospace">kill-dup-partial-files</FONT></P>
<H2>4.29. kill-old-bsy</H2>
<P>Если директива <FONT FACE="Courier New, monospace">kill-old-bsy</FONT>
<FONT FACE="Times New Roman, serif">указана в файле конфигурации,
<FONT FACE="Courier New, monospace">binkd</FONT> будет удалять из
каталога почтовой очереди файлы-флаги занятости удалённой системы
<FONT FACE="Courier New, monospace">*.bsy</FONT>, которые старше, чем
указанный в параметре период времени.</FONT></P>
<P>Параметр &ndash; целое положительное число, единицы измерения -
секунды. Значение по умолчанию не установлено (файлы *.bsy не
удаляются).</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">kill-old-bsy 43200</FONT></P>
<H2>4.30. kill-old-partial-files</H2>
<P>Директива <FONT FACE="Courier New, monospace">kill-old-partial-files</FONT>
задаёт время, по истечении которого <FONT FACE="Courier New, monospace">binkd</FONT>
будет удалять старые частично принятые файлы. Время указывается в
параметре директывы положительным целым числом, измеряется в
секундах. Если эта директива не указана, в каталоге приёма файлов (в
каталоге, указанном директивой <FONT FACE="Courier New, monospace">temp-inblund</FONT>
либо, если временный каталог не задан, в каталогах <FONT FACE="Courier New, monospace">inbound</FONT>
и <FONT FACE="Courier New, monospace">inbound-nonsecure</FONT>) будут
накапливаться файлы с именами <FONT FACE="Courier New, monospace">*.dt</FONT>
и <FONT FACE="Courier New, monospace">*.hr</FONT>.</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">kill-old-partial-files 86400</FONT></P>
<H2>4.31. location</H2>
<P>Директива <FONT FACE="Courier New, monospace">location </FONT>задаёт
название местности, в которой расположена FTN-система. Это
исключительно справочная информация, которая предъявляется удалённой
стороне во время процедуры опознания FTN-системы. Параметр &ndash;
текстовая строка, обычно заключается в кавычки.</P>
<P>Эта директива является обязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">location &quot;Magadan,
Russia&quot;</FONT></P>
<H2>4.32. log</H2>
<P>Директива <FONT FACE="Courier New, monospace">log</FONT> <FONT FACE="Times New Roman, serif">задаёт
имя файла, в который <FONT FACE="Courier New, monospace">binkd</FONT>
будет записывать протокол своей работы. В большинстве случаев имеет
смысл указывать имя файла с путём, чтобы исключить путаницу при
запуске binkd из разных каталогов файловой системы. В пути к файлу
каждый символ &laquo;\&raquo; нужно указывать дважды.</FONT></P>
<P>Параметр &ndash; строка. Значение по умолчанию не установлено
(протокол не ведется).</P>
<P>Эта директива является обязательной. При запуске <FONT FACE="Courier New, monospace">binkd</FONT>
сервисом в Windows и демоном в ОС семейства UNIX имеет смысл
указывать её первой директивой файла конфигурации, чтобы ошибки
конфигурации были записаны в файл протокола.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">log c:\\bbs\\logs\\binkd.log</FONT></P>
<H2>4.33. loglevel</H2>
<P>Директива <FONT FACE="Courier New, monospace">loglevel</FONT>
задаёт уровень протоколирования, который будет использоваться при
выводе диагностических сообщений в файл протокола <FONT FACE="Courier New, monospace">binkd</FONT>
либо в <FONT FACE="Courier New, monospace">syslog</FONT>. Параметр
директивы &ndash; положительное число (положительное или
отрицательное в пределах 0..32767 либо 0..2147483647 в зависимости от
компилятора, реальный смысл имеют значения от 0 до 10). Значение по
умолчанию &ndash; 0 (протоколируются только критические ошибки).</P>
<P>Перечень уровней протоколирования:<BR>-1 &ndash; сообщения
windows-версии об установке, удалении и состоянии сервиса; <BR>0 &ndash;
критическая ошибка, в результате которой дальнейшая работа <FONT FACE="Courier New, monospace">binkd</FONT>
невозможна;<BR>1 &ndash; ошибки и причины остановки;<BR>2 &ndash;
ошибки соединения, трансляция путей, изменения файла конфигурации,
состояние протокола binkp;<BR>3 &ndash; включение/выключение
расширений binkp, прием и отправка файлов, запуск внешних программ,
удаление пустых файлбоксов;<BR>4 &ndash; запуск binkd, код возврата
завершившегося потомка, полл, ошибка сервера, работа с файлами и
др.;<BR>5 &ndash; работа с DNS, открытие/закрытие сокетов и файлов,
обрезание и переименование файлов и др.; <BR>6 &ndash; протокол
binkp, относительные пути;<BR>7 &ndash; адреса в режиме ND, прием и
передача блоков данных;<BR>8 &ndash; преобразования имён файлов,
таймаут в Windows 9x, адреса удалённой системы, время операции, ...;
<BR>9 &ndash; информация о процессе приёма;<BR>10 &ndash; отладочные
сообщения о взаимодействии с прокси.</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">loglevel 4</FONT></P>
<H2>4.34. maxclients</H2>
<P>Директива <FONT FACE="Courier New, monospace">maxclients</FONT>
задаёт максимально допустимое для <FONT FACE="Courier New, monospace">binkd</FONT>
число клиентских процессов (или потоков в многопоточных ОС), которые
могут работать одновременно. Другими словами: это максимально
возможное число одновременных исходящих сеансов связи. Параметр &ndash;
целое неотрицательное число. Значение по умолчанию &ndash; 100.</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">maxclients 2</FONT></P>
<H2>4.35. maxservers</H2>
<P>Директива <FONT FACE="Courier New, monospace">maxservers</FONT>
задаёт максимально допустимое для <FONT FACE="Courier New, monospace">binkd</FONT>
число серверных процессов (или потоков в многопоточных ОС), которые
могут работать одновременно. Другими словами: это максимально
возможное число одновременных входящих сеансов связи. Параметр &ndash;
целое неотрицательное число. Значение по умолчанию &ndash; 100.</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">maxservers 2</FONT></P>
<H2>4.36. minfree</H2>
<P>Директива <FONT FACE="Courier New, monospace">minfree</FONT>
задаёт минимально допустимое количество свободного места на разделе
диска, в котором расположен каталог, описанный в директиве <FONT FACE="Courier New, monospace">inbound</FONT>.
Параметр &ndash; неотрицательное число, обозначает количество
килобайт. Если во время парольной сессии <FONT FACE="Courier New, monospace">binkd</FONT>
обнаружил, что свободное место после приёма следующего файла станет
меньше указанного, он в этом сеансе отказывается от приёма файлов и
работает только на отправку. Значение по умолчанию не установлено
(без ограничений).</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">minfree 2048</FONT></P>
<H2>4.37. minfree-nonsecure</H2>
<P>Директива <FONT FACE="Courier New, monospace">minfree-nonsecure</FONT>
задаёт минимально допустимое количество свободного места на разделе
диска, в котором расположен каталог, описанный в директиве inbound.
Параметр &ndash; неотрицательное число, обозначает количество
килобайт. Если во время непарольной сессии <FONT FACE="Courier New, monospace">binkd</FONT>
обнаружил, что свободное место после приёма следующего файла станет
меньше указанного, он в этом сеансе отказывается от приёма файлов и
работает только на отправку. Значение по умолчанию не установлено
(без ограничений).</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">minfree-nonsecure 2048</FONT></P>
<H2>4.38. node</H2>
<P>Директива node описывает параметры линка, с которым возможно
соединение.</P>
<P>Формат (необязательные параметры заключены в квадратные скобки,
обязательные &ndash; в угловые скобки, фигурные скобки обрамляют
варианты, один из которых обязателен, варианты разделяются символом
&laquo;|&raquo;):</P>
<P><FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 9pt">node
&lt;FTN-адрес&gt; [-nr|-nd] [-md|-nomd] [-ip|-sip] [{адреса хостов|-}
[{пароль|-} [атрибут [{аутбокс|-} [{инбокс|-}]]]]]</FONT></FONT></P>
<P><FONT SIZE=3>где:</FONT></P>
<UL>
	<LI><P><FONT FACE="Courier New, monospace">FTN-адрес</FONT> - адрес
	линка в формате 2D, 3D, 4D или 5D, недостающие части адреса
	подставляются на основе адресов нашей системы (достаточно указать
	только номер узла линка);</P>
	<LI><P><FONT FACE="Courier New, monospace">-nr</FONT> - пытаться
	использовать режим &laquo;not reliable link mode&raquo; (&laquo;NR
	mode&raquo;) протокола binkp для линка (режим включится только если
	удалённая сторона его поддерживает), параметр необязателен, не может
	использоваться одновременно с &laquo;-nd&raquo;;</P>
	<LI><P><FONT FACE="Courier New, monospace">-nd</FONT> - пытаться
	использовать режим &laquo;no dupes mode&raquo; (&laquo;ND mode&raquo;)
	протокола binkp для линка (режим включится только если удалённая
	сторона его поддерживает), параметр необязателен, не может
	использоваться одновременно с &laquo;-nr&raquo;;</P>
	<LI><P><FONT SIZE=3><FONT FACE="Courier New, monospace">-md</FONT> <FONT FACE="Times New Roman, serif">-
	пытаться использовать шифрование MD5 при обмене паролем в протоколе
	binkp для линка (режим включится только если удалённая сторона его
	поддерживает), параметр необязателен, не может использоваться
	одновременно с &laquo;-nomd&raquo;;</FONT></FONT></P>
	<LI><P><FONT FACE="Courier New, monospace">-nomd</FONT> - пытаться
	использовать шифрование MD5 при обмене паролем в протоколе binkp для
	линка (режим включится только если удалённая сторона его
	поддерживает), параметр необязателен, не может использоваться
	одновременно с &laquo;-md&raquo;;</P>
	<LI><P><FONT FACE="Courier New, monospace">-ip</FONT> &ndash;
	проверять соответствие адреса IP линка указанному(ым) в строке node
	при приёме соединения и считать сеанс связи не защищенным паролем
	при несоответствии даже если был предъявлен верный пароль, параметр
	необязателен, не может использоваться одновременно с &laquo;-sip&raquo;;</P>
	<LI><P><FONT FACE="Courier New, monospace">-sip</FONT> &ndash;
	проверять соответствие адреса IP линка указанному(ым) в строке node
	при приёме соединения и прекращать сеанс при несоответствии,
	параметр необязателен, не может использоваться одновременно с &laquo;-ip&raquo;;</P>
	<LI><P><FONT FACE="Courier New, monospace"><FONT SIZE=3>адреса
	хостов &ndash; <FONT FACE="Times New Roman, serif">перечень адресов
	IP, доменных имён DNS и символа звёздочки, разделённых точкой с
	запятой; звёздочка обозначает необходимость сгенерировать имя <FONT FACE="Times New Roman, serif">DNS</FONT>
	из адреса FTN на базе домена DNS, указанного в директиве rootdomain;
	этот список может быть заменён знаком &laquo;минус&raquo; (&laquo;-&raquo;),
	который обозначает пустой список, в этом случае <FONT FACE="Courier New, monospace">binkd</FONT>
	никогда не будет пытаться установить соединение с таким линком
	(обычно используется для описания пойнтов); адрес хоста может также
	содержать номер порта для линка, при этом он состоит из адреса IP
	или доменного имени, разделителя в виде знака двоеточия (&laquo;:&raquo;)
	и числа -номера порта либо символьного имени порта (имя порта должно
	быть описано в файле /etc/services для unix и в
	c:\winnt\system32\drivers\etc\services дял windows NT и 2000, см.
	также директиву oport);</FONT></FONT></FONT></P>
	<LI><P><FONT FACE="Times New Roman, serif"><FONT SIZE=3><FONT FACE="Courier New, monospace">пароль</FONT>
	&ndash; пароль, который проверяется в начале сеанса связи с
	удалённой системой; может быть заменён знаком &laquo;минус&raquo;
	(&laquo;-&raquo;), который обозначает пустой пароль (отсутствие
	пароля);</FONT></FONT></P>
	<LI><P><FONT FACE="Times New Roman, serif"><FONT SIZE=3><FONT FACE="Courier New, monospace">атрибут</FONT>
	&ndash; атрибут (flavour) для аутбокса, может принимать значения:
	&laquo;i&raquo; (&laquo;<FONT FACE="Courier New, monospace">immediate</FONT>&raquo;),
	&laquo;c&raquo; (&laquo;<FONT FACE="Courier New, monospace">crash</FONT>&raquo;),
	&laquo;d&raquo; (&laquo;<FONT FACE="Courier New, monospace">direct</FONT>&raquo;),
	&laquo;h&raquo; (&laquo;<FONT FACE="Courier New, monospace">hold</FONT>&raquo;),
	&laquo;-&raquo; (&laquo;<FONT FACE="Courier New, monospace">normal</FONT>&raquo;);
	для <FONT FACE="Courier New, monospace">binkd</FONT> атрибуты
	&laquo;<FONT FACE="Courier New, monospace">immediate</FONT>&raquo;,
	&laquo;<FONT FACE="Courier New, monospace">crash</FONT>&raquo;,
	&laquo;<FONT FACE="Courier New, monospace">normal</FONT>&raquo; и
	&laquo;<FONT FACE="Courier New, monospace">direct</FONT>&raquo;
	имеют одинаковый смысл &ndash; присутствие файла в аутбоксе
	инициирует процедуру установления соединения с линком, различие
	возникает только в очередности передачи файлов из персонального
	аутбокса и аутбоксов стилей &laquo;T-Mail&raquo; и &laquo;The
	Brake!&raquo;: передаются файлы из аутбоксов в последовательности:
	&laquo;<FONT FACE="Courier New, monospace">immediate</FONT>&raquo;,
	&laquo;<FONT FACE="Courier New, monospace">crash</FONT>&raquo;,&laquo;<FONT FACE="Courier New, monospace">direct</FONT>&raquo;,
	&laquo;<FONT FACE="Courier New, monospace">normal</FONT>&raquo;;
	если аутбокс имеет атрибут &laquo;<FONT FACE="Courier New, monospace">hold</FONT>&raquo;,
	файлы из него передаются только во время входящей сессии;</FONT></FONT></P>
	<LI><P><FONT FACE="Times New Roman, serif"><FONT SIZE=3><FONT FACE="Courier New, monospace">аутбокс</FONT>
	&ndash; путь к персональному каталогу на отправку файлов; <FONT FACE="Courier New, monospace">binkd</FONT>
	передает файлы, помещенные в этот каталог, указанному линку,
	учитывая атрибут (см. предыдущий пункт); передаче не подлежат файлы,
	имена которых соответствуют маске &laquo;.*&raquo; (т.е. Не
	передаются файлы, начинающиеся со знака точки), также скрытые и
	системные файлы (в ОС и на файловых системах, которые поддерживают
	такие атрибуты); в пути к файлу каждый символ &laquo;\&raquo; нужно
	указывать дважды.</FONT></FONT></P>
	<LI><P><FONT FACE="Times New Roman, serif"><FONT SIZE=3><FONT FACE="Courier New, monospace">инбокс</FONT>
	- путь к персональному каталогу на приём файлов; <FONT FACE="Courier New, monospace">binkd</FONT>
	помещает в этот каталог все принятые от линка файлы; в пути к файлу
	каждый символ &laquo;\&raquo; нужно указывать дважды.</FONT></FONT></P>
</UL>
<P>Эта директива является необязательной. В случае, когда
устанавливается сеанс связи с линком, не описанным в директиве <FONT FACE="Courier New, monospace">node</FONT>,
используются настройки, заданные директивой <FONT FACE="Courier New, monospace">defnode</FONT>
и пароли из файла паролей, указанного в директиве <FONT FACE="Courier New, monospace">passwords</FONT>.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">node 5047/888 - password<BR>node
5047/999 hostname;* password i c:\\bbs\\boxes\\to999
c:\\bbs\\boxes\\from999</FONT></P>
<H2>4.39. nodeinfo</H2>
<P>Директива <FONT FACE="Courier New, monospace">nodeinfo</FONT>
<FONT FACE="Times New Roman, serif">описывает параметры нашей FTN
станции. Принято указывать максимально возможную в сеансе связи
скорость (в форме &laquo;число&raquo; (байт) либо
&laquo;ЧислоЕдиницаизмерения&raquo;) и, через запятую, поддерживаемые
флаги нодлиста.</FONT></P>
<P>Параметр &ndash; произвольная строка. Значение по умолчанию не
установлено.</P>
<P>Эта директива является обязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">nodeinfo 128K,IBN,XW</FONT></P>
<H2>4.40. oblksize</H2>
<P>Директива <FONT FACE="Courier New, monospace">oblksize</FONT>
<FONT FACE="Times New Roman, serif">задаёт максимальный размер
передаваемого блока данных в байтах. Уменьшение значения может
потребоваться в ситуации с большим количеством потерь пакетов IP (с
целью уменьшить избыточный трафик при повторной посылке пакетов в
TCP). Увеличение значения повышает эффективность передачи файлов (в
каждом блоке данных binkp 1.0 используется 2 байта на служебную
информацию).</FONT></P>
<P>Параметр &ndash; целое положительное число. Значение по умолчанию
&ndash; 4096 (байт). Максимально допустимое значение &ndash; 32767
(ограничено протоколом <FONT FACE="Courier New, monospace">binkp</FONT>).</P>
<P>Эта директива является необязательной.</P>
<P>Пример (в котором значение размера блока устанавливается таким,
чтобы исключить фрагментацию пакетов IP при подключении по Ethernet):</P>
<P><FONT FACE="Courier New, monospace">oblksize 1445</FONT></P>
<H2>4.41. oport</H2>
<P>Директива <FONT FACE="Courier New, monospace">oport</FONT>
<FONT FACE="Times New Roman, serif">назначает порт, на который <FONT FACE="Courier New, monospace">binkd</FONT>
будет пытаться установить соединение в том случае, когда порт для
линка не указан явно в адресе хоста линка в строке node.</FONT></P>
<P>Параметр &ndash; целое положительное число либо строка (название
номера порта из файла <FONT FACE="Courier New, monospace">/etc/services</FONT>
в unix и <FONT FACE="Courier New, monospace">c:\winnt\system32\drivers\etc\services</FONT>
в Windows NT и 2000, в <FONT FACE="Courier New, monospace">c:\windows\system32\drivers\etc\services</FONT>
вWindows XP и 2003). Значение по умолчанию &ndash; 24554.</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">oport 24555</FONT></P>
<H2>4.42. overwrite</H2>
<P>Директива <FONT FACE="Courier New, monospace">overwrite</FONT>
<FONT FACE="Times New Roman, serif">задаёт перечень масок имён
файлов, которые будут замещаться в каталоге приема файлов <FONT FACE="Times New Roman, serif">принятыми
новыми</FONT>. Эта возможность обычно используется для исключения
ситуации обработки устаревшей информации на нашей FTN системе,
например, для автоматической замены сетевых сегментов нодлиста,
распространяемых по файлэхе.</FONT></P>
<P>Параметры &ndash; список строк, разделенных пробелами. Каждый
параметр описывает одну маску имени файла без указания пути.</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">overwrite net_*.*</FONT></P>
<H2>4.43. passwords</H2>
<P>Директива <FONT FACE="Courier New, monospace">passwords</FONT>
<FONT FACE="Times New Roman, serif">задаёт имя файла паролей стиля
мейлера <FONT FACE="Courier New, monospace">T-mail</FONT>. Директива
используется для ведения списка паролей в одном месте (в одном файле)
на станции FTN.</FONT></P>
<P>Параметр &ndash; строка, имя файла, обычно с путём. <FONT FACE="Times New Roman, serif">В
пути к файлу каждый символ &laquo;\&raquo; нужно указывать дважды.</FONT>
Значение по умолчанию не установлено (файл паролей не используется).</P>
<P>Формат файла паролей (угловые скобки обозначают обязательные
элементы, квадратные &ndash; необязательные):</P>
<P><FONT FACE="Courier New, monospace">&lt;адрес FTN&gt; [пароль]</FONT></P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">passwords
c:\\t-mail\\password.lst</FONT></P>
<H2>4.44. percents</H2>
<P>Если директива <FONT FACE="Courier New, monospace">percents</FONT>
<FONT FACE="Times New Roman, serif">указана в файле конфигурации,
<FONT FACE="Courier New, monospace">binkd</FONT> выводит на консоль
(экран) информацию о том, какая часть файла передана или принята.</FONT></P>
<P>Параметра нет.</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">percents</FONT></P>
<H2>4.45. pid-file</H2>
<P>Директива <FONT FACE="Courier New, monospace">pid-file</FONT>
<FONT FACE="Times New Roman, serif">задаёт имя файла, который будет
использоваться для хранения идентификатора процесса <FONT FACE="Courier New, monospace">binkd</FONT>
во время его работы. Этот файл используется в ОС семейства unix для
простоты обнаружения неработающего <FONT FACE="Courier New, monospace">binkd</FONT>
в случае его аварийного завершения и для простоты управления демоном
<FONT FACE="Courier New, monospace">binkd</FONT> (например, команда,
инициирующая перечитывание файла конфигурации, выглядит так:
&laquo;<FONT FACE="Courier New, monospace">kill&nbsp;-1&nbsp;`cat&nbsp;binkd.pid`</FONT>&raquo;).
См. также п. 7.3.1.</FONT></P>
<P>Параметр &ndash; строка, имя файла, обычно с путём. <FONT FACE="Times New Roman, serif">В
пути к файлу каждый символ &laquo;\&raquo; нужно указывать дважды.</FONT>
Значение по умолчанию не установлено (файл PID не используется).</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">pid-file /var/run/binkd.pid</FONT></P>
<H2>4.46. prescan</H2>
<P>Директива <FONT FACE="Courier New, monospace">prescan</FONT>
<FONT FACE="Times New Roman, serif">задаёт дополнительное
сканирование каталога почтовой очереди для линка уже после
установления с ним соединения и при передаче файлов.</FONT></P>
<P>Параметр отсутствует.</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">prescan</FONT></P>
<H2>4.47. printq</H2>
<P>Если директива <FONT FACE="Courier New, monospace">printq</FONT>
<FONT FACE="Times New Roman, serif">указана в файле конфигурации,
<FONT FACE="Courier New, monospace">binkd</FONT> выводит на консоль
(экран) информацию о состоянии почтовой очереди при каждои её
сканировании.</FONT></P>
<P>Параметр отсутствует.</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">printq</FONT></P>
<H2>4.48. proxy</H2>
<P>Директива <FONT FACE="Courier New, monospace">proxy</FONT> <FONT FACE="Times New Roman, serif">задаёт
параметры <FONT FACE="Times New Roman, serif">сервера </FONT>прокси
стандарта HTTP/HTTPS, который должен использовать <FONT FACE="Courier New, monospace">binkd</FONT>
для осуществления исходящих соединений. Совместно с <FONT FACE="Courier New, monospace">binkd</FONT>
можно использовать любой сервер прокси, который поддерживает команду
CONNECT протокола HTTP. Соединение с сервером прокси может быть
защищено комбинацией логина и пароля, при этом возможно использование
методов аутентификации BASIC и NTLM-DIGEST. Примеры совместимого ПО
серверов прокси: Squid, MS ISA Server, OOPS, WinProxy, WinGate.</FONT></P>
<P>Параметр - строка вида:</P>
<P><FONT FACE="Courier New, monospace">адрес:порт[/логин/пароль[/имя_компьютера/домен_windows]]</FONT></P>
<P>, где:</P>
<UL>
	<LI><P><FONT FACE="Courier New, monospace">адрес</FONT> &ndash;
	адрес IP либо доменное имя сервера HTTP proxy;</P>
	<LI><P><FONT FACE="Courier New, monospace">порт</FONT> &ndash; номер
	порта TCP сервера HTTP proxy (обычно 3128 либо 80);</P>
	<LI><P><FONT FACE="Courier New, monospace">логин</FONT> &ndash;
	учетное имя для аутентификации на сервере HTTP proxy (совпадает с
	именем пользователя, которое запрашивается браузером при попытке
	соединения с использованием сервера прокси);</P>
	<LI><P><FONT FACE="Courier New, monospace">пароль</FONT> &ndash;
	секретный пароль для аутентификации на сервере HTTP proxy (совпадает
	с паролем, которое запрашивается браузером при попытке соединения с
	использованием сервера прокси);</P>
	<LI><P><FONT FACE="Courier New, monospace">имя_компьютера</FONT> &ndash;
	имя Вашего компьютера по MS netbios (имя Вашего компьютера в &laquo;сети
	Microsoft&raquo;: в ОС Windwos 95, 98, Me указывается на вкладке
	&laquo;идентификация&raquo; в параметрах &laquo;Сеть&raquo; панели
	управления; в ОС Windows 2000, XP, 2003 указывается на вкладке
	&laquo;идентификация&raquo; в параметрах &laquo;Система&raquo;
	панели управления);</P>
	<LI><P><FONT FACE="Courier New, monospace">домен_windows</FONT> &ndash;
	домен Windows, в котором происходит аутентификация с использованием
	NTLM (обычно это единственный в Вашей организации домен Windows, в
	котором Вы проходите аутентификацию после включения компьютера);</P>
</UL>
<UL>
	<LI><P>квадратные скобки обозначают необязательные элементы.</P>
</UL>
<P>Значение по умолчанию не установлено (прокси стандарта HTTP/HTTPS
не используется).</P>
<P>Эта директива является необязательной.</P>
<P>Примеры:</P>
<P><FONT FACE="Courier New, monospace">proxy proxy.my.dom:3128<BR>proxy
proxy.secure.my.dom:3128/login/password<BR>proxy
proxy.ntlm.my.dom:1080/login/password/myhost/domain</FONT></P>
<P><FONT FACE="Times New Roman, serif">В первом примере используется
прокси без аутентификации, во втором &ndash; c аутентификацией BASIC,
в третьем - с аутентификацией NTLM.</FONT></P>
<H2>4.49. rescan-delay</H2>
<P>Директива <FONT FACE="Courier New, monospace">rescan-delay</FONT>
<FONT FACE="Times New Roman, serif">задаёт задержку между
<FONT FACE="Times New Roman, serif">сканированиями почтовой очереди.
Эта задержка может увеличиваться на значение, казанное</FONT> в
директиве <FONT FACE="Courier New, monospace">call-delay</FONT>.
Побочное действие директивы &ndash; регулирует задержку перед
завершением <FONT FACE="Courier New, monospace">binkd</FONT> в случае
использования опции командной строки &laquo;-p&raquo;.</FONT></P>
<P>Параметр &ndash; целое положительное число. Значение по умолчанию
&ndash; 60 (секунд).</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">rescan-delay 2</FONT></P>
<H2>4.50. root-domain</H2>
<P>Директива <FONT FACE="Courier New, monospace">root-domain</FONT>
<FONT FACE="Times New Roman, serif">задаёт строку базового домена DNS
для формирования имени DNS для хоста линка из его адреса FTN.</FONT></P>
<P><FONT FACE="Times New Roman, serif">Формат преобразования:</FONT></P>
<P><FONT FACE="Courier New, monospace">pПОЙНТ.fНОДА.nСЕТЬ.zЗОНА.root-domain.<BR>fНОДА.nСЕТЬ.zЗОНА.root-domain.</FONT></P>
<P><FONT FACE="Times New Roman, serif">где ПОЙНТ, НОДА, СЕТЬ и ЗОНА
обозначают соответствующие номера-части адреса FTN линка, если номер
пойнта отсутствует или равен нулю, он не транслируется и эта часть
домена DNS не используется. Так, адрес 1:2/3.4 преобразуется к виду
&laquo;p4.f3.n2.z1.fidonet.net.&raquo; при указании базового домена
&laquo;fidonet.net.&raquo;</FONT></P>
<P>Параметр &ndash; строка. Значение по умолчанию &ndash;
&laquo;fidonet.net.&raquo;. Рекомендуется указывать имя домена,
завершая его точкой, во избежание автоматического поиска домена в
процедуре разрешения доменных имён с подстановкой в конец строк
домена по умолчанию и доменов для поиска, описанных в конфигурации
ОС.</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">root-domain fidonet.net.</FONT></P>
<H2>4.51. send-if-pwd</H2>
<P>Если директива <FONT FACE="Courier New, monospace">send-if-pwd</FONT>
<FONT FACE="Times New Roman, serif">указана в файле конфигурации,
<FONT FACE="Courier New, monospace">binkd</FONT> будет отправлять
файлы в случае входящего сеанса связи, защищённого паролем и при
любом исходящем сеансе связи. Если эта директива указана и на линка с
отсутствующим паролем имеется почта либо файлы с атрибутом <FONT FACE="Courier New, monospace">hold</FONT>,
они могут никогда не быть переданы. Такая почта никогда не будет
передана на линка, у которого не указан адрес хоста.</FONT></P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">send-if-pwd</FONT></P>
<H2>4.52. skipmask</H2>
<P>Директива <FONT FACE="Courier New, monospace">skipmask</FONT>
<FONT FACE="Times New Roman, serif">задаёт маски имён файлов, которые
не будут приниматься <FONT FACE="Courier New, monospace">binkd</FONT>
на нашей стороне и будут удаляться как успешно переданные на стороне
линка.</FONT></P>
<P>Параметры &ndash; список масок имён файлов без путей. Значение по
умолчанию не установлено (принимаются все файлы).</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P STYLE="font-weight: medium"><FONT FACE="Courier New, monospace">skipmask
*.avi pm2.*</FONT></P>
<H2>4.53. socks</H2>
<P>Директива <FONT FACE="Courier New, monospace">socks</FONT> <FONT FACE="Times New Roman, serif">задаёт
параметры прокси-сервера стандарта <FONT FACE="Courier New, monospace">socks</FONT>,
который должен использовать <FONT FACE="Courier New, monospace">binkd</FONT>
для осуществления исходящих соединений. Совместно с <FONT FACE="Courier New, monospace">binkd</FONT>
можно использовать <FONT FACE="Courier New, monospace">socks</FONT>
версий 4 и 5, при использовании <FONT FACE="Courier New, monospace">socks</FONT>
5 соединение с сервером <FONT FACE="Courier New, monospace">socks</FONT>
может быть защищено комбинацией логина и пароля.</FONT></P>
<P>Параметр - строка вида:</P>
<P><FONT FACE="Courier New, monospace">адрес:порт[/[логин/пароль]]</FONT></P>
<P>, где:</P>
<UL>
	<LI><P><FONT FACE="Courier New, monospace">адрес</FONT> &ndash;
	адрес IP либо доменное имя сервера socks-proxy;</P>
	<LI><P><FONT FACE="Courier New, monospace">порт</FONT> &ndash; номер
	порта TCP сервера socks-proxy (обычно 1080);</P>
	<LI><P><FONT FACE="Courier New, monospace">логин</FONT> &ndash;
	учетное имя для аутентификации на socks 5;</P>
	<LI><P><FONT FACE="Courier New, monospace">пароль</FONT> &ndash;
	секретный пароль для аутентификации на socks 5;</P>
	<LI><P>квадратные скобки обозначают необязательные элементы.</P>
</UL>
<P>В случае использования socks 4 указывается только адрес и порт, в
случае использования socks 5 без аутентификации в конец строки
добавляется символ косой черты &laquo;/&raquo;, в случае
использования socks 5 с аутентификацией используется полный формат.
</P>
<P>Значение по умолчанию не установлено (прокси стандарта socks не
используется).</P>
<P>Эта директива является необязательной.</P>
<P>Примеры:</P>
<P><FONT FACE="Courier New, monospace">socks socks4.my.dom:1080<BR>socks
socks5.my.dom:1080/<BR>socks socks5.secure.my.dom:1080/login/password</FONT></P>
<P>В первом примере используется socks 4, во втором &ndash; socks 5
без аутентификации, в третьем - socks 5 с аутентификацией по логину и
паролю.</P>
<H2>4.54. syslog</H2>
<P>Если директива <FONT FACE="Courier New, monospace">syslog</FONT>
<FONT FACE="Times New Roman, serif">указана в файле конфигурации,
<FONT FACE="Courier New, monospace">binkd</FONT> выводит протокол
работы в системный лог ОС. Директива действительна только в ОС
семейства UNIX и binkd, скомпилированный для других ОС, воспринимает
эту директиву как ошибочную (неизвестную).</FONT></P>
<P>Параметр &ndash; строка, название syslog facility. Возможные
значения: &laquo;kern&raquo;, &laquo;user&raquo;, &laquo;mail&raquo;,
&laquo;daemon&raquo;, &laquo;auth&raquo;, &laquo;syslog&raquo;,
&laquo;lpr&raquo;, &laquo;news&raquo;, &laquo;uucp&raquo;, &laquo;cron&raquo;,
&laquo;authpriv&raquo;, &laquo;ftp&raquo;, &laquo;local0&raquo;,
&laquo;local1&raquo;, &laquo;local2&raquo;, &laquo;local3&raquo;,
&laquo;local4&raquo;, &laquo;local5&raquo;, &laquo;local6&raquo;,
&laquo;local7&raquo; (уточнить список допустимых для Вашей ОС
значений можно в странице man syslog). Значение по умолчанию не
установлено.</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">syslog local0</FONT></P>
<H2>4.55. sysname</H2>
<P>Директива <FONT FACE="Courier New, monospace">sysname</FONT>
<FONT FACE="Times New Roman, serif">задаёт название нашей FTN
станции.</FONT></P>
<P>Параметр &ndash; произвольная строка, обычно заключается в
кавычки.</P>
<P>Эта директива является обязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">sysname &laquo;My Cool
Station&raquo;</FONT></P>
<H2>4.56. sysop</H2>
<P>Директива <FONT FACE="Courier New, monospace">sysop</FONT> <FONT FACE="Times New Roman, serif">задаёт
имя сисопа нашей FTN-системы. </FONT>Параметр &ndash; строка, обычно
заключается в кавычки.</P>
<P>Эта директива является обязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">sysop Ivan</FONT></P>
<H2>4.57. temp-inbound</H2>
<P>Директива <FONT FACE="Courier New, monospace">temp-inbound</FONT>
<FONT FACE="Times New Roman, serif">задаёт путь к каталогу для
временного хранения принятых не до конца файлов. Если указана, все
принимаемые <FONT FACE="Courier New, monospace">binkd</FONT> файлы
сначала записываются в этот каталог, затем перемещаются в каталог,
указанный к директиве <FONT FACE="Courier New, monospace">inbound</FONT>
или inbound-nonsecure. Для скорости перемещения файлов имеет смысл
располагать каталоги, описанные в директивах &laquo;<FONT FACE="Courier New, monospace">temp-inbound&raquo;</FONT>,
&laquo;<FONT FACE="Courier New, monospace">inbound&raquo;</FONT> и
&laquo;<FONT FACE="Courier New, monospace">inbound-nonsecure&raquo;</FONT>
на одном дисковом логическом разделе (томе). </FONT>Параметр &ndash;
строка-путь. Значение по умолчанию &ndash; не установлено.</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">temp-inbound
c:\\bbs\\inbound\\binkdtmp</FONT></P>
<H2>4.58. timeout</H2>
<P>Директива <FONT FACE="Courier New, monospace">timeout</FONT>
<FONT FACE="Times New Roman, serif">задаёт время ожидания ответа в
секундах при установленном TCP-соединения с удалённой системой.
</FONT>Параметр &ndash; целое неотрицательное число. Значение по
умолчанию &ndash; 300 (т.е. пять минут).</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">timeout 300</FONT></P>
<H2>4.59. try</H2>
<P>Директива <FONT FACE="Courier New, monospace">try</FONT> <FONT FACE="Times New Roman, serif">задаёт
число попыток вызова удалённой FTN-системы, после неудачи которых
вызовы этой системы будут приостановлены на время, указанное в
директиве <FONT FACE="Courier New, monospace">hold</FONT>. </FONT>Параметр
&ndash; целое неотрицательное число. Значение по умолчанию &ndash; 0
(нет ограничения числа попыток).</P>
<P>Эта директива является необязательной.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">try 10</FONT></P>
<H2>4.60. tzoff</H2>
<P>Директива <FONT FACE="Courier New, monospace">tzoff</FONT> <FONT FACE="Times New Roman, serif">задаёт
смещение локального часового пояса к мировому времени UTC в секундах.
</FONT>Параметр &ndash; целое число. Значение по умолчанию &ndash; 0
(время на часах компьютера соотвествует UTC).</P>
<P>Эта директива является необязательной и её использование
необходимо только в тех операционных системах и при компиляции <FONT FACE="Courier New, monospace">binkd</FONT>
теми компиляторами, в которых нет готовых функций вычисления времени
UTC. В каждом конкретном случае имеет смысл проверить, соответствует
ли время событий, записанных в файл протокола, UTC. Нет необходимости
использовать эту директиву в Windows, OS/2, ОС семейства UNIX.</P>
<P>Пример (смещение UTC+6):</P>
<P><FONT FACE="Courier New, monospace">tzoff 1800</FONT></P>
<H1>5. Параметры командной строки.</H1>
<P><FONT FACE="Courier New, monospace">Binkd</FONT> при нормальной
работе должен быть запушен с указанием параметров в командной строке.</P>
<P>Формат строки вызова <FONT FACE="Courier New, monospace">binkd</FONT>
(указаны все возможные опции для всех ОС, необязательные элементы
заключены в квадратные скобки, знак &laquo;|&raquo; разделяет
варианты &ndash; т.е. опции, которые не могут быть использованы
одновременно):</P>
<P><FONT FACE="Courier New, monospace"><FONT SIZE=2>[/path/to/]binkd
[-[C][c][p][q][r][s][v][m][h][T][i|u]] [-t srvcmd] [-S srvn] [-P
node] config</FONT></FONT></P>
<P>Параметры, начинающиеся со знака минус (&laquo;-&raquo;),
называются опциями (options). Все буквы в опциях &ndash; латинские.
Порядок указания опций не имеет значения, главное чтобы параметр &ndash;
имя файла конфигурации был указан последним.</P>
<P>Набор действующих опций зависит от ОС, для которой скомпилирован
binkd, и от варианта сборки binkd.</P>
<P>Краткую справку по параметрам командной строки <FONT FACE="Courier New, monospace">binkd</FONT>
можно всегда получить, запустив <FONT FACE="Courier New, monospace">binkd</FONT>
без параметров или с параметром &laquo;-h&raquo;. Пример для Windows
NT:</P>
<P><FONT FACE="Courier New, monospace"><FONT SIZE=2>C:\fido\binkd&gt;
binkd -h<BR>usage: binkd [-CcpqrsvmhTiu] [-S srvn] [-P node]
config<BR>-C exit(3) on config change<BR>-c run client only<BR>-T
minimize to System Tray<BR>-i install WindowsNT service<BR>-u
uninstall WindowsNT service<BR>-S srvn name of WindowsNT service
(default: binkd-service)<BR>-P node poll a node<BR>-p run client
only, poll, quit<BR>-q be quiet<BR>-r disable crypt traffic<BR>-s run
server only<BR>-v be verbose / dump version and quit<BR>-m disable
CRAM-MD5 authorization<BR>-h print this help<BR><BR>Copyright (c)
1996-2012 Dima Maloff and others.<BR><BR>This program is free
software; you can redistribute it and/or modify<BR>it under the terms
of the GNU General Public License as published by<BR>the Free
Software Foundation. See COPYING.<BR><BR>Report bugs to 2:463/68 or
binkd-bugs@happy.kiev.ua.</FONT></FONT></P>
<P>Далее в этой главе следуют описания каждой опции.</P>
<H2>5.01. -C (заглавная, прописная буква &laquo;C&raquo;).</H2>
<P>Если <FONT FACE="Courier New, monospace">binkd</FONT> запущен с
опцией &laquo;-C&raquo;, он перед сканированием почтовой очереди
будет проверять обновление файла конфигурации. В ОС семейства UNIX и
при работе сервисом в 32-х битных ОС Windows в случае, если файл
конфигурации изменился, <FONT FACE="Courier New, monospace">binkd</FONT>
запустит себя заново и предыдущая копия завершится (в Windows с кодом
возврата 3, в UNIX - 0). В версиях для DOS и Windows 3.x и при работе
<FONT FACE="Courier New, monospace">binkd/w32</FONT> в обычном режиме
(не сервисом) <FONT FACE="Courier New, monospace">binkd</FONT>
завершится с кодом возврата 3. Это используется для автоматического
принятия изменений в файле конфигурации <FONT FACE="Courier New, monospace">binkd</FONT>.</P>
<P>Пример командного файла для MS DOS и Windows:</P>
<P><FONT FACE="Courier New, monospace">@echo
off<BR>:loop<BR>c:\bbs\binkd\binkd -C c:\bbs\binkd\binkd.cfg<BR>if
errorlevel 4 goto end<BR>if errorlevel 3 goto loop<BR>:end</FONT></P>
<H2>5.02. -c (строчная буква &laquo;c&raquo;).</H2>
<P>Опция &laquo;-c&raquo; запрещает <FONT FACE="Courier New, monospace">binkd</FONT>
принимать входящие соединения, т.е. в <FONT FACE="Courier New, monospace">binkd</FONT>
работает только клиентская часть.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">binkd -c binkd.cfg</FONT></P>
<H2>5.03. -D (прописная буква &laquo;D&raquo;).</H2>
<P>Опция &laquo;-D&raquo; указывает <FONT FACE="Courier New, monospace">binkd</FONT>
работать демоном (в фоновом режиме). Имеет смысл только для ОС
семейства UNIX и в других ОС эта опция недоступна.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">/usr/local/sbin/binkd -D
/usr/local/etc/binkd.conf</FONT></P>
<H2>5.04. -h (строчная буква &laquo;h&raquo;).</H2>
<P><FONT FACE="Courier New, monospace">Binkd</FONT>, вызванный с
опцией &laquo;<FONT FACE="Courier New, monospace">-h</FONT>&raquo;,
выведет на экран информацию формате командной строки и о доступных
опциях, затем завершит работу. Такое же поведение у <FONT FACE="Courier New, monospace">binkd</FONT>,
запущенного без указания в командной строке параметров и опций, а
также с неподерживаемыми им опциями. При использовании опции &laquo;<FONT FACE="Courier New, monospace">-h</FONT>&raquo;
файл конфигурации в командной строке указывать не обязательно.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">binkd -h<BR>binkd</FONT></P>
<H2>5.05. -i (строчная буква &laquo;i&raquo;).</H2>
<P>Действие опции &laquo;<FONT FACE="Courier New, monospace">-i</FONT>&raquo;
зависит от операционной системы, для которой скомпилирован <FONT FACE="Courier New, monospace">binkd</FONT>.
В 32-хбитных ОС семейства Windows эта опция используется для
установки сервиса с теми параметрами, которые были заданы совместно с
опцией &laquo;<FONT FACE="Courier New, monospace">-i</FONT>&raquo;.
<FONT FACE="Courier New, monospace">Binkd</FONT> устанавливает себя
сервисом и сразу запускает этот сервис. В ОС семейства UNIX и в OS/2
эта опция служит для запуска binkd из-под демона <FONT FACE="Courier New, monospace">inetd</FONT>,
при этом подразумевается опция &laquo;<FONT FACE="Courier New, monospace">-s</FONT>&raquo;.
Опция &laquo;<FONT FACE="Courier New, monospace">-i</FONT>&raquo; не
может использоваться одновременно с опцией &laquo;<FONT FACE="Courier New, monospace">-u</FONT>&raquo;
(в Windows).</P>
<P>Примеры команд установки сервиса для Windows 2000 (NT, XP, 2003):</P>
<P><FONT FACE="Courier New, monospace">binkd -i binkd.cfg<BR>binkd -i
-S binkd binkd.cfg<BR>binkd -i -S binkd -s -T binkd.cfg</FONT></P>
<P>Примеры команд установки сервиса для Windows 95 (98, Me):</P>
<P><FONT FACE="Courier New, monospace">c:\bbs\binkd\binkd9x -i
c:\bbs\binkd\binkd.cfg<BR>binkd9x -i -S binkd binkd.cfg</FONT></P>
<P>Пример строки для файла конфигурации <FONT FACE="Courier New, monospace">inetd</FONT>
(<FONT FACE="Courier New, monospace">/etc/inetd.conf)</FONT> во
FreeBSD (аналогично и в любой другой ОС семейства UNIX):</P>
<P><FONT FACE="Courier New, monospace">binkp stream tcp nowait fido
/usr/local/sbin/binkd binkd -i -q /usr/local/etc/fido/binkd.conf</FONT></P>
<H2>5.06. -m (строчная буква &laquo;m&raquo;).</H2>
<P>Опция &laquo;<FONT FACE="Courier New, monospace">-m</FONT>&raquo;
запрещает <FONT FACE="Courier New, monospace">binkd</FONT>
использовать шифрование пароля по алгоритму MD5 (аутентификацию
CRAM-MD5, см. FSP-1019), таким образом, <FONT FACE="Courier New, monospace">binkd</FONT>
всегда будет передавать и принимать пароль только в открытом виде.
Также не будет использоваться шифрование согласно расширению CRYPT
протокола <FONT FACE="Courier New, monospace">binkp</FONT>, поэтому
опция &laquo;<FONT FACE="Courier New, monospace">-m</FONT>&raquo;
фактически подразумевает опцию &laquo;<FONT FACE="Courier New, monospace">-r</FONT>&raquo;.
Эта опция может использоваться только для тестирования или в
защищённой от проникновений извне локальной сети. Вместо неё
рекомеднуется использовать опцию &laquo;<FONT FACE="Courier New, monospace">-nomd</FONT>&raquo;
в директиве <FONT FACE="Courier New, monospace">node</FONT>.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">binkd -m binkd.cfg</FONT></P>
<H2>5.07. -n (строчная буква &laquo;n&raquo;).</H2>
<P>Опция &laquo;<FONT FACE="Courier New, monospace">-n</FONT>&raquo;
появилась в binkd 0.9.9. Она указывает binkd не осуществлять и не
принимать вызовы, таким образом, после чтения файла конфигурации и
выполнения действий, заданных другими опциями командной строки, binkd
завершит работу . Опция &laquo;<FONT FACE="Courier New, monospace">-n</FONT>&raquo;
обычно используется совместно с опцией &laquo;<FONT FACE="Courier New, monospace">-P</FONT>&raquo;
или &laquo;<FONT FACE="Courier New, monospace">-vvv</FONT>&raquo;.</P>
<P>Примеры:</P>
<P><FONT FACE="Courier New, monospace">binkd -n -P2:5076/207 -P
3:712/848 binkd.cfg<BR>binkd -nvvv binkd.cfg</FONT></P>
<H2>5.08. -P (прописная буква &laquo;P&raquo;).</H2>
<P>Опция &laquo;<FONT FACE="Courier New, monospace">-P</FONT>&raquo;
задаёт адрес линка, на который <FONT FACE="Courier New, monospace">binkd</FONT>
создаст <FONT FACE="Courier New, monospace">poll</FONT> (создаст
пустой или обновит файл вида <FONT FACE="Courier New, monospace">*.ilo</FONT>,
соответствующий линку, в каталоге почтовой очереди). Адрес линка
указывается параметром опции вплотную или через пробел. В командной
строке могут быть указаны несколько опций &laquo;<FONT FACE="Courier New, monospace">-P</FONT>&raquo;.
Опция &laquo;<FONT FACE="Courier New, monospace">-P</FONT>&raquo;
обычно используется совместно с опцией &laquo;<FONT FACE="Courier New, monospace">-p</FONT>&raquo;.</P>
<P>Примеры:</P>
<P><FONT FACE="Courier New, monospace">binkd -P2:5076/207 -P
3:712/848 binkd.cfg<BR>binkd -P2:5080/102 -p binkd.cfg</FONT></P>
<H2>5.09. -p (строчная буква &laquo;p&raquo;).</H2>
<P>Если в командной строке указана опция &laquo;<FONT FACE="Courier New, monospace">-p</FONT>&raquo;,
<FONT FACE="Courier New, monospace">binkd</FONT> запустится в режиме
клиента (будет осуществлять только исходящие соединения) и по
опустошению очереди на отправку, завершится с кодом возврата 0. Эта
опция полезна для того, чтобы быстро отправить и/или забрать почту,
например, при установлении модемного соединения по диалапу. Опция
&laquo;<FONT FACE="Courier New, monospace">-p</FONT>&raquo;
подразумевает действие опции &laquo;<FONT FACE="Courier New, monospace">-c</FONT>&raquo;
и несовместима с опций &laquo;<FONT FACE="Courier New, monospace">-s</FONT>&raquo;.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">binkd -p binkd.cfg</FONT></P>
<H2>5.10. -q (строчная буква &laquo;q&raquo;).</H2>
<P>Опция &laquo;<FONT FACE="Courier New, monospace">-q</FONT>&raquo;
запрещает <FONT FACE="Courier New, monospace">binkd</FONT> выводить
что бы то ни было на консоль (на экран). Используется обычно в строке
вызова <FONT FACE="Courier New, monospace">binkd</FONT> из демона
<FONT FACE="Courier New, monospace">inetd</FONT>.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">binkd -q binkd.cfg</FONT></P>
<H2>5.11. -r (строчная буква &laquo;r&raquo;).</H2>
<P>Опция &laquo;<FONT FACE="Courier New, monospace">-r</FONT>&raquo;
запрещает <FONT FACE="Courier New, monospace">binkd</FONT>
использовать шифрование трафика согласно расширению CRYPT протокола
<FONT FACE="Courier New, monospace">binkp</FONT>.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">binkd -r binkd.cfg</FONT></P>
<H2>5.12. -S (прописная буква &laquo;S&raquo;).</H2>
<P>Опция &laquo;<FONT FACE="Courier New, monospace">-S</FONT>&raquo;
служит в <FONT FACE="Courier New, monospace">binkd/w32</FONT> и
<FONT FACE="Courier New, monospace">binkd/w9x</FONT> для указания
имени сервиса вместо заданного по умолчанию &laquo;binkd-service&raquo;.
Имя может содержать буквы, цифры, пробелы, знаки &laquo;-&raquo;
(Если в имени сервиса присутствуют пробелы, оно должно быть заключено
в кавычки во избежания ошибки распознавания параметров командной
строки). Опция &laquo;<FONT FACE="Courier New, monospace">-S</FONT>&raquo;
используется совместно с опциями &laquo;<FONT FACE="Courier New, monospace">-i</FONT>&raquo;
или &laquo;<FONT FACE="Courier New, monospace">-u</FONT>&raquo;. Эта
опция имеет смысл только для <FONT FACE="Courier New, monospace">binkd/w32</FONT>
и <FONT FACE="Courier New, monospace">binkd/w9x</FONT> и в других
вариантах <FONT FACE="Courier New, monospace">binkd</FONT> не
воспринимается.</P>
<P>Примеры:</P>
<P><FONT FACE="Courier New, monospace">binkd -i -S &laquo;Binkd
service&raquo; binkd.cfg<BR>binkd -u -S &laquo;Binkd service&raquo;</FONT></P>
<H2>5.13. -s (строчная буква &laquo;s&raquo;).</H2>
<P>Опция &laquo;<FONT FACE="Courier New, monospace">-s</FONT>&raquo;
запрещает <FONT FACE="Courier New, monospace">binkd</FONT>
осуществлять исходящие соединения, т.е. в <FONT FACE="Courier New, monospace">binkd</FONT>
работает только серверная часть.</P>
<P>Пример:</P>
<P><FONT FACE="Courier New, monospace">binkd -s binkd.cfg</FONT></P>
<H2>5.14. -T (прописная буква &laquo;T&raquo;).</H2>
<P>Опция &laquo;<FONT FACE="Courier New, monospace">-T</FONT>&raquo;
задаёт режим работы <FONT FACE="Courier New, monospace">binkd/w32</FONT>,
в котором в свёрнутом состоянии <FONT FACE="Courier New, monospace">binkd</FONT>
помещает свою иконку в &laquo;System Tray&raquo; Windows (в правой
части &laquo;Панели задач&raquo;) и при клике левой кнопкой мыши по
иконке восстанавливает вид окна. При работе <FONT FACE="Courier New, monospace">binkd</FONT>
сервисом использование этой опции является одним из способов спрятать
окно консоли <FONT FACE="Courier New, monospace">binkd</FONT> с
экрана (другой способ &ndash; в параметрах сервиса убрать пометку
взаимодействия с рабочим столом, но тогда вызвать окно консоли
сервиса <FONT FACE="Courier New, monospace">binkd</FONT> будет
невозможно).</P>
<P>Примеры:</P>
<P><FONT FACE="Courier New, monospace">binkd -T binkd.cfg<BR>binkd -T
-i binkd.cfg</FONT></P>
<P><FONT FACE="Times New Roman, serif">Во втором примере <FONT FACE="Courier New, monospace">binkd</FONT>
устанавливает себя сервисом, который будет сворачиваться в system
tray.</FONT></P>
<H2>5.15. -t (строчная буква &laquo;t&raquo;).</H2>
<P>Опция &laquo;<FONT FACE="Courier New, monospace">-t</FONT>&raquo;
служит для управления сервисом в <FONT FACE="Courier New, monospace">binkd</FONT>,
скомпилированного для ОC Windows 95 (98, Me). Команда управления
сервисом задаётся параметром опции. <FONT FACE="Courier New, monospace">Binkd/w9x</FONT>
выполняет команду и завершается. Опция &laquo;<FONT FACE="Courier New, monospace">-t</FONT>&raquo;
часто используется совместно с опцией &laquo;<FONT FACE="Courier New, monospace">-S</FONT>&raquo;.</P>
<P>Допустимые команды:</P>
<UL>
	<LI><P><FONT FACE="Courier New, monospace">start</FONT> &ndash;
	запуск сервиса binkd/w9x;</P>
	<LI><P><FONT FACE="Courier New, monospace">stop</FONT> &ndash;
	остановка сервиса binkd/w9x;</P>
	<LI><P><FONT FACE="Courier New, monospace">restart</FONT> &ndash;
	остановка и повторный запуск сервиса binkd/w9x;</P>
	<LI><P><FONT FACE="Courier New, monospace">status</FONT> &ndash;
	запрос статуса состояния сервиса binkd/w9x.</P>
</UL>
<P>Примеры:</P>
<P><FONT FACE="Courier New, monospace">binkd9x -t start<BR>binkd9x
-tstop<BR>binkd9x -t status -S binkd<BR>binkd9x -trestart -Sbinkd</FONT></P>
<H2>5.16. -u (строчная буква &laquo;u&raquo;).</H2>
<P>В 32-хбитных ОС семейства Windows опция &laquo;<FONT FACE="Courier New, monospace">-u</FONT>&raquo;
используется для удаления ранее установленного сервиса <FONT FACE="Courier New, monospace">binkd</FONT>.
Перед удалением сервиса в Windows он будет остановлен. Опция &laquo;<FONT FACE="Courier New, monospace">-u</FONT>&raquo;
не может использоваться одновременно с опцией &laquo;<FONT FACE="Courier New, monospace">-i</FONT>&raquo;</P>
<P>Примеры команд остановки и удаления сервиса для Windows 2000 (NT,
XP, 2003):</P>
<P><FONT FACE="Courier New, monospace">binkd -u<BR>binkd -u -S binkd</FONT></P>
<P>Примеры команд удаления сервиса для Windows 95 (98, Me):</P>
<P><FONT FACE="Courier New, monospace">c:\bbs\binkd\binkd9x
-u<BR>binkd9x -u -S binkd</FONT></P>
<H2>5.17. -v (строчная буква &laquo;v&raquo;).</H2>
<P><FONT FACE="Courier New, monospace">Binkd</FONT>, вызванный с
опцией &laquo;-v&raquo;, выведет на экран информацию о версии, затем
завершит работу.</P>
<P>Если опция &laquo;<FONT FACE="Courier New, monospace">-v</FONT>&raquo;
указана трижды либо указана в виде &laquo;<FONT FACE="Courier New, monospace">-vvv</FONT>&raquo;,
либо &laquo;<FONT FACE="Courier New, monospace">-vv -v</FONT>&raquo;
и после неё указан файл конфигурации, binkd выведет прочитанную и
обработанную им конфигурацию на экран и продолжит работу. (Тройная
&laquo;<FONT FACE="Courier New, monospace">v</FONT>&raquo; в списке
опций эквивалентна указанию директивы &laquo;<FONT FACE="Courier New, monospace">debugcfg</FONT>&raquo;
в файле конфигурации.) Такое поведение <FONT FACE="Courier New, monospace">binkd</FONT>
считается устаревшим и в версиях 1.x будет изменено.</P>
<P>При использовании одиночной опции &laquo;<FONT FACE="Courier New, monospace">-h</FONT>&raquo;
файл конфигурации в командной строке указывать не обязательно.</P>
<P>Примеры:</P>
<P><FONT FACE="Courier New, monospace">binkd -v<BR>binkd -vvv
binkd.cfg<BR>binkd -v -v -v binkd.cfg</FONT><BR><FONT FACE="Courier New, monospace">binkd
-vv -v binkd.cfg</FONT></P>
<H1>6. Описание работы binkd.</H1>
<P>При запуске <FONT FACE="Courier New, monospace">binkd</FONT>
анализирует переданные ему параметры, читает файл конфигурации и
затем запускает серверную часть (если она не запрещена в
конфигурационном файле или опциями командной строки) и следом &ndash;
клиентскую часть (опять же если она не запрещена).</P>
<P>Во время анализа параметров и файла конфигурации binkd может
обнаружить ошибки (неверно указанный параметр, опечатки в файле
конфигурации и т.п.). В таких ситуациях <FONT FACE="Courier New, monospace">binkd</FONT>
выводит диагностические сообщения на экран (точнее, в &laquo;стандартный
поток ошибок&raquo;, а в windows в некоторых случаях и в окно типа
&laquo;alert&raquo; на экран консоли компьютера).</P>
<P>В случае успешного чтения файла конфигурации binkd инициализирует
серверный и клиентский процессы (потоки в многопоточных ОС).
Разумеется, соответствующий процесс (поток) инициализируется только
тогда, когда он не запрещён опциями &laquo;<FONT FACE="Courier New, monospace">-c</FONT>&raquo;,
&laquo;<FONT FACE="Courier New, monospace">-s</FONT>&raquo; и
директивами файла конфигурации &laquo;<FONT FACE="Courier New, monospace">maxservers</FONT>&raquo;,
&laquo;<FONT FACE="Courier New, monospace">maxclients</FONT>&raquo;:
указание в командной строке одной опции &laquo;<FONT FACE="Courier New, monospace">-c</FONT>&raquo;
без опции &laquo;<FONT FACE="Courier New, monospace">-s</FONT>&raquo;
либо указание в файле конфигурации &laquo;<FONT FACE="Courier New, monospace">maxservers
0</FONT>&raquo; запрещает запуск серверного процесса; указание в
командной строке одной опции &laquo;<FONT FACE="Courier New, monospace">-s</FONT>&raquo;
без опции &laquo;-c&raquo; либо указание в файле конфигурации
&laquo;<FONT FACE="Courier New, monospace">maxclients 0</FONT>&raquo;
запрещает запуск клиентского процесса. Учтите, что опция &laquo;<FONT FACE="Courier New, monospace">-p</FONT>&raquo;
подразумевает также и действие опции &laquo;-c&raquo;. В случае
использования опции &laquo;<FONT FACE="Courier New, monospace">-p</FONT>&raquo;
<FONT FACE="Courier New, monospace">binkd</FONT> инициирует
клиентский процесс, который при обнаружении пустой очереди завершает
работу <FONT FACE="Courier New, monospace">binkd</FONT>. Эта
возможность используется для осуществления разового вызова линка(ов),
часто совместно с опцией &laquo;<FONT FACE="Courier New, monospace">-P&lt;address&gt;</FONT>&raquo;.</P>
<P>В случае работы и клиентской, и серверной части <FONT FACE="Courier New, monospace">binkd</FONT>
взаимодействие клиентского и серверного процесса осуществляется со
стороны серверного процесса, поскольку он является &laquo;родителем&raquo;
по отношению к клиентскому процессу. Также в этом случае серверный
процесс управляет обработкой сигналов, перезапуском (при изменении
конфигурационного файла либо по сигналу) и завершением работы <FONT FACE="Courier New, monospace">binkd</FONT>.
Если же серверная часть <FONT FACE="Courier New, monospace">binkd</FONT>
запрещена, обработкой сигналов занимается основной клиентский
процесс.</P>
<P>При инициации сеанса связи (как входящего, так и исходящего) <FONT FACE="Courier New, monospace">binkd</FONT>
создаёт специальный процесс (поток) для его обработки. Таким образом
многозадачные возможности ОС используются для упрощения кода. Этот
подход накладывает ограничение в один сеанс связи для <FONT FACE="Courier New, monospace">binkd</FONT>
в однозадачных ОС (например, в DOS).</P>
<H2>6.1. Протоколирование.</H2>
<P>В процессе работы <FONT FACE="Courier New, monospace">binkd</FONT>
может сообщать информацию о проводимых действиях и их результатах
путём вывода информационных сообщений на экран (консоль) и в файл
протокола (log-файл). Вывод информации на экран регулируется опцией
&laquo;<FONT FACE="Courier New, monospace">-q</FONT>&raquo; и
параметрами файла конфигурации &laquo;<FONT FACE="Courier New, monospace">conlog</FONT>&raquo;
и &laquo;<FONT FACE="Courier New, monospace">printq</FONT>&raquo;.
Протоколирование в файл определяется параметрами файла конфигурации
&laquo;<FONT FACE="Courier New, monospace">log</FONT>&raquo; и
&laquo;<FONT FACE="Courier New, monospace">loglevel</FONT>&raquo;,
также в ОС семейства Unix может использвоаться вывод сообщений в
системную службу <FONT FACE="Courier New, monospace">syslog</FONT>,
что задаётся параметром.файла конфигурации &laquo;<FONT FACE="Courier New, monospace">syslog</FONT>&raquo;.</P>
<P>Для обычной работы уровень протоколирования устанавливается в
значение от 0 до 4 (значение&nbsp;4 предлагается в примере файла
конфигурации, поставляемом в дистрибутиве <FONT FACE="Courier New, monospace">binkd</FONT>).
Уровни 5 и 6 используются для выяснения неполадок с файлами в очереди
(уровень&nbsp;5) и для выявления ошибок в соединении с удалённым
узлом (уровень&nbsp;6). Уровни более 6 используются для отладки и
рекомендуются разработчиками для использования в отчётах об
обнаруженных ошибках в программе.</P>
<H2>6.2. Исходящие соединения (binkd-client).</H2>
<P>Как указано выше, для каждого исходящего сеанса связи создаётся
свой процесс (поток). Этот процесс определяет адрес IP линка из DNS
или файла конфигурации, осуществляет попытку соединения с линком, в
случае неудачи повторяет попытку заданное в директиве try число раз,
а в случае удачи проводит сеанс связи, затем записывает результат
работы в файл <FONT FACE="Courier New, monospace">*.try</FONT> в
каталоге почтовой очереди и завершается с кодом возврата, сообщающим
об успешной работе (код 0) или об ошибке.
</P>
<P>Работой клиентской части <FONT FACE="Courier New, monospace">binkd</FONT>
управляет так называемый &laquo;менеджер клиентов&raquo; (client
manager). Это подпрограмма, которая производит периодический просмотр
каталогов почтовой очереди и всех файл-боксов, и запускает процесс
(поток) для установления соединения и отправки почты при наличии
&laquo;активной&raquo; почты (т.е. почты, требующей отправки в
настоящий момент времени).</P>
<P>Соединение инициируется (т.е. запускается соответствующий
клиентский процесс или поток) при наличии почты с атрибутами
&laquo;normal&raquo;, &laquo;<FONT FACE="Courier New, monospace">direct</FONT>&raquo;,
&laquo;<FONT FACE="Courier New, monospace">crash</FONT>&raquo;,
&laquo;<FONT FACE="Courier New, monospace">immediate</FONT>&raquo; и
не инициируется при наличии почты с атрибутом &laquo;<FONT FACE="Courier New, monospace">hold</FONT>&raquo;,
исходящими FREQ (файлами <FONT FACE="Courier New, monospace">*.req</FONT>)
и файлами в файлбоксах.</P>
<H3>6.2.1. Алгоритм работы менеджера клиентов.</H3>
<P>Рассмотрим подробно работу менеджера клиентов.</P>
<P>Сразу же после запуска менеджера клиентов он просматривает
(сканирует) почтовую очередь: каталоги почтовой очереди (outbound), и
файл-боксы &ndash; как объявленные в файле конфигурации файл-боксы
стилей мейлеров &laquo;<FONT FACE="Courier New, monospace">T-mail</FONT>&raquo;
и &laquo;<FONT FACE="Courier New, monospace">The Brake!</FONT>&raquo;,
так и описанные в директивах &laquo;node&raquo; персональные
файл-боксы линков. В случае наличия &laquo;активной&raquo; почты (см.
п. 6.1) для линка, отсутсвии с ним активного соединения и при
известном адресе IP либо доменном имени этого линка менеджер клиентов
запускает процедуру инициирования соединения, для сего создаёт
процесс (поток), который работает с этим линком. Так происходит до
того момента, пока число запущенных клиентских процессов (потоков) не
достигло значения директивы &laquo;maxclients&raquo; файла
конфигурации либо почтовая очередь не исчерпается. В случае
достижения предела &laquo;maxclients&raquo; менеджер клиентов делает
паузу длительностью &laquo;call-delay&raquo; и затем повторяет
проверку числа запущенных клиентских процессов. По исчерпании
почтовой очереди менеджер клиентов делает паузу длительностью
&laquo;rescan-delay&raquo;. После сканирования почтовой очереди, если
она пуста, нет активных сеансов связи и binkd запущен с опцией &laquo;-P&raquo;,
менеджер клиентов завершает работу binkd. Формально алгоритм описан в
таблице 6.2.1.</P>
<TABLE WIDTH=100% BORDER=1 CELLPADDING=4 CELLSPACING=0>
	<COL WIDTH=15*>
	<COL WIDTH=215*>
	<COL WIDTH=26*>
	<THEAD>
		<TR>
			<TH COLSPAN=3 WIDTH=100% VALIGN=TOP>
				<P ALIGN=LEFT>Таблица 6.2.1</P>
			</TH>
		</TR>
	</THEAD>
	<TBODY>
		<TR VALIGN=TOP>
			<TH WIDTH=6%>
				<P>?</P>
			</TH>
			<TH WIDTH=84%>
				<P>Действие</P>
			</TH>
			<TH WIDTH=10%>
				<P>Следующий</P>
			</TH>
		</TR>
		<TR>
			<TD WIDTH=6% VALIGN=BOTTOM SDVAL="1" SDNUM="1049;">
				<P ALIGN=CENTER>1</P>
			</TD>
			<TD WIDTH=84% VALIGN=TOP>
				<P>Инициализация.</P>
			</TD>
			<TD WIDTH=10% VALIGN=BOTTOM SDVAL="2" SDNUM="1049;">
				<P ALIGN=CENTER>2</P>
			</TD>
		</TR>
		<TR>
			<TD WIDTH=6% VALIGN=BOTTOM SDVAL="2" SDNUM="1049;">
				<P ALIGN=CENTER>2</P>
			</TD>
			<TD WIDTH=84% VALIGN=TOP>
				<P>Сканирование почтовой очереди и составление списка линков, для
				которых имеется почта.</P>
			</TD>
			<TD WIDTH=10% VALIGN=BOTTOM SDVAL="3" SDNUM="1049;">
				<P ALIGN=CENTER>3</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=6% SDVAL="3" SDNUM="1049;">
				<P ALIGN=CENTER>3</P>
			</TD>
			<TD WIDTH=84%>
				<P>Очередь пуста?</P>
			</TD>
			<TD WIDTH=10%>
				<P ALIGN=CENTER>Да: 9.<BR>Нет: 4.</P>
			</TD>
		</TR>
		<TR>
			<TD WIDTH=6% VALIGN=TOP SDVAL="4" SDNUM="1049;">
				<P ALIGN=CENTER>4</P>
			</TD>
			<TD WIDTH=84% VALIGN=TOP>
				<P>Выбор очередного линка из очереди.</P>
			</TD>
			<TD WIDTH=10% VALIGN=BOTTOM SDVAL="5" SDNUM="1049;">
				<P ALIGN=CENTER>5</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=6% SDVAL="5" SDNUM="1049;">
				<P ALIGN=CENTER>5</P>
			</TD>
			<TD WIDTH=84%>
				<P>Почта на линка &laquo;активна&raquo;? (почта с атрибутами
				&laquo;normal&raquo;, &laquo;direct&raquo;, &laquo;crash&raquo;,
				&laquo;immediate&raquo;; нет файла *.hld для линка или время,
				указанное в файле *.hld, уже прошло, список интернет-адресов
				линка непустой)</P>
			</TD>
			<TD WIDTH=10%>
				<P ALIGN=CENTER>Да: 6.<BR>Нет: 4.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=6% SDVAL="6" SDNUM="1049;">
				<P ALIGN=CENTER>6</P>
			</TD>
			<TD WIDTH=84%>
				<P>Число запущенных клиентских процессов (потоков) меньше
				&laquo;maxclients&raquo;?</P>
			</TD>
			<TD WIDTH=10%>
				<P ALIGN=CENTER>Да: 8.<BR>Нет: 7.</P>
			</TD>
		</TR>
		<TR>
			<TD WIDTH=6% VALIGN=TOP SDVAL="7" SDNUM="1049;">
				<P ALIGN=CENTER>7</P>
			</TD>
			<TD WIDTH=84% VALIGN=TOP>
				<P>Пауза на время &laquo;call-delay&raquo;</P>
			</TD>
			<TD WIDTH=10% VALIGN=BOTTOM SDVAL="6" SDNUM="1049;">
				<P ALIGN=CENTER>6</P>
			</TD>
		</TR>
		<TR>
			<TD WIDTH=6% VALIGN=TOP SDVAL="8" SDNUM="1049;">
				<P ALIGN=CENTER>8</P>
			</TD>
			<TD WIDTH=84% VALIGN=TOP>
				<P>Запуск клиентского процесса (потока) для линка.</P>
			</TD>
			<TD WIDTH=10% VALIGN=BOTTOM SDVAL="4" SDNUM="1049;">
				<P ALIGN=CENTER>4</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=6% SDVAL="9" SDNUM="1049;">
				<P ALIGN=CENTER>9</P>
			</TD>
			<TD WIDTH=84%>
				<P>Binkd запущен с опцией &laquo;-p&raquo; и число запущенных
				клиентских процессов = 0?</P>
			</TD>
			<TD WIDTH=10%>
				<P ALIGN=CENTER>Да: 11.<BR>Нет: 10.</P>
			</TD>
		</TR>
		<TR>
			<TD WIDTH=6% VALIGN=TOP SDVAL="10" SDNUM="1049;">
				<P ALIGN=CENTER>10</P>
			</TD>
			<TD WIDTH=84% VALIGN=TOP>
				<P>Пауза на время &laquo;rescan-delay&raquo;</P>
			</TD>
			<TD WIDTH=10% VALIGN=BOTTOM SDVAL="2" SDNUM="1049;">
				<P ALIGN=CENTER>2</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=6% SDVAL="11" SDNUM="1049;">
				<P ALIGN=CENTER>11</P>
			</TD>
			<TD WIDTH=84%>
				<P>Завершение.</P>
			</TD>
			<TD WIDTH=10%>
				<P ALIGN=CENTER><BR>
				</P>
			</TD>
		</TR>
	</TBODY>
</TABLE>
<P><BR><BR>
</P>
<H3>6.2.2. Описание работы клиентского процесса.</H3>
<P>Рассмотрим подробно работу клиентского процесса: процесса (или
потока в многопоточных вариантах binkd), который осуществляет
соединение с удалённым узлом и проводит сеанс связи.</P>
<P>Клиентский процесс стартует из менеджера клиентов после
формирования непустой очереди файлов, предназначенных некоторому
линку. При вызове клиентский процесс получает параметры линка и
список файлов на отправку, выбранный из почтовой очереди.</P>
<P>Клиентский процесс после старта выбирает первое доменное имя или
адрес IP линка из указанных в директиве файла конфигурации <FONT FACE="Courier New, monospace">node</FONT>
либо, в случае её отсутсвия, <FONT FACE="Courier New, monospace">defnode</FONT>.
(Если указанн символ &laquo;*&raquo;, ещё до вызова клиентского
процесса проводится преобразование к виду
pNN.fNNN.nNNNN.zN.fidonet.net согласно FSP-1026 (вместо fidonet.net
может быть указан другой корневой домен). В том случае, если
выбранный адрес internet представляет собой доменное имя,
производится запрос к ОС о разрешении имени в адрес IP. В случае
отсутствия адреса IP у указанного доменного имени работа производится
выборка следующего интернет-адреса линка. Когда все интернет-адреса
линка заканчиваются, клиентский процесс завершается.</P>
<P>После определения адреса IP линка производится попытка
установления соединения TCP. В случае указания специфичного для линка
порта TCP производится соединение с указанным портом, по умолчанию же
используется порт 24554. Перед попыткой установить соединение TCP
выставляется таймер, указанный в директиве файла конфигурации
&laquo;<FONT FACE="Courier New, monospace">connect-timeout</FONT>&raquo;
(если эта директива присутствует в конфигурации binkd) и случае
отсутствия ответа TCP от хоста линка по истечении указанного времени
процедура установки соединения прерывается.</P>
<P>В случае установления соединения TCP проверяется предъявленный
удалённым узлом адрес и поддерживаемые им версии и расширения
протокола binkp, также отсылается собственная такая информация. В
случае совпадения одного из предъявленных удалённой стороной адреса
FTN с вызываемым адресом проводится процедура аутентификации на
удалённом узле (отправляется пароль или дайджест пароля &ndash; в
зависимости от запрошенного удалённой стороной способа
аутентификации). В случае успешной аутентификации проводится обмен
файлами.</P>
<P>В случае работы по протоколу binkp 1.1 по завершении процедуры
обмена файлами проводится повторное сканирование почтовой очереди и
формирование файлов для отправки. Если новых файлов нет ни с нашей,
ни с удалённой стороны &ndash; сеанс завершается.</P>
<H3>6.2.3. Однократно забрать и отослать почту.</H3>
<P>Осуществить одиночный вызов основного линка &ndash; типичная
задача оконечного пользователя (point, пойнт) сети FIDOnet (или
другой сети, построенной по технологии FTN). В binkd для этого
предуспотрен специальный режим работы, задаваемый опциями командной
строки &laquo;-p&raquo; и &laquo;-P&raquo;. Опция &laquo;-P&raquo;
для создания в почтовой очереди пустого файла, инициирущего
соединение, а опция &laquo;-p&raquo; используется для запуска
клиентской части binkd и завершения работы после осуществления сеанса
связи (либо исчерпания числа попыток соединиться). Эти опции можно
использовать и по отдельности, но надо учитывать, что указание опции
&laquo;-P&raquo; без опции &laquo;-p&raquo; разрешает работу
серверной части binkd и по завершении всех соединений binkd не будет
самостоятельно завершаться. Поэтому использование опции &laquo;-P&raquo;
без опции &laquo;-p&raquo; малоприменимо. Если же опция &laquo;-p&raquo;
используется без опции &laquo;-P&raquo;, binkd завершится сразу в том
случае, когда очередь на отправку пуста и осуществит вызов если в
очереди имеются файлы. Это может использоваться, например, для
отправки исходящей почты в том случае, когда держать binkd постоянно
работающим нецелесообразно (например, в случае комутируемого
сеансового подключения к Internet).</P>
<P>Пример вызова узла <FONT FACE="Courier New, monospace">3:712/848@fidonet</FONT>:</P>
<P><FONT FACE="Courier New, monospace">binkd -P 3:712/848@fidonet -p
binkd.cfg</FONT></P>
<P>Однократный вызов можно использовать для осуществления вызовов
любого количества линков, для чего на каждого из них должны быть
файлы в очереди на отправку (или для каждого нужно указать опцию &laquo;-P&raquo;
его адресом). Более того, в случае непустой очереди binkd будет
пытаться установить соединение со всеми известными ему линками, для
которых имеется почта.</P>
<P>На работу binkd в режиме однократного вызова непосредственно
влияют директивы файла конфигурации: <FONT FACE="Courier New, monospace">rescan-delay</FONT>,
<FONT FACE="Courier New, monospace">try</FONT>, <FONT FACE="Courier New, monospace">maxclients</FONT>,
также может повлиять директива <FONT FACE="Courier New, monospace">call-delay</FONT>
(в случае, когда число линков в очереди больше числа <FONT FACE="Courier New, monospace">maxclients</FONT>)
и в некоторых ситуациях могут влиять директивы <FONT FACE="Courier New, monospace">defnode</FONT>
<FONT FACE="Times New Roman, serif">и </FONT><FONT FACE="Courier New, monospace">connect-timeout</FONT>.</P>
<P>Директива <FONT FACE="Courier New, monospace">rescan-delay</FONT>
своим побочным действием задает паузу перед тем, как <FONT FACE="Courier New, monospace">binkd</FONT>
завершит работу. В случае недоступности какого-либо линка директива
<FONT FACE="Courier New, monospace">connect-timeout</FONT> имеет
значение, если она меньше таймаута TCP сетевого драйвера операционной
системы. Директива <FONT FACE="Courier New, monospace">try</FONT> в
случае недоступности линка и при отсутствии ответа на запрос
установления соединения TCP также может внести задержку на время
<FONT FACE="Courier New, monospace">try</FONT>*&lt;таймаут
установления сеанса TCP&gt; (таймаут во многих ОС равен минуте) либо
на время <FONT FACE="Courier New, monospace">try<FONT FACE="Times New Roman, serif">*</FONT>connect-timeout</FONT>
<FONT FACE="Times New Roman, serif">(в зависимости от того, какой
таймаут меньше).</FONT></P>
<P>В случае указания в директиве <FONT FACE="Courier New, monospace">defnode</FONT>
звёздочки в поле адреса IP <FONT FACE="Courier New, monospace">binkd</FONT>
будет также пытаться отправить почту на необъявленные явно в файле
конфигурации адреса (если какая-либо почта имеется в почтовой
очереди).</P>
<H3>6.2.3. Постоянно работающий binkd-client.</H3>
<P>В случае, когда у пойнта сети <FONT FACE="Courier New, monospace">FIDOnet</FONT>
(или другой FTN-совместимой сети) имеется постоянно включенный
компьютера с выходом в internet, сисоп может использовать <FONT FACE="Courier New, monospace">binkd</FONT>
работающим постоянно. При этом <FONT FACE="Courier New, monospace">binkd</FONT>
будет осуществлять вызов после того, как в его почтовой очереди
окажется что-то требующее отправки. Проверка почтовой очереди
проводится с периодом, указанным в директиве &laquo;<FONT FACE="Courier New, monospace">rescan-delay</FONT>&raquo;
(в секундах). (Не забывайте, речь идёт о пойнте, которому
необязательно принимать входящие соединения, а иногда он и не имеет
такой возможности, например, в случае, когда компьютер не имеет
публичного IP адреса и используется NAT - Network Address
Translation).
</P>
<P>Для работы в режиме клиента используется опция командной строки
&laquo;<FONT FACE="Courier New, monospace">-c</FONT>&raquo; без
указания опции &laquo;<FONT FACE="Courier New, monospace">-s</FONT>&raquo;.
В ОС семейства <FONT FACE="Courier New, monospace">UNIX</FONT> в
случае работы <FONT FACE="Courier New, monospace">binkd</FONT> в
фоновом режиме (т.н. режиме демона) используется также опция &laquo;<FONT FACE="Courier New, monospace">-D</FONT>&raquo;,
при этом <FONT FACE="Courier New, monospace">binkd</FONT> после
инициализации отсоединяется от консоли и работает без вывода
информации на экран. В 32-х битных версиях ОС <FONT FACE="Courier New, monospace">Windows</FONT>
при использовании опции &laquo;<FONT FACE="Courier New, monospace">-T</FONT>&raquo;
окно <FONT FACE="Courier New, monospace">binkd</FONT> может быть
спрятано, при этом в системный трэй помещается оригинальная иконка.
Также в ОС Windows 95 (98, Me) можно использвоать специальную версию
binkd/w9x, которая всегда работает в фоновом режиме и предназначена
для использования в качестве &laquo;сервиса&raquo; Windows 9x, а в ОС
Windows NT (2000, XP, 2003) можно установить binkd в качестве
системного сервиса с помощью опций &laquo;<FONT FACE="Courier New, monospace">-i</FONT>&raquo;
и &laquo;<FONT FACE="Courier New, monospace">-S</FONT>&raquo;
(подробнее см. описания этих опций).</P>
<P>Пример простого запуска binkd в качестве клиента:</P>
<P><FONT FACE="Courier New, monospace">binkd -с binkd.cfg</FONT></P>
<P>Пример запуска binkd в качестве клиента в режиме демона (в ОС
семейства UNIX):</P>
<P><FONT FACE="Courier New, monospace">/usr/local/sbin/binkd -сD
/usr/local/etc/binkd/binkd.conf</FONT></P>
<P>Пример запуска binkd в качестве клиента свёрнутым в системный трэй
в Windows:</P>
<P><FONT FACE="Courier New, monospace">start /min binkd.exe -сT
binkd.cfg</FONT></P>
<P>Примеры установки и запуска binkd-клиента сервисом Windows NT (с
именем сервиса по умолчанию и с указанием имени):</P>
<P><FONT FACE="Courier New, monospace">binkd.exe -сi binkd.cfg</FONT></P>
<P><FONT FACE="Courier New, monospace">binkd.exe -сi -S <FONT FACE="a_Decart(ANS-CrOy), monospace">&quot;<FONT FACE="Courier New, monospace">binkd
client</FONT>&quot;</FONT> binkd.cfg</FONT></P>
<P>Примеры установки и запуска binkd-клиента сервисом Windows 9x, (с
именем сервиса по умолчанию и с указанием имени):</P>
<P><FONT FACE="Courier New, monospace">binkd9x.exe -сi binkd.cfg</FONT></P>
<P><FONT FACE="Courier New, monospace">binkd9x.exe -сi -S <FONT FACE="a_Decart(ANS-CrOy), monospace">&quot;<FONT FACE="Courier New, monospace">client
only binkd</FONT>&quot;</FONT> binkd.cfg</FONT></P>
<H2>6.3. Входящее соединение (binkd-server).</H2>
<P>Binkd, работающий в режиме сервера (binkd-сервер), только ждёт и
обрабатывает входящие соединения, сам же не инициирует соединения с
другими узлами. Для каждого входящего соединения создаётся отдельный
процесс (поток в многопоточных ОС). Созданием и управлением
серверными потоками занимается специальный процесс - &laquo;менеджер
сервера&raquo;.</P>
<H3>6.3.1. Алгоритм работы менеджера сервера.</H3>
<P>Менеджер сервера открывает сокет типа TCP и ждёт соединения от
удалённого узла. При установлении входящего соединения TCP менеджер
сервера создаёт новый процесс (поток в многопоточных ОС), который
обрабатывает это соединение. Менеджер сервера отслеживает количество
одновременно работающих серверным процессов (потоков).</P>
<P>Другая задача менеджера сервера &ndash; отслеживать изменение
файла конфигурации. Реакция на изменение файла конфига зависит от
операционной системы и от компилятора. В ОС семейсва UNIX
инициируется перезапуск binkd, в ОС Windows и в однозадачных ОС binkd
завершается с кодом возврата 3. (В следующих версиях это будет
изменено, будьте внимательны.)</P>
<H3>6.3.2. Алгоритм работы серверного процесса.</H3>
<P>После запуска серверный процесс проверяет число работающих
&laquo;коллег&raquo; и случае превышения лимита, заданного в
директиве &laquo;maxservers&raquo; файла конфигурации, новое входящее
соединение завершается, при этом удалённый узел получает сообщение
протокола binkp &laquo;M_BSY Too many servers&raquo;.</P>
<P>Следом проводится анализ информации, полученной от удалённой
стороны: адреса FTN, подерживаемые версии и расширения протокола
binkp. Далее такая информация о себе отсылается для удалённой
стороны.</P>
<P>Затем проводится парольная аутентификация вызвавшей стороны
(удалённого клиента), и в случае успешной проверки пароля,
производится проверка файлов-флагов занятости адресов, предъявленных
удалённой стороной (файлов *.BSY). Если для каких-то адресов
файлы-флаги занятости существуют, эти адреса исключаются из списка.
</P>
<P>Далее формируется список файлов на отправку и производится обмен
файлами.</P>
<P>В случае работы по протоколу binkp 1.1 по завершении процедуры
обмена файлами проводится повторное сканирование почтовой очереди и
формирование файлов для отправки. Если новых файлов нет ни с нашей,
ни с удалённой стороны &ndash; сеанс завершается.</P>
<H3>6.3.3. Интерактивная работа binkd-сервер.</H3>
<P>Для работы в режиме сервера используется опция командной строки
&laquo;<FONT FACE="Courier New, monospace">-s</FONT>&raquo; без
указания опции &laquo;<FONT FACE="Courier New, monospace">-c</FONT>&raquo;.
При этом binkd выводит информационные сообщения на свою консоль, в
зависимотси от директив файла конфигурации &laquo;conlog&raquo;,
&laquo;printq&raquo; и &laquo;loglevel&raquo;. Вывод информации на
консоль запрещает опция командной строки &laquo;-q&raquo;. В любом
случае на консоль выводятся сообщения об ошибках в командной строке,
о невозможности загрузить файл конфигурации и об ошибках в нём. В
32-х битных версиях ОС <FONT FACE="Courier New, monospace">Windows</FONT>
при использовании опции &laquo;<FONT FACE="Courier New, monospace">-T</FONT>&raquo;
окно <FONT FACE="Courier New, monospace">binkd</FONT> может быть
спрятано, при этом в системный трэй помещается оригинальная иконка.</P>
<P>Примеры запуска binkd в режиме &laquo;только сервер&raquo;:</P>
<P><FONT FACE="Courier New, monospace">binkd -s binkd.cfg</FONT></P>
<P><FONT FACE="Courier New, monospace">binkd.exe -sT binkd.cfg</FONT></P>
<H3>6.3.4. Работа binkd-сервер системной службой.</H3>
<P>В случае необходимости постоянной работы binkd в качестве сервера,
имеет смысл запускать его как системную службу. В ОС, основанных на
UNIX, системные службы называются &laquo;демонами&raquo; (&laquo;daemons&raquo;),
в ОС Windows - &laquo;сервисами&raquo; или &laquo;службами&raquo;
(&laquo;services&raquo;).</P>
<P>Пример запуска binkd-сервер в режиме демона: в UNIX:</P>
<P><FONT FACE="Courier New, monospace">/usr/local/sbin/binkd -Dqs
/usr/local/etc/fido/binkd.conf</FONT></P>
<P>Пример установки и запуска binkd сервисом Windows:</P>
<P><FONT FACE="Courier New, monospace">binkd.exe -i binkd.cfg</FONT></P>
<P>Пример остановки и удаления сервиса binkd в Windows:</P>
<P><FONT FACE="Courier New, monospace">binkd.exe -u</FONT></P>
<P>Подробности о таком использовании binkd см. в разделе 6.4.1.</P>
<H3>6.3.5. Работа binkd-сервер под управлением inetd.</H3>
<P>В некоторых операционных системах возможна автоматическая работа
binkd в режиме сервера под управлением inetd. При этом служба inetd
&laquo;слушает&raquo; назначенный для binkd порт и запускает binkd
после установления соединения TCP. В таком режиме binkd обменивается
данными с удалённым узлом через свои стандартный входной и выходной
потоки (stdin и stdout в терминах языка программирования С). Связь
между этими потоками и сокетом TCP устанавливает inetd. Работа такой
связки в некоторых ситуациях экономит используемую оперативную память
и процессорное время, поскольку binkd запускается только на время
входящего сеанса связи.</P>
<P>Для работы совместно с inetd у binkd, скомпилированного для OS/2,
Amiga или ОС семейства UNIX, предусмотрена опция командной строки
&laquo;-i&raquo;. При этом, чтобы не смешивать передаваемые данные и
информационные сообщения binkd, требуется указывать также опцию &laquo;-q&raquo;
либо запрещать вывод информации на консоль в файле конфигурации binkd
(закомментировать директивы &laquo;conlog&raquo; и &laquo;printq&raquo;).</P>
<P>Начинающие часто делают ошибку, забывая, что в файле конфигурации
inetd необходимо первым параметром указывать имя программы.</P>
<P>Пример строки запуска binkd в файле конфигурации inetd
(inetd.conf) для ОС семейства unix:</P>
<P><FONT FACE="Courier New, monospace">binkp stream tcp nowait root
/usr/local/sbin/binkd binkd -isq /usr/local/etc/fido/binkd.conf</FONT></P>
<P>При этом в списке возможных портов (файл /etc/services) должна
быть запись о протоколе binkp:</P>
<P><FONT FACE="Courier New, monospace">binkp 24554/TCP</FONT></P>
<H2>6.4. Универсальный режим работы binkd: сервер+клиент.</H2>
<P>Типичным применением binkd на узле FIDOnet является его
комбинирванное использование в качестве как клиента, так и сервера.
Такой режим работы в binkd сделан по умолчанию (т.е. при отсутсвии
каких-либо опций командной строки).</P>
<P>В комбинированном режиме менеджер сервера кроме обслуживания
серверной части binkd, выполняет также функции общего управления:
отслеживает изменения файла конфигурации, обрабатывает сигналы ОС. В
остальном работа менеджера сервера и менеджера клиентов binkd
особенностей не имеет.</P>
<P>Примеры запуска binkd в универсальном режиме (первый пример &ndash;
обычный запуск, второй пример &ndash; запуск в Windows с возможостью
скрытия окна binkd в системный трэй):</P>
<P><FONT FACE="Courier New, monospace">binkd binkd.cfg</FONT></P>
<P><FONT FACE="Courier New, monospace">binkd.exe -T binkd.cfg</FONT></P>
<H3>6.4.1. Работа binkd без участия пользователя.</H3>
<P>В случае необходимости постоянной работы binkd в качестве сервера,
имеет смысл запускать его как системную службу. В ОС, основанных на
UNIX, системные службы называются &laquo;демонами&raquo; (&laquo;daemons&raquo;),
в ОС Windows - &laquo;сервисами&raquo; или &laquo;службами&raquo;
(&laquo;services&raquo;). В других операционных системах работа binkd
в качестве системной службы предусмотрена только под управлением
inetd (см. п.6.3.5), в ОС семейства UNIX работа binkd под управлением
inetd также возможна.</P>
<H3>6.4.1.1. Сервис в Windows.</H3>
<P>В случае необходимости постоянной работы binkd в качестве сервера,
имеет смысл запускать его как системную службу. В Windows это
реализуется путём установки binkd системным сервисом с использованием
опций командной строки &laquo;-i&raquo; и &laquo;-S&raquo;.</P>
<P>В Windows NT, Windows 2000 м более поздних версиях линейки NT
сервис binkd по умолчанию выводит своё консольное окно на экран после
того, как пользователь залогинится в систему. Убрать его с экрана
можно двумя способами. Первый способ: указать при установке binkd
сервисом опцию командной строки &laquo;-T&raquo;, и при появлении
окна bikd свернуть его в системный трэй кнопкой минимизации окна.
Второй способ &ndash; изменить настройки системного сервиса, сняв
пометку &laquo;разрешить взаимодействие с рабочим столом&raquo;, в
этом случае имеет смысл запретить binkd выводить информацию на
консоль (указать опцию командной строки &laquo;-q&raquo; при
установке сервиса либо закомментировать директивы &laquo;conlog&raquo;
и &laquo;printq&raquo; в файле конфигурации).</P>
<P>В Windows 95, Windows 98 и Windows Me из-за особенностей
реализации текстовой консоли в этих версиях ОС приходится
использовать специальный вариант исполняемого файла: binkd9x.exe,
который работает без постоянной консоли (создаёт консоль только в
необходимых случаях на небольшое время). Идентифицировать этот
вариант binkd можно по наличию подстроки Win9x в информационном
сообщении, выводимым binkd при указании опции командной строки &laquo;-v&raquo;,
например:</P>
<P><FONT FACE="Courier New, monospace">Binkd 1.0a-499 (Dec 20 2006
01:12:53/Win9x)<BR>Press any key...</FONT></P>
<P>Использование binkd/win9x без установки его сервисом в Windows 95
(98, Me) возможно, но в этом случае он работает исключительно в
фоновом режиме подобно демону в UNIX.</P>
<P>В целях улучшения безопасности использования binkd в режиме
сервиса в Windows NT (2000, XP, 2003) имеет смысл назначить ему для
работы отдельного пользователя, которому разрешить доступ только к
нужным файлам и каталогам.</P>
<P>Пример установки и запуска binkd сервисом Windows с именем по
умолчанию (&laquo;binkd-service&raquo;):</P>
<P><FONT FACE="Courier New, monospace">binkd.exe -i binkd.cfg</FONT></P>
<P>Пример установки и запуска binkd сервисом Windows с именем
&laquo;Universal binkd&raquo; с возможностью скрытия окна в системный
трэй:</P>
<P><FONT FACE="Courier New, monospace">binkd.exe -iTS <FONT FACE="a_Decart(ANS-CrOy), monospace">&quot;</FONT>Universal
binkd<FONT FACE="a_Decart(ANS-CrOy), monospace">&quot;</FONT>
binkd.cfg</FONT></P>
<P>Пример остановки и удаления сервиса Windows с именем &laquo;Universal
binkd&raquo;:</P>
<P><FONT FACE="Courier New, monospace">binkd.exe -uS <FONT FACE="a_Decart(ANS-CrOy), monospace">&quot;</FONT>Universal
binkd<FONT FACE="a_Decart(ANS-CrOy), monospace">&quot;</FONT></FONT></P>
<P>Пример остановки и удаления сервиса Windows с именем
&laquo;binkd-service&raquo; (имя сервиса binkd по умолчанию):</P>
<P><FONT FACE="Courier New, monospace">binkd.exe -u</FONT></P>
<H3>6.4.1.2. Демон в unix.</H3>
<P>В ОС, основанных на UNIX, системные службы называются &laquo;демонами&raquo;
(&laquo;daemons&raquo;) и для запуска binkd в качестве демона
используется опция командной строки &laquo;-D&raquo;. При
использовании этой опции binkd отсоединяется от консоли и работает в
фоновом режиме. Поскольку связь с консолью у демона отсутствует, вся
информация, которая в интерактивном режиме выводится на экран, уходит
в &laquo;никуда&raquo; и имеет смысл совместно с опцией &laquo;-D&raquo;
указывать опцию &laquo;-q&raquo; либо запрещать вывод на экран в
файле конфигурации, для чего закомментировать директивы &laquo;conlog&raquo;
и &laquo;printq&raquo;.</P>
<P>Пример запуска binkd-сервер в режиме демона:</P>
<P><FONT FACE="Courier New, monospace">/usr/local/sbin/binkd -Dqs
/usr/local/etc/fido/binkd.conf</FONT></P>
<P>Обычно работа демоном нужна в непрерывном режиме - чтобы демон
binkd запускался в процессе загрузки ОС. Для этого нужно вставить
строку запуска binkd в один из стартовых скриптов ОС, например во
FreeBSD/OpenBSD/NetBSD в файл /etc/rc.local. Можно также создать
скрипт запуска/остановки binkd и поместить его в каталог стартовых
скриптов: /etc/init.d (Linux) или /usr/local/etc/rc.d (FreeBSD).
Скрипт приблизительно такой:</P>
<DL>
	<DL>
		<DD>
		<TABLE WIDTH=798 BORDER=1 CELLPADDING=4 CELLSPACING=3>
			<COL WIDTH=782>
			<THEAD>
				<TR>
					<TD WIDTH=782 VALIGN=TOP>
						<P STYLE="margin-bottom: 0.5cm"><FONT FACE="Courier New, monospace">#!/bin/sh</FONT></P>
						<P STYLE="margin-bottom: 0.5cm"><FONT FACE="Courier New, monospace">case
						$1 in</FONT></P>
						<P STYLE="margin-bottom: 0.5cm"><FONT FACE="Courier New, monospace">start)<BR>su
						fido -c &laquo;/usr/local/sbin/binkd -Dq
						/usr/local/etc/fido/binkd.conf&raquo;<BR>;;</FONT></P>
						<P STYLE="margin-bottom: 0.5cm"><FONT FACE="Courier New, monospace">stop)<BR>kill
						`cat /var/run/binkd.pid`<BR>;;</FONT></P>
						<P><FONT FACE="Courier New, monospace">esac</FONT></P>
					</TD>
				</TR>
			</THEAD>
		</TABLE>
	</DL>
</DL>
<P><BR><BR>
</P>
<P>В целях улучшения безопасности использования binkd имеет смысл
назначить ему для работы отдельного пользователя, которому разрешить
доступ только к нужным файлам и каталогам. Возможно также запускать
binkd с использованием chroot.</P>
<H2>6.4. Работа в защищенной (корпоративной) сети.</H2>
<P>Нередко binkd установлен на хосте, расположенном в защищённом
межсетевым экраном сегменте сети (например, на сервере либо
компьютере пользователя в организации). Даже если он работает на
компьютере, напрямую подключенном к Internet, сам компьютер в
современном мире должен быть защищён от произвольного доступа из
Internet (от вирусов, от несанкционированного доступа). Некоторые
провайдеры Internet также защищают компьютеры своих клиентов. Во всех
описанных и в некоторых других случаях необходимы специальные
настройки межсетевого экрана или персонального (локального) сетевого
фильтра IP.</P>
<H3>6.4.1. Использование proxy.</H3>
<P>Зачастую в организациях пользователи имеют доступ к ресурсам
Internet только посредством сервера proxy. Такой сервер принимает
соединение от программы-клиента и создаёт запрос к внешнему ресурсу.
После установления соединения с внешним ресурсом сервер прокси
осуществляет пересылку данных между программой-клиентом и удаленным
сервером, возможно с анализом и фильтрацией содержимого.</P>
<P>Binkd поддерживает серверы прокси трёх стандартных видов:</P>
<OL>
	<LI><P>HTTP/HTTPS, как с аутентификацией пользователя, так и без
	неё;</P>
	<LI><P>SOCKS v.4;</P>
	<LI><P>SOCKS v.5, как с аутентификацией пользователя, так и без неё.</P>
</OL>
<P>В случае работы через сервер прокси HTTP/HTTPS binkd осуществляет
запрос к серверу прокси методом CONNECT с указанием адреса и порта
удалённой стороны (по умолчанию используется порт 24554). Но в
типовых настройках серверов прокси разрешены не все запросы метода
CONNECT , а только к избранному списку портов TCP, обычно только один
порт с номером 443 (этот порт используется браузерами по умолчанию в
протоколе HTTPS при работе с URL вида <A HREF="https://host.domain.tld/">https://host.domain.tld</A>).
Соотвественно, чтобы binkd мог работать через такой сервер прокси,
необходимо либо работать с линком, у которого совместимый с binkd
мейлер отвечает на порту TCP 443, либо нужно изменить конфигурацию
сервера прокси таким образом, чтобы он позволял соединения по методу
CONNECT на стандартный порт binkp &ndash; TCP 24554.</P>
<P>В случае работы через сервер прокси SOCKS обоих поддерживаемых
версий binkd осуществляет запрос к серверу прокси на установление
соединения с удалённым хостом. При этом ограничения на установление
соединений также могут играть роль.</P>
<P>При работе через прокси SOCKS v.5 может требоваться аутентификация
пользователя. При работе же через прокси SOCKS v.4 аутентификация не
требуется.</P>
<P>Особенность работы binkd через сервер прокси заключается в том,
что в этом случае обычно нет никакой возможности обеспечить приём
входящих соединений. Ведь сервер прокси пропускает соединения только
из внутренней сети в Internet, обеспечивая единую точку выхода в
публичную сеть из приватной (корпоративной) сети.</P>
<P>Примеры конфигурации binkd для работы с использованием сервера
прокси см. в п.п. 4.48. и 4.53.</P>
<H3>6.4.2. Использование NAT и настройка firewall.</H3>
<P>Помимо работы через сервер прокси, в сетях организаций (а иногда и
в сети провайдера Internet) используются так называемые частные
подмножества адресов IP, также называемые адресами Intranet. Это
адрсе из подсетей 10.0.0.0/8, 172.16.0.0/12 и 192.168.0.0/16 (см. RFC
1918 &laquo;Address Allocation for Private Internets&raquo;). При
использовании такой адресации для доступа в Internet используется
трансляция адресов IP из внутренней сети в Internet и обратно,
называемая NAT (network address translation) или PAT (port address
translation). Трансляция проводится на устройстве или сервере,
работающим в качестве шлюза в Internet, причём обычно такой шлюз
является файрволом (межсетевым экраном).</P>
<P>В случае работы binkd в сети, защищённой шлюзом или файрволом с
NAT, для работы binkd с внешними по отношению к локальной сети узлами
необходима специальная конфигурация файрвола. При этом настройки
самого binkd не имеют особенностей, они точно такие же как и при его
работе на компьютере с публичным адресом IP.</P>
<P>Во-первых, для осуществелния клиентских соединений от binkd к
внешним узлам на файрволе должны быть разрешены соединения от адреса
IP компьютера, на котором работает binkd, по протоколу TCP на порт
24554 (и, возможно, на другие порты &ndash; в том случае, если
производятся соединения на нестандартный порт на каких-то узлах).</P>
<P>Во-вторых, для обеспечения приёма входящих соединений, на файрволе
необходимо как разрешить входящие соединения, так и обеспечить
трансляцию адресов. При этом возможны два варианта трансляции
адресов.</P>
<OL>
	<LI><P>Назначить соответсвие одного из доступных публичных
	(выделенных провайдером) адресов IP адресу IP компьютера, на котором
	работает binkd; Другими словами &ndash; обеспечить трансляцию
	выделенного публичного и приватного адресов IP (NAT). При этом и
	исходящие от binkd соединения будут выглядеть как соединения с этого
	же адреса. В этом случае необходимо разрешить соединения из Internet
	на этот адрес только по порту 24554 протокола TCP (или другой порт,
	на котором отвечает binkd), а все прочие &ndash; запретить. Это
	необходимо для обеспечения защищённости компьютера от взлома (а в
	итоге и локальной сети в целом).</P>
	<LI><P>Перенаправлять входящие соединения по протоколу TCP и порту
	24554 на адрес комьютера с работающим binkd на тот порт, на котором
	он принимает соединения. Другими словами &ndash; обеспечить
	трансляцию адреса и порта (PAT). В этом случае для обеспечения
	входящих соединений не нужен специальный адрес IP. Но в том случае,
	когда приватная адресация используется провайдером, вряд ли он будет
	транслировать отдельный порт, и в случае его отказа придётся
	заказывать у него выделенный адрес IP.</P>
</OL>
<H2>6.6. Запуск внешних программ из binkd.</H2>
<P>При реальной работе узла FTN приходится запускать программы
обработки почты после приёма файлов. В binkd имеется возможность
автоматизировать такие действия. Возможности по автоматизации
заключаются в том, что binkd умеет обрабатывать события по условию
приёма файла. При этом можно задавать маску имени файла и пути к
каталогу, в который помещается файл.</P>
<P>Один из вариантов действий &ndash; создание (пустого) файла при
удовлетворении условия (т.е. когда был принят файл, подходящий по
указанной в условии маске). Условие создание такого файла и его имя
задаётся в директиве файла конфигурации &laquo;<FONT FACE="Courier New, monospace">flag</FONT>&raquo;.
(См. п.4.19) Появление соответствующего файла может обыть отслежено
другими программами, которые произведут необходимые действия
(запустят обработку).
</P>
<P>Другой вариант действий при выполнении условия &ndash; запуск
программ прямо из binkd. Это действие задаётся в директиве файла
конфигурации &laquo;<FONT FACE="Courier New, monospace">exec</FONT>&raquo;.
(См. п.4.15)</P>
<P>Запуск программ осуществляется с использованием системного вызова
system(), при этом вызывается интерпретатор команд, используемый
операционной системой. В ОС семейства UNIX вызывается интерпретатор,
указанный в описании пользователя, от имени которого работает binkd.
В остальных ОС &ndash; тот интерпретатор команд, на который настроена
операционная система (обычно это COMMAND.COM в Windows 95,98,Me;
CMD.EXE в Windows NT,2000,XP,2003; CMD.EXE в OS/2). Программы
выполняются из процесса (потока), который принял файлы, подходящие по
маске к описанным в директиве файла конфигурации &laquo;<FONT FACE="Courier New, monospace">exec</FONT>&raquo;.</P>
<P>Запуск команд возможен как непосредственно после приёма файлов,
так и по завершении сеанса. Оперативный запуск может иметь смысл для
обработки файловых запросов и отправки запрошенного в том же сеансе
(для чего файлы нужно поместить в файлбокс, соответствующий адресу
удалённой стороны либо использовать протокол взаимодействия мэйлера и
фрекпроцессора SRIF, см. ). Задержанный запуск имеет смысл для
предотвращения длительных пауз в передаче данных и для предотвращения
повторного запуска одной и той же программы в случае приёма пачки
однотипных файлов.</P>
<P>В 32-битных версиях Windows возможен запуск команд в отдельном
процессе. Это позволяет избежать задержек, вызванных ожиданием
завершения работы внешней программы.</P>
<P>При формировании маски файлов нужно внимательно отслеживать, в
каких случаях будет срабатывать это условие. Для того, чтобы
выполнить обработку принятой почты не во всех случаях, а только после
сеанса связи, защищённого паролем, нужно указать маску полного пути к
файлам в каталоге, заданном в директиве &laquo;inbound&raquo;.
Наоборот, чтобы выполнить обработку принятой почты только после
сеанса связи без использования пароля, нужно указать в маске полный
путь к файлам в каталоге, заданном в директиве &laquo;inbound-nonsecure&raquo;.
Также нужно учитывать особенности ОС и файловой системы, например, в
ОС семейства UNIX штатные файловые сситемы являются
регистрозависимыми, и маски должны учитывать все варианты написания
имени файла и пути. При использовании же сетевых дисков в случае
разных ОС сервера и клиента возможны неочевидные ситуации.</P>
<P>В маске файла можно указывать знаки макроподстановки &laquo;?&raquo;,
обозначающий один любой символ, и &laquo;*&raquo;, обозначающий
произвольное количество любых символов (в том числе и отсутвие
символа). Кроме того, можно использовать последовательность символов,
заключённых в квадратные скобки, такая конструкция является списком
альтернативных символов. Чтобы указать символы &laquo;?&raquo;, &laquo;*&raquo;,
&laquo;]&raquo;, &laquo;[&raquo;, &laquo;\&raquo;, &laquo;#&raquo;,
их необходимо предварять знаком обратной косой черты &laquo;\&raquo;.
(Этот знак можно использовать и для других символов, в которых вы
сомневаетесь.)</P>
<P><B>Примеры запуска команд для ОС семейства UNIX.</B></P>
<P><FONT FACE="Times New Roman, serif">Обработка FREQ во время
сеанса:</FONT></P>
<P><FONT FACE="Courier New, monospace">exec
&quot;!/fido/scripts/simplefreq *S&quot; *.[Rr][Ee][Qq]</FONT></P>
<P><FONT FACE="Times New Roman, serif">Обработка почты по завершению
сеанса:</FONT></P>
<P><FONT FACE="Courier New, monospace">exec &quot;/fido/scripts/ftrack.sh&quot;
*.[Pp][Kk][Tt]<BR>exec &quot;/fido/scripts/pkt2000toss.sh&quot;
*.[Pp]2[Kk]<BR>exec &quot;/fido/scripts/echotoss.sh&quot; *.[Ss][Uu]?
*.[Mm][Oo]? *.[Tt][Tu]? *.[Ww][We]?<BR>exec
&quot;/fido/scripts/echotoss.sh&quot; *.[Tt][Hh]? *.[Ff][Rr]?
*.[Ss][Aa]?<BR>exec &quot;/fido/scripts/fechotoss.sh&quot;
/fido/inbound-secure/*.[TtZz][Ii][Cc]</FONT></P>
<P><FONT FACE="Times New Roman, serif"><B>Примеры запуска команд для
ОС Windows, OS/2 и т.п..</B></FONT></P>
<P><FONT FACE="Times New Roman, serif">Обработка FREQ во время
сеанса:</FONT></P>
<P><FONT FACE="Courier New, monospace">exec &quot;!d:\\path\\allfix.exe
Rp -SRIF *S&quot; *.req</FONT></P>
<P><FONT FACE="Times New Roman, serif">Обработка почты по завершению
сеанса:</FONT></P>
<P><FONT FACE="Courier New, monospace">exec
&quot;d:\\path\\my-pkt-unpacker.exe /options&quot;
c:\\\\bbs\\\\inbound\\\\*.pkt <BR>exec &quot;d:\\path\\my-tosser.exe
/options&quot; *.su? *.mo? *.tu? *.we? *.th? *.fr? *.sa?<BR>exec
&quot;d:\\path\\my-filer.exe /options&quot; *.tic *.zic<BR>exec
&quot;d:\\path\\my-pkt-filter.exe /options *F&quot;
c:\\\\bbs\\\\inbound\\\\unsecure\\\\*.pkt</FONT></P>
<H1>7. Форматы служебных файлов и каталогов.</H1>
<H2>7.1. Cправка по каталогам почтовой очереди и файлбоксам.</H2>
<H3>7.1.1. BSO.</H3>
<P>Аббревиатура &laquo;BSO&raquo; расшифровывается как &laquo;Binkley
style outbound&raquo;, этот формат очереди получил своё название от
мэйлера BinkleyTerm, в котором был применён впервые, и до сих пор
классическим описанием формата является раздел outbound руководства
по BinkleyTerm.</P>
<P>Аутбаунд BSO представляет собой иерархию подкаталогов, в которых
содержатся файлы, адресованные линку. Файлы с непакованным
(неархивированным) нетмейлом именуются с суффиксом &laquo;<FONT FACE="Courier New, monospace">ut</FONT>&raquo;,
остальные файлы перечисляются в файле-списке с суффиком &laquo;<FONT FACE="Courier New, monospace">lo</FONT>&raquo;
(flow-file). Перед суффикcом ставится символ атрибута, и эти три
символа отделяются от левой части имени файла точкой (и в терминах
DOS образуют расширение файла). Адрес линка закодирован в имени
каталога и имени файла: для кодирования адреса используется написание
домена FTN (не более 8 знаков), шестнадцатиричное представление
номера зоны, четырёхразрядные шестнадцатиричные представления номеров
сети и узла, для пойнтов также восьмиразрядное шестнадцатиричное
представление номера пойнта.</P>
<P>Почта для узлов выглядит в BSO следующим образом:</P>
<P>Каталог вида <BR><FONT FACE="Courier New, monospace">/<FONT COLOR="#355e00"><B>Д</B>омен</FONT>[.<FONT COLOR="#355e00"><B>Н</B>омер_зоны</FONT>]/</FONT><BR>в
котором располагаются файлы вида
<BR><FONT FACE="Courier New, monospace"><FONT COLOR="#355e00"><B>Н</B>омерсети<B>Н</B>омерузла</FONT>.<FONT COLOR="#355e00"><B>А</B>трибут<B>Т</B>ип</FONT><BR><FONT COLOR="#355e00"><B>У</B>никальноеимя</FONT>.<FONT COLOR="#355e00"><B>Д</B>еньнедели<B>Н</B>омер</FONT></FONT></P>
<P>Почта для пойнтов - таким:</P>
<P>Каталог вида:<BR><FONT FACE="Courier New, monospace">/<FONT COLOR="#355e00"><B>Д</B>омен</FONT>[.<FONT COLOR="#355e00"><B>Н</B>омер_зоны</FONT>]/<FONT COLOR="#355e00">НомерсетиНомерузла</FONT>/</FONT><BR>в
котором располагаются файлы
вида:<BR><FONT FACE="Courier New, monospace"><FONT COLOR="#355e00"><B>Н</B>омерпойнта</FONT>.<FONT COLOR="#355e00"><B>А</B>трибут<B>Т</B>ип</FONT></FONT><BR><FONT FACE="Courier New, monospace"><FONT COLOR="#355e00"><B>У</B>никальноеимя</FONT>.<FONT COLOR="#355e00"><B>Д</B>еньнедели<B>Н</B>омер</FONT></FONT></P>
<UL>
	<LI><P><FONT COLOR="#355e00"><B>Д</B>омен</FONT><BR>Строка из 8
	знаков, совпадающая с написанием домена FTN (в случае длины домена,
	превышающей 8 символов, лишние обрезаются как несоответствующие
	стандарту адресации FTN). В случае использования единственного
	домена в сети имя каталога может не совпадать с написанием домена в
	адреса. Домен является основной частью базового каталога для
	5D-адресации.</P>
	<LI><P><FONT COLOR="#355e00"><B>Н</B>омер_зоны</FONT><BR>Шеснадцатиричное
	число, равное номеру зоны в адресе линка. Не используется в случае
	совпадения зоны в адресе линка и в собственном адресе. Номер зоны
	отледяется от домена точкой.</P>
	<LI><P><FONT COLOR="#355e00"><B>Н</B>омерсети</FONT><BR>Четырёхразрядное
	шеснадцатиричное число, равное номеру сети в адресе линка. В случае
	меньшего числа слева дополняется нулями. Не отделяется от номера
	узла, следующего за ним.</P>
	<LI><P><FONT COLOR="#355e00"><B>Н</B>омерузла</FONT><BR>Четырёхразрядное
	шеснадцатиричное число, равное номеру узла в адресе линка. В случае
	меньшего числа слева дополняется нулями. Не отделяется от номера
	сети, стоящего перед ним.</P>
	<LI><P><FONT COLOR="#355e00"><B>А</B>трибут</FONT><BR>Один символ,
	задающий атрибут почты. Используемый символ зависит от того,
	является ли файл нетмейл-пакетом или файл-списком.<BR>Для
	нетмейл-пакетов используются: &laquo;o&raquo; - атрибут &laquo;normal&raquo;,
	&laquo;d&raquo; - &laquo;direct&raquo;, &laquo;h&raquo; - &laquo;hold&raquo;,
	&laquo;c&raquo; - &laquo;crash&raquo; (&laquo;Continuous&raquo; в
	оригинальной спецификации BinkeyTerm), &laquo;i&raquo; -
	&laquo;immediate&raquo;. Для списков используются: &laquo;f&raquo; -
	атрибут &laquo;normal&raquo;, &laquo;d&raquo; - &laquo;direct&raquo;,
	&laquo;h&raquo; - &laquo;hold&raquo;, &laquo;c&raquo; - &laquo;crash&raquo;,
	&laquo;i&raquo; - &laquo;immediate&raquo;. Атрибут &laquo;immediate&raquo;
	является расширением оригинальной спецификации.</P>
	<LI><P><FONT COLOR="#355e00"><B>Н</B>омерпойнта</FONT><BR>Восьмиразрядное
	шеснадцатиричное число, равное номеру узла в адресе линка-пойнта.
	Для узлов (пойнтов с номером 0) не используется. После номера пойнта
	ставится точка, затем следует символ атрибута и два символа типа
	файла (пакет или список).</P>
	<LI><P><FONT COLOR="#355e00"><B>Т</B>ип</FONT><BR>Два символа типа
	файла. Возможные значения: &laquo;ut&raquo; и &laquo;lo&raquo;. &laquo;ut&raquo;
	обозначает непакованный (неархивированный) пакет нетмейла, &laquo;lo&raquo;
	- список файлов для отправки.</P>
	<LI><P><FONT COLOR="#355e00"><B>У</B>никальноеимя</FONT><BR>Имя
	файла, сгенерированное для обеспечения уникальности пакованного
	(архивированного) почтового пакета. Рекомендуется генерировать имя
	на основании адресов отправителя и получателя, с тем, чтобы можно
	было выявлять &laquo;потерянные&raquo; пакеты (т.е. пакеты, которые
	были удалены из файла-списка, но остались нетронутыми).</P>
	<LI><P><FONT COLOR="#355e00"><B>Д</B>еньнедели</FONT><BR>Две буквы,
	обозначающие день недели формирования пакета. Основаны на
	сокращённых английских названиях дней недели: Su, Mo, Tu, We, Fr,
	Th, Sa.</P>
	<LI><P><FONT COLOR="#355e00"><B>Н</B>омер</FONT><BR>Порядковый номер
	файла. Нумерация начинается с нуля.</P>
</UL>
<P>Каждый файл-список содержит список файлов, предназначенных для
отправки линку. Каждое имя файла располагается в отдельной строке,
строки разделяются так, как это принято в используемой ОС для
текстовых файлов (программа должна обрабатывать все варианты: и один
символ перевода строки, и последовательность перевода каретки с
переводом строки). Обычно указываются абсолютные (полные) пути к
файлам, но возможно и использование путей относительно каталога, в
котором располагается с файл списка. Каждый файл может предваряться
символом, задающим необходимое действие с файлом после его успешной
отправки.</P>
<P>Формат записи в файле-списке:</P>
<P>[<FONT COLOR="#355e00"><B>М</B>одификатор</FONT>][<FONT COLOR="#355e00"><B>П</B>уть</FONT>]<FONT COLOR="#355e00"><B>И</B>мяфайла</FONT></P>
<UL>
	<LI><P><FONT COLOR="#355e00"><B>М</B>одификатор</FONT><BR>Один из
	символов: &laquo;<FONT COLOR="#355e00">^</FONT>&raquo;, &laquo;<FONT COLOR="#355e00">#</FONT>&raquo;,
	&laquo;<FONT COLOR="#355e00">~</FONT>&raquo;, &laquo;<FONT COLOR="#355e00">$</FONT>&raquo;,
	&laquo;<FONT COLOR="#355e00">!</FONT>&raquo;, пробел
	либо отсутствие символа.</P>
	<LI><P><FONT COLOR="#355e00">^</FONT><BR>После успешной отправки
	обрезать файл до нулевой длины. Этот модификатор обычно используется
	для файлов пакованной (архивированной) почты.</P>
	<LI><P><FONT COLOR="#355e00">#</FONT><BR>После успешной отправки
	удалить файл.</P>
	<LI><P><FONT COLOR="#355e00">!</FONT><BR>Не отсылать файл, поскольку
	файл уже отослан.</P>
	<LI><P><FONT COLOR="#355e00">~</FONT><BR>Не отсылать файл. (Строка
	комментария). Этот модификатор является расширением первоначальной
	спецификации.</P>
	<LI><P><FONT COLOR="#355e00">$</FONT><BR>Не отсылать файл. (Строка
	комментария). Этот модификатор является расширением первоначальной
	спецификации.</P>
	<LI><P>Пробел.<BR>
	После успешной отправки оставить файл на месте.</P>
	<LI><P><FONT COLOR="#355e00"><B>П</B>уть</FONT><BR>Каталог, в
	котором располагается файл. Путь может быть абсолютным либо
	относительным. Относительный путь отсчитывается от каталога, в
	котором располагается файл-список. Если путь не указан, файл ищется
	в каталоге, в котором располагается файл<FONT FACE="Times New Roman, serif">-</FONT>список.</P>
	<LI><P><FONT COLOR="#355e00"><B>И</B>мяфайла</FONT><BR>Имя файла для
	отправки. Если имя файла начинается с одного из символов-модификаторов,
	оно должно предваряться пробелом.</P>
</UL>
<P>Примеры имён файлов.</P>
<P>Нетмейловый пакет с атрибутом &laquo;normal&raquo; для узла
2:5080/68@fidonet с узла 2:5080/102@fidonet (зона у этих узлов одна,
поэтому каталог без суффикса с номером зоны):</P>
<P STYLE="margin-left: 2cm"><FONT FACE="Courier New, monospace">D:\Ftn\Outbound\Fidonet\13d80044.out</FONT></P>
<P>Нетмейловый пакет с атрибутом &laquo;direct&raquo; для узла
3:712/848@fidonet с узла 2:5080/102@fidonet:</P>
<P STYLE="margin-left: 2cm"><FONT FACE="Courier New, monospace">D:\Ftn\Outbound\Fidonet.003\02c80350.dut</FONT></P>
<P>Файл-список с атрибутом &laquo;direct&raquo; для узла
3:712/848@fidonet с узла 2:5080/102@fidonet:</P>
<P STYLE="margin-left: 2cm"><FONT FACE="Courier New, monospace">D:\Ftn\Outbound\Fidonet.003\02c80350.dlo</FONT></P>
<P>Нетмейловый пакет с атрибутом &laquo;hold&raquo; для пойнта
2:5080/102.100@fidonet с узла 2:5080/102@fidonet:</P>
<P STYLE="margin-left: 2cm"><FONT FACE="Courier New, monospace">D:\Ftn\Outbound\Fidonet\13d80066\00000064.hut</FONT></P>
<P>Файл-список с атрибутом &laquo;hold&raquo; для пойнта
2:5080/102.100@fidonet с узла 2:5080/102@fidonet:</P>
<P STYLE="margin-left: 2cm"><FONT FACE="Courier New, monospace">D:\Ftn\Outbound\Fidonet\13d80066\00000064.hlo</FONT></P>
<P>Пример содержимого файла-списка.</P>
<P STYLE="margin-left: 2cm"><FONT FACE="Courier New, monospace">^D:\Ftn\Outbound\Fidonet\d08a1f00.mo0<BR>#D:\Ftn\Outbound\Fileout\nodediff.z74<BR>#D:\Ftn\Outbound\Fileout\17h2n539.tic</FONT></P>
<P>Некоторые программы используют дополнительно собственные типы файлов аутбаунда с суффиксами:
<div STYLE="margin-left: 2cm">
.csy &mdash; файл&ndash;флаг "звонок", обозначает, что в этот момент иницируется сеанс связи с линком (используется во многих мейлерах);<br>
.stc &mdash; файл с информацией о статусе соединения (используется в binkd);<br>
.hld &mdash; файл&ndash;индикатор приостановки попыток соединения с линком (используется в binkd).
</div>
</P>
<H3>7.1.2. ASO.</H3>
<P>&laquo;ASO&raquo; &mdash; аббревиатура, составленная из первых букв названия &laquo;Amiga Style Outbound&raquo;. Это формат почтовой очереди Фидонет, впервые реализованный на платформе &laquo;Commodor Amiga&raquo;.</P>
<P>Аутбаунд ASO представляет собой единственный каталог, в котором содержатся файлы, адресованные линкам. Зоны FTN в ASO не поддерживаются, это чистый 4D-аутбаунд. Это ограничивает использование ASO только теми станциями, которые имеют адрес(а) только в одном домене FTN. Другим недостатком ASO является то, что все файлы  для всех линков размещаются в одном каталоге на диске, и при большом числе линков неизбежны задержки при сканирования аутбаунда.</P>
<P>Преимуществом ASO можно считать наглядность имён файлов: сразу видно, какому линку предназначен файл.</P>
<P>Как и в BSO, файлы с непакованным (неархивированным) нетмейлом именуются с суффиксом &laquo;<FONT FACE="Courier New, monospace">ut</FONT>&raquo;,
остальные файлы перечисляются в файле-списке с суффиком &laquo;<FONT FACE="Courier New, monospace">lo</FONT>&raquo; (flow-file). Перед суффикcом ставится символ атрибута, и эти три символа отделяются от левой части имени файла точкой (и в терминах DOS образуют расширение файла). Формат строк в файлах списках тот же, что и в BSO.</P>
<P>Остальная часть (левая) файла формируется из 4D-адреса линка, поля которого разделяются точкой, то есть имена файлов формируются по шаблону:</P>
<P STYLE="margin-left: 2cm"><FONT FACE="Courier New, monospace">zz.nn.ff.pp.ext</font>
<br>где:
<div STYLE="margin-left: 3cm">
<FONT FACE="Courier New, monospace">zz</FONT> &mdash; номер зоны
<br><FONT FACE="Courier New, monospace">nn</FONT> &mdash; номер сети
<br><FONT FACE="Courier New, monospace">ff</FONT> &mdash; номер узла (ноды)
<br><FONT FACE="Courier New, monospace">pp</FONT> &mdash; номер поинта
<br><FONT FACE="Courier New, monospace">ext</FONT> &mdash; тип файла (&laquo;?ut&raquo; или &laquo;?lo&raquo;)
</div>
<br>(все номера в десятичном формате).</P>
<P>Примеры имён файлов.</P>
<P>Нетмейловый пакет с атрибутом &laquo;normal&raquo; для узла
2:5080/68@fidonet с узла 2:5080/102@fidonet:</P>
<P STYLE="margin-left: 2cm"><FONT FACE="Courier New, monospace">D:\Ftn\Outbound\ASO\2.5080.68.0.out</FONT></P>
<P>Файл-список с атрибутом &laquo;hold&raquo; для пойнта
2:5080/102.100@fidonet с узла 2:5080/102@fidonet:</P>
<P STYLE="margin-left: 2cm"><FONT FACE="Courier New, monospace">D:\Ftn\Outbound\ASO\2.5080.102.100.hlo</FONT></P>
<P>Нетмейловый пакет с атрибутом &laquo;direct&raquo; для узла
3:712/848@fidonet с узла 2:5080/102@fidonet:</P>
<P STYLE="margin-left: 2cm"><i>Невозможен в аутбаунде ASO.</i></P>

<P>Некоторые программы используют дополнительно собственные типы файлов аутбаунда (как и в BSO):
<div STYLE="margin-left: 2cm">
csy &mdash; файл&ndash;флаг "звонок", обозначает, что в этот момент иницируется сеанс связи с линком (используется во многих мейлерах);<br>
stc &mdash; файл с информацией о статусе соединения (используется в binkd);<br>
hld &mdash; файл&ndash;индикатор приостановки попыток соединения с линком (используется в binkd).
</div>
</P>
<H3>7.1.3. Long BSO.</H3>
<H3>7.1.4. Файлбоксы, совместимые с мейлером &laquo;T-Mail&raquo;.</H3>
<P>Binkd способен отправлять файлы, помещённые мейлером T-Mail в специальные каталоги,
называемые файлбоксами. У T-mail есть два вида файлбоксов: традиционные &laquo;короткие&raquo;,
подчиняющиеся правилам именования файлов в DOS (8.3) и реализованные в T-mail/NT и T-mail/2 &laquo;длинные&raquo;.
Файлбоксы формата T-mail используют 4D-адресацию FTN (без домена).</P>
<P>&laquo;Короткие&raquo; файлбоксы формата T-mail представляют собой подкаталоги с именами стиля DOS в базовом каталоге. Имя каждого подкаталога-файлбокса сгенерировано из адреса
FTN системы назначения с использованием 32-ричной системы счисления, в которой цифры от &laquo;0&raquo;
до &laquo;9&raquo; совпадают с 10-ричными цифрами, а цифрам от 10 до 31 назначены буквы латинского
(английского) алфавита от &laquo;A&raquo; до &laquo;V&raquo;, все буквы - прописные (заглавные).
Под номер зоны отведены два символа, под номер сети и номер узла - по три знака, под номер пойнта - два
первых знака после точки (у узла ставится &laquo;00&raquo;). Третий знак после точки может использоваться
для атрибута &laquo;hold&raquo;, для чего используется буква &laquo;H&raquo;. Таким образом, файлбокс
&laquo;короткого&raquo; формата T-mail имеет ограничения:
для адресов узлов от 1:1/0 до 1023:32767/32767 и для номеров пойнтов от 0 до 1023.</P>

<P>Формат короткого файлбокса T-mail:
<BR>
<FONT FACE="Courier New, monospace"><FONT COLOR="#355e00"><B>Н</B>омерзоны</FONT><FONT COLOR="#355e00"><B>Н</B>омерсети</FONT><FONT COLOR="#355e00"><B>Н</B>омерузла</FONT>.<FONT COLOR="#355e00"><B>Н</B>омерпойнта</FONT>[<FONT COLOR="#355e00"><B>А</B>трибут</FONT>]
<BR>
<UL>
	<LI><FONT COLOR="#355e00"><B>Н</B>омерзоны</FONT><BR>
	Две 32-ричные цифры номера зоны (от &laquo;01&raquo; до &laquo;VV&raquo;).
	<LI><FONT COLOR="#355e00"><B>Н</B>омерсети</FONT><BR>
	Три 32-ричные цифры номера сети (от &laquo;001&raquo; до &laquo;VVV&raquo;).
	<LI><FONT COLOR="#355e00"><B>Н</B>омерузла</FONT><BR>
	Три 32-ричные цифры номера узла (от &laquo;000&raquo; до &laquo;VVV&raquo;).
	<LI><FONT COLOR="#355e00"><B>Н</B>омерпойнта</FONT><BR>
	Две 32-ричные цифры номера пойнта (от &laquo;00&raquo; до &laquo;VV&raquo;).
	<LI><FONT COLOR="#355e00"><B>А</B>трибут</FONT><BR>
	Атрибут файлбокса &laquo;hold&raquo; обозначается буквой &laquo;H&raquo;,
	при отсутствии буквы &laquo;H&raquo; файлбокс имеет атрибут &laquo;normal&raquo;.
	Другие атрибуты не поддерживаются.
</UL>
</P>
<P>Примеры коротких файлбоксов T-mail:</P>
<P>Файлбокс с атрибутом &laquo;normal&raquo; для отправки файлов координатору зоны 2:</P>
<P STYLE="margin-left: 2cm"><FONT FACE="Courier New, monospace">D:\Ftn\fileboxT\02002000.00</FONT></P>
<P>Файлбокс с атрибутом &laquo;hold&raquo; для пойнта 2:5080/102.63</P>
<P STYLE="margin-left: 2cm"><FONT FACE="Courier New, monospace">D:\Ftn\fileboxT\024UO036.1VH</FONT></P>

<P>&laquo;Длинные&raquo; файлбоксы формата T-mail представляют собой подкаталоги с длинными именами в базовом каталоге.
Имя каждого подкаталога-файлбокса состоит из цифр адреса FTN системы назначения с использованием десятичной системы счисления, разделённых точками. В конце для указания атрибута &laquo;hold&raquo; может стоять &laquo;.H&raquo; или &laquo;.h&raquo;. Таким образом, файлбокс &laquo;длинного&raquo; стиля T-mail не имеет ограничений.</P>
<P>Формат длинного файлбокса T-mail:
<BR>
<FONT FACE="Courier New, monospace"><FONT COLOR="#355e00"><B>Н</B>омерзоны</FONT>.<FONT COLOR="#355e00"><B>Н</B>омерсети</FONT>.<FONT COLOR="#355e00"><B>Н</B>омерузла</FONT>.<FONT COLOR="#355e00"><B>Н</B>омерпойнта</FONT>[.<FONT COLOR="#355e00"><B>А</B>трибут</FONT>]
<BR>
<UL>
	<LI><FONT COLOR="#355e00"><B>Н</B>омерзоны</FONT><BR>
	Десятичные цифры номера зоны.
	<LI><FONT COLOR="#355e00"><B>Н</B>омерсети</FONT><BR>
	Десятичные цифры номера сети.
	<LI><FONT COLOR="#355e00"><B>Н</B>омерузла</FONT><BR>
	Десятичные цифры номера узла.
	<LI><FONT COLOR="#355e00"><B>Н</B>омерпойнта</FONT><BR>
	Десятичные цифры номера пойнта.
	<LI><FONT COLOR="#355e00"><B>А</B>трибут</FONT><BR>
	Атрибут файлбокса &laquo;hold&raquo; обозначается буквой &laquo;H&raquo; или &laquo;h&raquo;, при отсутствии
	буквы атрибута файлбокс имеет атрибут &laquo;normal&raquo;. Другие атрибуты не поддерживаются.
</UL>
</P>
<P>Примеры длинных файлбоксов T-mail:</P>
<P>Файлбокс с атрибутом &laquo;normal&raquo; для отправки файлов координатору зоны 2:</P>
<P STYLE="margin-left: 2cm"><FONT FACE="Courier New, monospace">D:\Ftn\fileboxT\2.2.0.0</FONT></P>
<P>Файлбокс с атрибутом &laquo;hold&raquo; для пойнта 2:5080/102.63</P>
<P STYLE="margin-left: 2cm"><FONT FACE="Courier New, monospace">D:\Ftn\fileboxT\2.5080.102.63.H</FONT></P>

<H3>7.1.5. Файлбоксы, совместимые с мейлером &laquo;The Brake!&raquo;.</H3>
<P>Файлбоксы формата The Brake! представляют собой подкаталоги с длинными именами в базовом каталоге.
Имя каждого подкаталога-файлбокса состоит из домена и цифр адреса FTN системы назначения с использованием десятичной системы счисления, разделённых точками. В конце, после точки, указан атрибут. Таким образом, файлбокс формата The Brake! не имеет ограничений.</P>
<P>Формат файлбокса The Brake!:
<BR>
<FONT COLOR="#355e00"><B>Д</B>омен</FONT>.<FONT FACE="Courier New, monospace"><FONT
COLOR="#355e00"><B>Н</B>омерзоны</FONT>.<FONT COLOR="#355e00"><B>Н</B>омерсети</FONT>.<FONT
COLOR="#355e00"><B>Н</B>омерузла</FONT>.<FONT COLOR="#355e00"><B>Н</B>омерпойнта</FONT>.<FONT
COLOR="#355e00"><B>А</B>трибут</FONT>
<BR>
<UL>
	<LI><FONT COLOR="#355e00"><B>Д</B>омен</FONT><BR>
	Имя домена FTN, строчными буквами.
	<LI><FONT COLOR="#355e00"><B>Н</B>омерзоны</FONT><BR>
	Десятичные цифры номера зоны.
	<LI><FONT COLOR="#355e00"><B>Н</B>омерсети</FONT><BR>
	Десятичные цифры номера сети.
	<LI><FONT COLOR="#355e00"><B>Н</B>омерузла</FONT><BR>
	Десятичные цифры номера узла.
	<LI><FONT COLOR="#355e00"><B>Н</B>омерпойнта</FONT><BR>
	Десятичные цифры номера пойнта.
	<LI><FONT COLOR="#355e00"><B>А</B>трибут</FONT><BR>
	Атрибут файлбокса. Возможные значения:
	&laquo;immediate&raquo;, &laquo;Immediate&raquo;,
	&laquo;crash&raquo;, &laquo;Crash&raquo;,
	&laquo;direct&raquo;, &laquo;Direct&raquo;,
	&laquo;normal&raquo;, &laquo;Normal&raquo;,
	&laquo;hold&raquo;, &laquo;Hold&raquo;.
</UL>
</P>
<P>Примеры файлбоксов формата The Brake!</P>
<P>Файлбокс с атрибутом &laquo;normal&raquo; для отправки файлов координатору зоны 2 сети fidonet:</P>
<P STYLE="margin-left: 2cm"><FONT FACE="Courier New, monospace">D:\Ftn\fileboxTheBrake\fidonet.2.2.0.0.normal</FONT></P>
<P>Файлбокс с атрибутом &laquo;hold&raquo; для пойнта 2:5080/102.63@fidonet</P>
<P STYLE="margin-left: 2cm"><FONT FACE="Courier New, monospace">D:\Ftn\fileboxTheBrake\fidonet.2.5080.102.63.Hold</FONT></P>

<H2>7.2. Форматы файлов</H2>
<H3>7.2.1. Файл паролей.</H3>
<P>Binkd способен читать пароли из текстового файла паролей,
используемого мейлером: T-Mail.</P>
<P>В файле формата T-mail каждая строка содержит два слова: адрес FTN
и пароль, разделённые пробелами и/или знаками табуляции. Cтрока может
начинаться пробелами и/или знаками табуляции. Пустые строки и строки,
первое слово в которых не является адресом FTN, игнорируются (так
игнорируются строки комментариев T-mail). Также игнорируется остаток
строки после пароля.</P>
<P>Пример.</P>
<P STYLE="margin-left: 2cm"><FONT FACE="Courier New, monospace">;==Файл
паролей стиля T-mail=====================<BR>2:5080/102
pwd1<BR>7:1500/102 pwd2</FONT></P>
<H3>7.2.2. Двоичный файл статистики стиля T-mail.</H3>
<H3>7.2.3. Двоичный файл статистики стиля FrontDoor.</H3>
<H2>7.3. Файлы, создаваемые binkd в процессе работы.</H2>
<H3>7.3.1. Файл с PID.</H3>
<P>В ОС семейства UNIX <FONT FACE="Courier New, monospace">binkd</FONT>
создаёт файл с номером процесса (PID &ndash; Process ID). Это
помогает предупредить повторный запуск <FONT FACE="Courier New, monospace">binkd</FONT>
и отследить его работоспособность. Файл PID обычно располагается в
каталоге <FONT FACE="Courier New, monospace">/var/run</FONT> и
называется <FONT FACE="Courier New, monospace">binkd.pid</FONT>. В
файле конфигурации можно задать другое его размещение и имя, что
позволяет запускать несколько копий <FONT FACE="Courier New, monospace">binkd</FONT>
с разными конфигурациями.</P>
<P>Файл PID представляет собой текстовый файл и содержит
строку-число, равное номеру &laquo;родительского&raquo; процесса. В
случае запуска с опцией &laquo;<FONT FACE="Courier New, monospace">-c</FONT>&raquo;
это процесс менеджера клиентов, в остальных случаях &ndash; процесс
менеджера сервера <FONT FACE="Courier New, monospace">binkd</FONT>.</P>
<H3>7.3.2. Файлы, создаваемые в каталоге почтовой очереди.</H3>
<P>Binkd создаёт и использует несколько файлов для отслеживания
состояния соединений с линками. Имена таких файлов составляются из
двух частей, разделённых точкой: левая часть имени соответствует
правилам кодирования адреса в используемом аутбаунде, правая часть
состоит из трёх букв и указывает на функцию файла.</P>
<UL>
	<LI><P>Файл вида <FONT FACE="Courier New, monospace">*.bsy</FONT><FONT FACE="Times New Roman, serif">.</FONT><BR>Стандартный
	файл-флаг занятости линка для BSO. Создаётся при успешном соединении
	с линком после получения от него списка адресов FTN.</P>
	<LI><P>Файл вида <FONT FACE="Courier New, monospace">*.csy</FONT>.<BR>Файл-флаг,
	являющийся расширением оригинальной спецификации BSO. Используется
	для индикации процесса установления соединения с линком. Клиентский
	процесс создаёт его перед открытием сокета и удаляет после создания
	флага *.bsy, а в случае обнаружения такого файла завершается. Этот
	файл-флаг предотвращает одновременную попытку соединиться двумя
	клиентскими процессами, также он создаётся и проверяется некоторыми
	другими FTN мейлерами (например, T-mail).</P>
	<LI><P>Файл вида <FONT FACE="Courier New, monospace">*.hld</FONT><FONT FACE="Times New Roman, serif">.</FONT><BR>Используется
	для хранения времени, до которого отложен следующий вызов линка
	после исчерпания лимита неудачных попыток соединения. Время записано
	в виде строки цифр, представляющих собой число секунд от &quot;начала
	эпохи UNIX&quot; (1 января 1970 г.).<BR>Этот файл специфичен для
	<FONT FACE="Courier New, monospace">binkd</FONT>.</P>
	<LI><P>Файл вида <FONT FACE="Courier New, monospace">*.try</FONT><FONT FACE="Times New Roman, serif">.</FONT><BR>Используется
	для хранения статуса последнего сеанса свяи с линком (удачного или
	неудачного). Состоит из трёх полей: количество успешных попыток
	(двоичное 16-тибитное число с порядком байт &laquo;младший первым&raquo;),
	количество безуспешных попыток (двоичное 16-тибитное число с
	порядком байт &laquo;младший первым&raquo;) и строку с сообщением. В
	случае успешно завершившегося сеанса третье поле содержит строку
	&laquo;<FONT FACE="Courier New, monospace">CONNECT/BND</FONT>&raquo;,
	в случае неудачного - строку сообщения об ошибке.<BR>При безуспешной
	попытке соединения <FONT FACE="Courier New, monospace">binkd</FONT>
	увеличивает счётчик неудачных попыток (второе поле в файле *.try) до
	тех пор, пока не будет превышено число, заданное в директиве файла
	конфигурации &laquo;<FONT FACE="Courier New, monospace">try</FONT>&raquo;,
	после чего обнуляет счётчик и записывает время следующей попытки в
	файл <FONT FACE="Courier New, monospace">*.hld</FONT>.<BR>Этот файл
	специфичен для <FONT FACE="Courier New, monospace">binkd</FONT>.</P>
	<LI><P>Файл вида <FONT FACE="Courier New, monospace">*.stc</FONT><FONT FACE="Times New Roman, serif">.</FONT><BR>Файл
	с информацией о состоянии почты для/от линка при работе в режиме ND
	(&laquo;No Dupes mode&raquo;).<BR>Этот файл специфичен для <FONT FACE="Courier New, monospace">binkd</FONT>.</P>
</UL>
<H3>7.3.3. Временные файлы, использующиеся при приеме файлов.</H3>
<P>Чтобы исключить обработку принятых не до конца файлов другими
программами, <FONT FACE="Courier New, monospace">binkd</FONT> сначала
записывает принятые данные в файлы со специальными именами, а по
завершении приёма (при получении от линка подтверждения о завершении
передачи) переименовывает временный файл в назначенное удалённой
стороной имя.</P>
<P>Для каждого принимаемого файла binkd создаёт в каталоге для приёма
файлов два временных файла: *.hr с описанием файла и *.dt с
содержимым файла (левые части файлов генерируются с обеспечением
уникальности и совпадают у обоих файлов). Хранение информации о
принимаемом файле отдельно от него самого гарантирует независимость
binkd от используемой файловой системы и ОС.</P>
<P>Файл *.hr содержит строку, состоящую из четырёх полей: имя файла,
его размер, время последнего изменения и адрес линка, который шлёт
файл. На основе этой информации <FONT FACE="Courier New, monospace">binkd</FONT>
принимает решение о приёме файла с совпадающим именем от этого же
линка как продолжение существующего файла либо как нового.</P>
<H1>8. Другая документация.</H1>
<H2>8.1. Документация из дистрибутивного комплекта binkd.</H2>
<P>В комплекте официального дистрибутива <FONT FACE="Courier New, monospace">binkd</FONT>
обязательно присутствует инструкция по установке, файл со списком
функциональных изменений, документ &laquo;Частые вопросы по мейлеру
binkd и ответы на них&raquo; (&laquo;Binkd FAQ&raquo;), страничка <FONT FACE="Courier New, monospace">man</FONT>
<FONT FACE="Courier New, monospace">binkd</FONT>, описание <FONT FACE="Courier New, monospace">binkd/w9x</FONT>,
краткое описание протокола <FONT FACE="Courier New, monospace">binkp</FONT>,
описание протокола <FONT FACE="Courier New, monospace">SRIF</FONT> и
некоторые другие документы, представляющие интерес скорее для
разработчиков. В архивах с <FONT FACE="Courier New, monospace">binkd</FONT>,
не являющихся официальными дистрибутивами, часть или вся документация
может отсутствовать, поэтому будьте внимательны.</P>
<H2>8.2. Документация в Internet.</H2>
<P>На момент написания этого текста в Internet имеется несколько
источников, содержащих документацию по мейлеру <FONT FACE="Courier New, monospace">binkd</FONT>
и протоколу <FONT FACE="Courier New, monospace">binkp</FONT>:</P>
<OL>
	<LI><P>Сайт <A HREF="http://binkd.grumbler.org/">http://binkd.grumbler.org</A></P>
	<LI><P>Архив FTP <A HREF="ftp://cvs.happy.kiev.ua/pub/fidosoft/mailer/binkd/">ftp://cvs.happy.kiev.ua/pub/fidosoft/mailer/binkd/</A>
	и несколько его зеркал:<BR><A HREF="ftp://cheetah.itpark.com.ua/pub/fido/binkd/">ftp://cheetah.itpark.com.ua/pub/fido/binkd/</A>
	(Украина, поддерживает зеркало Pavel Gulchouck
	2:463/68)<BR><A HREF="ftp://fido.thunderdome.ws/pub/mirror/binkd/">ftp://fido.thunderdome.ws/pub/mirror/binkd/</A>
	(США, поддерживает зеркало Matt Bedynek
	1:106/1)<BR><A HREF="ftp://ftp.alexblues.ru/pub/binkd/">ftp://ftp.alexblues.ru/pub/binkd/</A>
	(Россия, поддерживает зеркало Alexander Gladchenko
	2:5080/111)<BR><A HREF="ftp://cube.sut.ru/pub/mirror/binkd/">ftp://cube.sut.ru/pub/mirror/binkd/</A>
	(Россия, поддерживает зеркало Dmitriy Yermakov
	2:5030/1115)<BR><A HREF="http://binkd.spb.ru/">http://binkd.spb.ru</A>
	(Россия, поддерживает зеркало Andrey Ostanovsky 2:5030/1957)</P>
	<LI><P>Руководство пользователя <FONT FACE="Courier New, monospace">binkd
	v.0.9.2</FONT> на английском языке, написанное Nick Soveiko:
	<A HREF="http://www.doe.carleton.ca/~nsoveiko/fido/binkd/">http://www.doe.carleton.ca/~nsoveiko/fido/binkd/</A></P>
	<LI><P>Авторское описание binkd и протокола binkp Дмитрия
	Малова:<BR><A HREF="http://www.corbina.net/~maloff/binkd">http://www.corbina.net/~maloff/binkd</A></P>
	<LI><P>Коллекция стандартов FTN на сайте
	FTSC:<BR><A HREF="http://www.ftsc.org/download/">http://www.ftsc.org/download/</A></P>
</OL>
<P>Я не могу гарантировать, что какие-то ресурсы не перестанут
работать и наверняка угадаю, утверждая, что через некоторое время
появятся и другие ресурсы.</P>
<H2>8.2. Источники информации в FIDOnet.</H2>
<P>Псокольку <FONT FACE="Courier New, monospace">binkd</FONT>
является почтовой программой, используемой в сети <FONT FACE="Courier New, monospace">FIDOnet</FONT>,
естественно, что в этой сети достаточно просто найти информацию о нём
и, более того, можно получить помощь в настройке. Для общения
пользователей и разработчкиов <FONT FACE="Courier New, monospace">binkd</FONT>
существует две эхоконференции <FONT FACE="Courier New, monospace">FIDOnet</FONT>:
русскоязычная <FONT FACE="Courier New, monospace">RU.BINKD</FONT> и
англоязычная <FONT FACE="Courier New, monospace">BINKD</FONT> (она
является международной). Также имеющие отношение к <FONT FACE="Courier New, monospace">binkd</FONT>
файлы распространяются по файлэхе <FONT FACE="Courier New, monospace">AFTNBINKD</FONT>.</P>
<HR>
<P>$Id$
</P>
</BODY>
</HTML>
